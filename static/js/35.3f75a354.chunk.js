/*! For license information please see 35.3f75a354.chunk.js.LICENSE.txt */
(this.webpackJsonp=this.webpackJsonp||[]).push([[35],{3060:function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});const n=r(3955),i=r(3956),s=r(3140),o=r(2073),u=r(3117),a=r(3957),p=r(2066);e.OPS=r(3440);const c=r(3958),h=e.OPS.OP_RESERVED;function f(t){return s.Buffer(t)||function(t){return s.Number(t)&&(t===e.OPS.OP_0||t>=e.OPS.OP_1&&t<=e.OPS.OP_16||t===e.OPS.OP_1NEGATE)}(t)}function l(t){return s.Array(t)&&t.every(f)}function d(t){return 0===t.length?e.OPS.OP_0:1===t.length?t[0]>=1&&t[0]<=16?h+t[0]:129===t[0]?e.OPS.OP_1NEGATE:void 0:void 0}function y(e){return t.isBuffer(e)}function w(e){return t.isBuffer(e)}function g(e){if(y(e))return e;p(s.Array,e);const r=e.reduce((t,e)=>w(e)?1===e.length&&void 0!==d(e)?t+1:t+a.encodingLength(e.length)+e.length:t+1,0),n=t.allocUnsafe(r);let i=0;if(e.forEach(t=>{if(w(t)){const e=d(t);if(void 0!==e)return n.writeUInt8(e,i),void(i+=1);i+=a.encode(n,t.length,i),t.copy(n,i),i+=t.length}else n.writeUInt8(t,i),i+=1}),i!==n.length)throw new Error("Could not decode chunks");return n}function v(t){if(r=t,s.Array(r))return t;var r;p(s.Buffer,t);const n=[];let i=0;for(;i<t.length;){const r=t[i];if(r>e.OPS.OP_0&&r<=e.OPS.OP_PUSHDATA4){const e=a.decode(t,i);if(null===e)return null;if(i+=e.size,i+e.number>t.length)return null;const r=t.slice(i,i+e.number);i+=e.number;const s=d(r);void 0!==s?n.push(s):n.push(r)}else n.push(r),i+=1}return n}function m(t){const e=-193&t;return e>0&&e<4}e.isPushOnly=l,e.compile=g,e.decompile=v,e.toASM=function(t){return y(t)&&(t=v(t)),t.map(t=>{if(w(t)){const e=d(t);if(void 0===e)return t.toString("hex");t=e}return c[t]}).join(" ")},e.fromASM=function(r){return p(s.String,r),g(r.split(" ").map(r=>void 0!==e.OPS[r]?e.OPS[r]:(p(s.Hex,r),t.from(r,"hex"))))},e.toStack=function(r){return r=v(r),p(l,r),r.map(r=>w(r)?r:r===e.OPS.OP_0?t.allocUnsafe(0):n.encode(r-h))},e.isCanonicalPubKey=function(t){return u.isPoint(t)},e.isDefinedHashType=m,e.isCanonicalScriptSignature=function(e){return!!t.isBuffer(e)&&(!!m(e[e.length-1])&&o.check(e.slice(0,-1)))},e.number=n,e.signature=i}).call(this,r(19).Buffer)},3079:function(t,e){function r(t){return 41+(t.script?t.script.length:107)}function n(t){return 9+(t.script?t.script.length:25)}function i(t,e){return 3*r({})}function s(t,e){return 10+t.reduce((function(t,e){return t+r(e)}),0)+e.reduce((function(t,e){return t+n(e)}),0)}function o(t){return"number"!==typeof t?NaN:isFinite(t)?Math.floor(t)!==t||t<0?NaN:t:NaN}function u(t){return t.reduce((function(t,e){return t+o(e.value)}),0)}var a=n({});t.exports={dustThreshold:i,finalize:function(t,e,r){var n=s(t,e),o=r*(n+a),p=u(t)-(u(e)+o);p>i()&&(e=e.concat({value:p}));var c=u(t)-u(e);return isFinite(c)?{inputs:t,outputs:e,fee:c}:{fee:r*n}},inputBytes:r,outputBytes:n,sumOrNaN:u,sumForgiving:function(t){return t.reduce((function(t,e){return t+(isFinite(e.value)?e.value:0)}),0)},transactionBytes:s,uintOrNaN:o}},3117:function(t,e,r){(function(e){const n=r(117),i=new(0,r(392).ec)("secp256k1"),s=r(3278),o=e.alloc(32,0),u=e.from("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141","hex"),a=e.from("fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f","hex"),p=i.curve.n,c=p.shrn(1),h=i.curve.g;function f(t){return e.isBuffer(t)&&32===t.length}function l(t){return!!f(t)&&t.compare(u)<0}function d(t){if(!e.isBuffer(t))return!1;if(t.length<33)return!1;const r=t[0],n=t.slice(1,33);if(0===n.compare(o))return!1;if(n.compare(a)>=0)return!1;if((2===r||3===r)&&33===t.length){try{_(t)}catch(s){return!1}return!0}const i=t.slice(33);return 0!==i.compare(o)&&(!(i.compare(a)>=0)&&(4===r&&65===t.length))}function y(t){return 4!==t[0]}function w(t){return!!f(t)&&(t.compare(o)>0&&t.compare(u)<0)}function g(t,e){return void 0===t&&void 0!==e?y(e):void 0===t||t}function v(t){return new n(t)}function m(t){return t.toArrayLike(e,"be",32)}function _(t){return i.curve.decodePoint(t)}function S(t,r){return e.from(t._encode(r))}function b(t,r,n){if(!f(t))throw new TypeError("Expected Hash");if(!w(r))throw new TypeError("Expected Private");if(void 0!==n&&!f(n))throw new TypeError("Expected Extra Data (32 bytes)");const i=v(r),o=v(t);let u,a;s(t,r,(function(t){const e=v(t),r=h.mul(e);return!r.isInfinity()&&(u=r.x.umod(p),0!==u.isZero()&&(a=e.invm(p).mul(o.add(i.mul(u))).umod(p),0!==a.isZero()))}),w,n),a.cmp(c)>0&&(a=p.sub(a));const l=e.allocUnsafe(64);return m(u).copy(l,0),m(a).copy(l,32),l}t.exports={isPoint:d,isPointCompressed:function(t){return!!d(t)&&y(t)},isPrivate:w,pointAdd:function(t,e,r){if(!d(t))throw new TypeError("Expected Point");if(!d(e))throw new TypeError("Expected Point");const n=_(t),i=_(e),s=n.add(i);return s.isInfinity()?null:S(s,g(r,t))},pointAddScalar:function(t,e,r){if(!d(t))throw new TypeError("Expected Point");if(!l(e))throw new TypeError("Expected Tweak");const n=g(r,t),i=_(t);if(0===e.compare(o))return S(i,n);const s=v(e),u=h.mul(s),a=i.add(u);return a.isInfinity()?null:S(a,n)},pointCompress:function(t,e){if(!d(t))throw new TypeError("Expected Point");const r=_(t);if(r.isInfinity())throw new TypeError("Expected Point");return S(r,g(e,t))},pointFromScalar:function(t,e){if(!w(t))throw new TypeError("Expected Private");const r=v(t),n=h.mul(r);return n.isInfinity()?null:S(n,g(e))},pointMultiply:function(t,e,r){if(!d(t))throw new TypeError("Expected Point");if(!l(e))throw new TypeError("Expected Tweak");const n=g(r,t),i=_(t),s=v(e),o=i.mul(s);return o.isInfinity()?null:S(o,n)},privateAdd:function(t,e){if(!w(t))throw new TypeError("Expected Private");if(!l(e))throw new TypeError("Expected Tweak");const r=v(t),n=v(e),i=m(r.add(n).umod(p));return w(i)?i:null},privateSub:function(t,e){if(!w(t))throw new TypeError("Expected Private");if(!l(e))throw new TypeError("Expected Tweak");const r=v(t),n=v(e),i=m(r.sub(n).umod(p));return w(i)?i:null},sign:function(t,e){return b(t,e)},signWithEntropy:function(t,e,r){return b(t,e,r)},verify:function(t,r,n,i){if(!f(t))throw new TypeError("Expected Hash");if(!d(r))throw new TypeError("Expected Point");if(!function(t){const r=t.slice(0,32),n=t.slice(32,64);return e.isBuffer(t)&&64===t.length&&r.compare(u)<0&&n.compare(u)<0}(n))throw new TypeError("Expected Signature");const s=_(r),o=v(n.slice(0,32)),a=v(n.slice(32,64));if(i&&a.cmp(c)>0)return!1;if(o.gtn(0)<=0)return!1;if(a.gtn(0)<=0)return!1;const l=v(t),y=a.invm(p),w=l.mul(y).umod(p),g=o.mul(y).umod(p),m=h.mulAdd(w,s,g);return!m.isInfinity()&&m.x.umod(p).eq(o)}}}).call(this,r(19).Buffer)},3118:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.bitcoingold={messagePrefix:"\x18Bitcoin Gold Signed Message:\n",bech32:"btg",bip32:{public:76067358,private:76066276},pubKeyHash:38,scriptHash:23,wif:128},e.bitcoin={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},e.regtest={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"bcrt",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239},e.testnet={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"tb",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239}},3140:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(2066),i=Math.pow(2,31)-1;function s(t){return n.String(t)&&!!t.match(/^(m\/)?(\d+'?\/)*\d+'?$/)}e.UInt31=function(t){return n.UInt32(t)&&t<=i},e.BIP32Path=s,s.toJSON=()=>"BIP32 derivation path",e.Signer=function(t){return(n.Buffer(t.publicKey)||"function"===typeof t.getPublicKey)&&"function"===typeof t.sign};e.Satoshi=function(t){return n.UInt53(t)&&t<=21e14},e.ECPoint=n.quacksLike("Point"),e.Network=n.compile({messagePrefix:n.oneOf(n.Buffer,n.String),bip32:{public:n.UInt32,private:n.UInt32},pubKeyHash:n.UInt8,scriptHash:n.UInt8,wif:n.UInt8}),e.Buffer256bit=n.BufferN(32),e.Hash160bit=n.BufferN(20),e.Hash256bit=n.BufferN(32),e.Number=n.Number,e.Array=n.Array,e.Boolean=n.Boolean,e.String=n.String,e.Buffer=n.Buffer,e.Hex=n.Hex,e.maybe=n.maybe,e.tuple=n.tuple,e.UInt8=n.UInt8,e.UInt32=n.UInt32,e.UInt53=n.UInt53,e.Function=n.Function,e.BufferN=n.BufferN,e.Null=n.Null,e.oneOf=n.oneOf},3157:function(t,e,r){var n=r(3079);t.exports=function(t,e,r){if(!isFinite(n.uintOrNaN(r)))return{};for(var i=n.transactionBytes([],e),s=0,o=[],u=n.sumOrNaN(e),a=0;a<t.length;++a){var p=t[a],c=n.inputBytes(p),h=r*c,f=n.uintOrNaN(p.value);if(h>p.value){if(a===t.length-1)return{fee:r*(i+c)}}else if(i+=c,s+=f,o.push(p),!(s<u+r*i))return n.finalize(o,e,r)}return{fee:r*i}}},3158:function(t,e,r){var n=r(3079);t.exports=function(t,e,r){if(!isFinite(n.uintOrNaN(r)))return{};for(var i=n.transactionBytes([],e),s=0,o=[],u=n.sumOrNaN(e),a=n.dustThreshold({},r),p=0;p<t.length;++p){var c=t[p],h=n.inputBytes(c),f=r*(i+h),l=n.uintOrNaN(c.value);if(!(s+l>u+f+a)&&(i+=h,s+=l,o.push(c),!(s<u+f)))return n.finalize(o,e,r)}return{fee:r*i}}},3159:function(t,e,r){(function(t){var n,i=function(t){"use strict";var e=1e7,r=9007199254740992,n=h(r),s="function"===typeof BigInt;function o(t,e,r,n){return"undefined"===typeof t?o[0]:"undefined"!==typeof e&&(10!==+e||r)?D(t,e,r,n):j(t)}function u(t,e){this.value=t,this.sign=e,this.isSmall=!1}function a(t){this.value=t,this.sign=t<0,this.isSmall=!0}function p(t){this.value=t}function c(t){return-r<t&&t<r}function h(t){return t<1e7?[t]:t<1e14?[t%1e7,Math.floor(t/1e7)]:[t%1e7,Math.floor(t/1e7)%1e7,Math.floor(t/1e14)]}function f(t){l(t);var r=t.length;if(r<4&&k(t,n)<0)switch(r){case 0:return 0;case 1:return t[0];case 2:return t[0]+t[1]*e;default:return t[0]+(t[1]+t[2]*e)*e}return t}function l(t){for(var e=t.length;0===t[--e];);t.length=e+1}function d(t){for(var e=new Array(t),r=-1;++r<t;)e[r]=0;return e}function y(t){return t>0?Math.floor(t):Math.ceil(t)}function w(t,r){var n,i,s=t.length,o=r.length,u=new Array(s),a=0,p=e;for(i=0;i<o;i++)a=(n=t[i]+r[i]+a)>=p?1:0,u[i]=n-a*p;for(;i<s;)a=(n=t[i]+a)===p?1:0,u[i++]=n-a*p;return a>0&&u.push(a),u}function g(t,e){return t.length>=e.length?w(t,e):w(e,t)}function v(t,r){var n,i,s=t.length,o=new Array(s),u=e;for(i=0;i<s;i++)n=t[i]-u+r,r=Math.floor(n/u),o[i]=n-r*u,r+=1;for(;r>0;)o[i++]=r%u,r=Math.floor(r/u);return o}function m(t,e){var r,n,i=t.length,s=e.length,o=new Array(i),u=0;for(r=0;r<s;r++)(n=t[r]-u-e[r])<0?(n+=1e7,u=1):u=0,o[r]=n;for(r=s;r<i;r++){if(!((n=t[r]-u)<0)){o[r++]=n;break}n+=1e7,o[r]=n}for(;r<i;r++)o[r]=t[r];return l(o),o}function _(t,e,r){var n,i,s=t.length,o=new Array(s),p=-e;for(n=0;n<s;n++)i=t[n]+p,p=Math.floor(i/1e7),i%=1e7,o[n]=i<0?i+1e7:i;return"number"===typeof(o=f(o))?(r&&(o=-o),new a(o)):new u(o,r)}function S(t,e){var r,n,i,s,o=t.length,u=e.length,a=d(o+u);for(i=0;i<o;++i){s=t[i];for(var p=0;p<u;++p)r=s*e[p]+a[i+p],n=Math.floor(r/1e7),a[i+p]=r-1e7*n,a[i+p+1]+=n}return l(a),a}function b(t,r){var n,i,s=t.length,o=new Array(s),u=e,a=0;for(i=0;i<s;i++)n=t[i]*r+a,a=Math.floor(n/u),o[i]=n-a*u;for(;a>0;)o[i++]=a%u,a=Math.floor(a/u);return o}function E(t,e){for(var r=[];e-- >0;)r.push(0);return r.concat(t)}function P(t,r,n){return new u(t<e?b(r,t):S(r,h(t)),n)}function O(t){var e,r,n,i,s=t.length,o=d(s+s);for(n=0;n<s;n++){r=0-(i=t[n])*i;for(var u=n;u<s;u++)e=i*t[u]*2+o[n+u]+r,r=Math.floor(e/1e7),o[n+u]=e-1e7*r;o[n+s]=r}return l(o),o}function T(t,e){var r,n,i,s,o=t.length,u=d(o);for(i=0,r=o-1;r>=0;--r)i=(s=1e7*i+t[r])-(n=y(s/e))*e,u[r]=0|n;return[u,0|i]}function I(t,r){var n,i=j(r);if(s)return[new p(t.value/i.value),new p(t.value%i.value)];var c,w=t.value,g=i.value;if(0===g)throw new Error("Cannot divide by zero");if(t.isSmall)return i.isSmall?[new a(y(w/g)),new a(w%g)]:[o[0],t];if(i.isSmall){if(1===g)return[t,o[0]];if(-1==g)return[t.negate(),o[0]];var v=Math.abs(g);if(v<e){c=f((n=T(w,v))[0]);var _=n[1];return t.sign&&(_=-_),"number"===typeof c?(t.sign!==i.sign&&(c=-c),[new a(c),new a(_)]):[new u(c,t.sign!==i.sign),new a(_)]}g=h(v)}var S=k(w,g);if(-1===S)return[o[0],t];if(0===S)return[o[t.sign===i.sign?1:-1],o[0]];c=(n=w.length+g.length<=200?function(t,r){var n,i,s,o,u,a,p,c=t.length,h=r.length,l=e,y=d(r.length),w=r[h-1],g=Math.ceil(l/(2*w)),v=b(t,g),m=b(r,g);for(v.length<=c&&v.push(0),m.push(0),w=m[h-1],i=c-h;i>=0;i--){for(n=l-1,v[i+h]!==w&&(n=Math.floor((v[i+h]*l+v[i+h-1])/w)),s=0,o=0,a=m.length,u=0;u<a;u++)s+=n*m[u],p=Math.floor(s/l),o+=v[i+u]-(s-p*l),s=p,o<0?(v[i+u]=o+l,o=-1):(v[i+u]=o,o=0);for(;0!==o;){for(n-=1,s=0,u=0;u<a;u++)(s+=v[i+u]-l+m[u])<0?(v[i+u]=s+l,s=0):(v[i+u]=s,s=1);o+=s}y[i]=n}return v=T(v,g)[0],[f(y),f(v)]}(w,g):function(t,e){for(var r,n,i,s,o,u=t.length,a=e.length,p=[],c=[];u;)if(c.unshift(t[--u]),l(c),k(c,e)<0)p.push(0);else{i=1e7*c[(n=c.length)-1]+c[n-2],s=1e7*e[a-1]+e[a-2],n>a&&(i=1e7*(i+1)),r=Math.ceil(i/s);do{if(k(o=b(e,r),c)<=0)break;r--}while(r);p.push(r),c=m(c,o)}return p.reverse(),[f(p),f(c)]}(w,g))[0];var E=t.sign!==i.sign,P=n[1],O=t.sign;return"number"===typeof c?(E&&(c=-c),c=new a(c)):c=new u(c,E),"number"===typeof P?(O&&(P=-P),P=new a(P)):P=new u(P,O),[c,P]}function k(t,e){if(t.length!==e.length)return t.length>e.length?1:-1;for(var r=t.length-1;r>=0;r--)if(t[r]!==e[r])return t[r]>e[r]?1:-1;return 0}function A(t){var e=t.abs();return!e.isUnit()&&(!!(e.equals(2)||e.equals(3)||e.equals(5))||!(e.isEven()||e.isDivisibleBy(3)||e.isDivisibleBy(5))&&(!!e.lesser(49)||void 0))}function N(t,e){for(var r,n,s,o=t.prev(),u=o,a=0;u.isEven();)u=u.divide(2),a++;t:for(n=0;n<e.length;n++)if(!t.lesser(e[n])&&!(s=i(e[n]).modPow(u,t)).isUnit()&&!s.equals(o)){for(r=a-1;0!=r;r--){if((s=s.square().mod(t)).isUnit())return!1;if(s.equals(o))continue t}return!1}return!0}u.prototype=Object.create(o.prototype),a.prototype=Object.create(o.prototype),p.prototype=Object.create(o.prototype),u.prototype.add=function(t){var e=j(t);if(this.sign!==e.sign)return this.subtract(e.negate());var r=this.value,n=e.value;return e.isSmall?new u(v(r,Math.abs(n)),this.sign):new u(g(r,n),this.sign)},u.prototype.plus=u.prototype.add,a.prototype.add=function(t){var e=j(t),r=this.value;if(r<0!==e.sign)return this.subtract(e.negate());var n=e.value;if(e.isSmall){if(c(r+n))return new a(r+n);n=h(Math.abs(n))}return new u(v(n,Math.abs(r)),r<0)},a.prototype.plus=a.prototype.add,p.prototype.add=function(t){return new p(this.value+j(t).value)},p.prototype.plus=p.prototype.add,u.prototype.subtract=function(t){var e=j(t);if(this.sign!==e.sign)return this.add(e.negate());var r=this.value,n=e.value;return e.isSmall?_(r,Math.abs(n),this.sign):function(t,e,r){var n;return k(t,e)>=0?n=m(t,e):(n=m(e,t),r=!r),"number"===typeof(n=f(n))?(r&&(n=-n),new a(n)):new u(n,r)}(r,n,this.sign)},u.prototype.minus=u.prototype.subtract,a.prototype.subtract=function(t){var e=j(t),r=this.value;if(r<0!==e.sign)return this.add(e.negate());var n=e.value;return e.isSmall?new a(r-n):_(n,Math.abs(r),r>=0)},a.prototype.minus=a.prototype.subtract,p.prototype.subtract=function(t){return new p(this.value-j(t).value)},p.prototype.minus=p.prototype.subtract,u.prototype.negate=function(){return new u(this.value,!this.sign)},a.prototype.negate=function(){var t=this.sign,e=new a(-this.value);return e.sign=!t,e},p.prototype.negate=function(){return new p(-this.value)},u.prototype.abs=function(){return new u(this.value,!1)},a.prototype.abs=function(){return new a(Math.abs(this.value))},p.prototype.abs=function(){return new p(this.value>=0?this.value:-this.value)},u.prototype.multiply=function(t){var r,n,i,s=j(t),a=this.value,p=s.value,c=this.sign!==s.sign;if(s.isSmall){if(0===p)return o[0];if(1===p)return this;if(-1===p)return this.negate();if((r=Math.abs(p))<e)return new u(b(a,r),c);p=h(r)}return n=a.length,i=p.length,new u(-.012*n-.012*i+15e-6*n*i>0?function t(e,r){var n=Math.max(e.length,r.length);if(n<=30)return S(e,r);n=Math.ceil(n/2);var i=e.slice(n),s=e.slice(0,n),o=r.slice(n),u=r.slice(0,n),a=t(s,u),p=t(i,o),c=t(g(s,i),g(u,o)),h=g(g(a,E(m(m(c,a),p),n)),E(p,2*n));return l(h),h}(a,p):S(a,p),c)},u.prototype.times=u.prototype.multiply,a.prototype._multiplyBySmall=function(t){return c(t.value*this.value)?new a(t.value*this.value):P(Math.abs(t.value),h(Math.abs(this.value)),this.sign!==t.sign)},u.prototype._multiplyBySmall=function(t){return 0===t.value?o[0]:1===t.value?this:-1===t.value?this.negate():P(Math.abs(t.value),this.value,this.sign!==t.sign)},a.prototype.multiply=function(t){return j(t)._multiplyBySmall(this)},a.prototype.times=a.prototype.multiply,p.prototype.multiply=function(t){return new p(this.value*j(t).value)},p.prototype.times=p.prototype.multiply,u.prototype.square=function(){return new u(O(this.value),!1)},a.prototype.square=function(){var t=this.value*this.value;return c(t)?new a(t):new u(O(h(Math.abs(this.value))),!1)},p.prototype.square=function(t){return new p(this.value*this.value)},u.prototype.divmod=function(t){var e=I(this,t);return{quotient:e[0],remainder:e[1]}},p.prototype.divmod=a.prototype.divmod=u.prototype.divmod,u.prototype.divide=function(t){return I(this,t)[0]},p.prototype.over=p.prototype.divide=function(t){return new p(this.value/j(t).value)},a.prototype.over=a.prototype.divide=u.prototype.over=u.prototype.divide,u.prototype.mod=function(t){return I(this,t)[1]},p.prototype.mod=p.prototype.remainder=function(t){return new p(this.value%j(t).value)},a.prototype.remainder=a.prototype.mod=u.prototype.remainder=u.prototype.mod,u.prototype.pow=function(t){var e,r,n,i=j(t),s=this.value,u=i.value;if(0===u)return o[1];if(0===s)return o[0];if(1===s)return o[1];if(-1===s)return i.isEven()?o[1]:o[-1];if(i.sign)return o[0];if(!i.isSmall)throw new Error("The exponent "+i.toString()+" is too large.");if(this.isSmall&&c(e=Math.pow(s,u)))return new a(y(e));for(r=this,n=o[1];!0&u&&(n=n.times(r),--u),0!==u;)u/=2,r=r.square();return n},a.prototype.pow=u.prototype.pow,p.prototype.pow=function(t){var e=j(t),r=this.value,n=e.value,i=BigInt(0),s=BigInt(1),u=BigInt(2);if(n===i)return o[1];if(r===i)return o[0];if(r===s)return o[1];if(r===BigInt(-1))return e.isEven()?o[1]:o[-1];if(e.isNegative())return new p(i);for(var a=this,c=o[1];(n&s)===s&&(c=c.times(a),--n),n!==i;)n/=u,a=a.square();return c},u.prototype.modPow=function(t,e){if(t=j(t),(e=j(e)).isZero())throw new Error("Cannot take modPow with modulus 0");var r=o[1],n=this.mod(e);for(t.isNegative()&&(t=t.multiply(o[-1]),n=n.modInv(e));t.isPositive();){if(n.isZero())return o[0];t.isOdd()&&(r=r.multiply(n).mod(e)),t=t.divide(2),n=n.square().mod(e)}return r},p.prototype.modPow=a.prototype.modPow=u.prototype.modPow,u.prototype.compareAbs=function(t){var e=j(t),r=this.value,n=e.value;return e.isSmall?1:k(r,n)},a.prototype.compareAbs=function(t){var e=j(t),r=Math.abs(this.value),n=e.value;return e.isSmall?r===(n=Math.abs(n))?0:r>n?1:-1:-1},p.prototype.compareAbs=function(t){var e=this.value,r=j(t).value;return(e=e>=0?e:-e)===(r=r>=0?r:-r)?0:e>r?1:-1},u.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=j(t),r=this.value,n=e.value;return this.sign!==e.sign?e.sign?1:-1:e.isSmall?this.sign?-1:1:k(r,n)*(this.sign?-1:1)},u.prototype.compareTo=u.prototype.compare,a.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=j(t),r=this.value,n=e.value;return e.isSmall?r==n?0:r>n?1:-1:r<0!==e.sign?r<0?-1:1:r<0?1:-1},a.prototype.compareTo=a.prototype.compare,p.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=this.value,r=j(t).value;return e===r?0:e>r?1:-1},p.prototype.compareTo=p.prototype.compare,u.prototype.equals=function(t){return 0===this.compare(t)},p.prototype.eq=p.prototype.equals=a.prototype.eq=a.prototype.equals=u.prototype.eq=u.prototype.equals,u.prototype.notEquals=function(t){return 0!==this.compare(t)},p.prototype.neq=p.prototype.notEquals=a.prototype.neq=a.prototype.notEquals=u.prototype.neq=u.prototype.notEquals,u.prototype.greater=function(t){return this.compare(t)>0},p.prototype.gt=p.prototype.greater=a.prototype.gt=a.prototype.greater=u.prototype.gt=u.prototype.greater,u.prototype.lesser=function(t){return this.compare(t)<0},p.prototype.lt=p.prototype.lesser=a.prototype.lt=a.prototype.lesser=u.prototype.lt=u.prototype.lesser,u.prototype.greaterOrEquals=function(t){return this.compare(t)>=0},p.prototype.geq=p.prototype.greaterOrEquals=a.prototype.geq=a.prototype.greaterOrEquals=u.prototype.geq=u.prototype.greaterOrEquals,u.prototype.lesserOrEquals=function(t){return this.compare(t)<=0},p.prototype.leq=p.prototype.lesserOrEquals=a.prototype.leq=a.prototype.lesserOrEquals=u.prototype.leq=u.prototype.lesserOrEquals,u.prototype.isEven=function(){return 0===(1&this.value[0])},a.prototype.isEven=function(){return 0===(1&this.value)},p.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},u.prototype.isOdd=function(){return 1===(1&this.value[0])},a.prototype.isOdd=function(){return 1===(1&this.value)},p.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},u.prototype.isPositive=function(){return!this.sign},a.prototype.isPositive=function(){return this.value>0},p.prototype.isPositive=a.prototype.isPositive,u.prototype.isNegative=function(){return this.sign},a.prototype.isNegative=function(){return this.value<0},p.prototype.isNegative=a.prototype.isNegative,u.prototype.isUnit=function(){return!1},a.prototype.isUnit=function(){return 1===Math.abs(this.value)},p.prototype.isUnit=function(){return this.abs().value===BigInt(1)},u.prototype.isZero=function(){return!1},a.prototype.isZero=function(){return 0===this.value},p.prototype.isZero=function(){return this.value===BigInt(0)},u.prototype.isDivisibleBy=function(t){var e=j(t);return!e.isZero()&&(!!e.isUnit()||(0===e.compareAbs(2)?this.isEven():this.mod(e).isZero()))},p.prototype.isDivisibleBy=a.prototype.isDivisibleBy=u.prototype.isDivisibleBy,u.prototype.isPrime=function(t){var e=A(this);if(void 0!==e)return e;var r=this.abs(),n=r.bitLength();if(n<=64)return N(r,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var s=Math.log(2)*n.toJSNumber(),o=Math.ceil(!0===t?2*Math.pow(s,2):s),u=[],a=0;a<o;a++)u.push(i(a+2));return N(r,u)},p.prototype.isPrime=a.prototype.isPrime=u.prototype.isPrime,u.prototype.isProbablePrime=function(t,e){var r=A(this);if(void 0!==r)return r;for(var n=this.abs(),s=void 0===t?5:t,o=[],u=0;u<s;u++)o.push(i.randBetween(2,n.minus(2),e));return N(n,o)},p.prototype.isProbablePrime=a.prototype.isProbablePrime=u.prototype.isProbablePrime,u.prototype.modInv=function(t){for(var e,r,n,s=i.zero,o=i.one,u=j(t),a=this.abs();!a.isZero();)e=u.divide(a),r=s,n=u,s=o,u=a,o=r.subtract(e.multiply(o)),a=n.subtract(e.multiply(a));if(!u.isUnit())throw new Error(this.toString()+" and "+t.toString()+" are not co-prime");return-1===s.compare(0)&&(s=s.add(t)),this.isNegative()?s.negate():s},p.prototype.modInv=a.prototype.modInv=u.prototype.modInv,u.prototype.next=function(){var t=this.value;return this.sign?_(t,1,this.sign):new u(v(t,1),this.sign)},a.prototype.next=function(){var t=this.value;return t+1<r?new a(t+1):new u(n,!1)},p.prototype.next=function(){return new p(this.value+BigInt(1))},u.prototype.prev=function(){var t=this.value;return this.sign?new u(v(t,1),!0):_(t,1,this.sign)},a.prototype.prev=function(){var t=this.value;return t-1>-r?new a(t-1):new u(n,!0)},p.prototype.prev=function(){return new p(this.value-BigInt(1))};for(var H=[1];2*H[H.length-1]<=e;)H.push(2*H[H.length-1]);var U=H.length,B=H[U-1];function C(t){return Math.abs(t)<=e}function x(t,e,r){e=j(e);for(var n=t.isNegative(),s=e.isNegative(),o=n?t.not():t,u=s?e.not():e,a=0,p=0,c=null,h=null,f=[];!o.isZero()||!u.isZero();)a=(c=I(o,B))[1].toJSNumber(),n&&(a=B-1-a),p=(h=I(u,B))[1].toJSNumber(),s&&(p=B-1-p),o=c[0],u=h[0],f.push(r(a,p));for(var l=0!==r(n?1:0,s?1:0)?i(-1):i(0),d=f.length-1;d>=0;d-=1)l=l.multiply(B).add(i(f[d]));return l}u.prototype.shiftLeft=function(t){var e=j(t).toJSNumber();if(!C(e))throw new Error(String(e)+" is too large for shifting.");if(e<0)return this.shiftRight(-e);var r=this;if(r.isZero())return r;for(;e>=U;)r=r.multiply(B),e-=U-1;return r.multiply(H[e])},p.prototype.shiftLeft=a.prototype.shiftLeft=u.prototype.shiftLeft,u.prototype.shiftRight=function(t){var e,r=j(t).toJSNumber();if(!C(r))throw new Error(String(r)+" is too large for shifting.");if(r<0)return this.shiftLeft(-r);for(var n=this;r>=U;){if(n.isZero()||n.isNegative()&&n.isUnit())return n;n=(e=I(n,B))[1].isNegative()?e[0].prev():e[0],r-=U-1}return(e=I(n,H[r]))[1].isNegative()?e[0].prev():e[0]},p.prototype.shiftRight=a.prototype.shiftRight=u.prototype.shiftRight,u.prototype.not=function(){return this.negate().prev()},p.prototype.not=a.prototype.not=u.prototype.not,u.prototype.and=function(t){return x(this,t,(function(t,e){return t&e}))},p.prototype.and=a.prototype.and=u.prototype.and,u.prototype.or=function(t){return x(this,t,(function(t,e){return t|e}))},p.prototype.or=a.prototype.or=u.prototype.or,u.prototype.xor=function(t){return x(this,t,(function(t,e){return t^e}))},p.prototype.xor=a.prototype.xor=u.prototype.xor;function M(t){var r=t.value,n="number"===typeof r?r|1<<30:"bigint"===typeof r?r|BigInt(1<<30):r[0]+r[1]*e|1073758208;return n&-n}function R(t,e){return t=j(t),e=j(e),t.greater(e)?t:e}function K(t,e){return t=j(t),e=j(e),t.lesser(e)?t:e}function L(t,e){if(t=j(t).abs(),e=j(e).abs(),t.equals(e))return t;if(t.isZero())return e;if(e.isZero())return t;for(var r,n,i=o[1];t.isEven()&&e.isEven();)r=K(M(t),M(e)),t=t.divide(r),e=e.divide(r),i=i.multiply(r);for(;t.isEven();)t=t.divide(M(t));do{for(;e.isEven();)e=e.divide(M(e));t.greater(e)&&(n=e,e=t,t=n),e=e.subtract(t)}while(!e.isZero());return i.isUnit()?t:t.multiply(i)}u.prototype.bitLength=function(){var t=this;return t.compareTo(i(0))<0&&(t=t.negate().subtract(i(1))),0===t.compareTo(i(0))?i(0):i(function t(e,r){if(r.compareTo(e)<=0){var n=t(e,r.square(r)),s=n.p,o=n.e,u=s.multiply(r);return u.compareTo(e)<=0?{p:u,e:2*o+1}:{p:s,e:2*o}}return{p:i(1),e:0}}(t,i(2)).e).add(i(1))},p.prototype.bitLength=a.prototype.bitLength=u.prototype.bitLength;var D=function(t,e,r,n){r=r||"0123456789abcdefghijklmnopqrstuvwxyz",t=String(t),n||(t=t.toLowerCase(),r=r.toLowerCase());var i,s=t.length,o=Math.abs(e),u={};for(i=0;i<r.length;i++)u[r[i]]=i;for(i=0;i<s;i++){if("-"!==(c=t[i])&&(c in u&&u[c]>=o)){if("1"===c&&1===o)continue;throw new Error(c+" is not a valid digit in base "+e+".")}}e=j(e);var a=[],p="-"===t[0];for(i=p?1:0;i<t.length;i++){var c;if((c=t[i])in u)a.push(j(u[c]));else{if("<"!==c)throw new Error(c+" is not a valid character");var h=i;do{i++}while(">"!==t[i]&&i<t.length);a.push(j(t.slice(h+1,i)))}}return q(a,e,p)};function q(t,e,r){var n,i=o[0],s=o[1];for(n=t.length-1;n>=0;n--)i=i.add(t[n].times(s)),s=s.times(e);return r?i.negate():i}function F(t,e){if((e=i(e)).isZero()){if(t.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(e.equals(-1)){if(t.isZero())return{value:[0],isNegative:!1};if(t.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-t.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var r=Array.apply(null,Array(t.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return r.unshift([1]),{value:[].concat.apply([],r),isNegative:!1}}var n=!1;if(t.isNegative()&&e.isPositive()&&(n=!0,t=t.abs()),e.isUnit())return t.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(t.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:n};for(var s,o=[],u=t;u.isNegative()||u.compareAbs(e)>=0;){s=u.divmod(e),u=s.quotient;var a=s.remainder;a.isNegative()&&(a=e.minus(a).abs(),u=u.next()),o.push(a.toJSNumber())}return o.push(u.toJSNumber()),{value:o.reverse(),isNegative:n}}function W(t,e,r){var n=F(t,e);return(n.isNegative?"-":"")+n.value.map((function(t){return function(t,e){return t<(e=e||"0123456789abcdefghijklmnopqrstuvwxyz").length?e[t]:"<"+t+">"}(t,r)})).join("")}function V(t){if(c(+t)){var e=+t;if(e===y(e))return s?new p(BigInt(e)):new a(e);throw new Error("Invalid integer: "+t)}var r="-"===t[0];r&&(t=t.slice(1));var n=t.split(/e/i);if(n.length>2)throw new Error("Invalid integer: "+n.join("e"));if(2===n.length){var i=n[1];if("+"===i[0]&&(i=i.slice(1)),(i=+i)!==y(i)||!c(i))throw new Error("Invalid integer: "+i+" is not a valid exponent.");var o=n[0],h=o.indexOf(".");if(h>=0&&(i-=o.length-h-1,o=o.slice(0,h)+o.slice(h+1)),i<0)throw new Error("Cannot include negative exponent part for integers");t=o+=new Array(i+1).join("0")}if(!/^([0-9][0-9]*)$/.test(t))throw new Error("Invalid integer: "+t);if(s)return new p(BigInt(r?"-"+t:t));for(var f=[],d=t.length,w=d-7;d>0;)f.push(+t.slice(w,d)),(w-=7)<0&&(w=0),d-=7;return l(f),new u(f,r)}function j(t){return"number"===typeof t?function(t){if(s)return new p(BigInt(t));if(c(t)){if(t!==y(t))throw new Error(t+" is not an integer.");return new a(t)}return V(t.toString())}(t):"string"===typeof t?V(t):"bigint"===typeof t?new p(t):t}u.prototype.toArray=function(t){return F(this,t)},a.prototype.toArray=function(t){return F(this,t)},p.prototype.toArray=function(t){return F(this,t)},u.prototype.toString=function(t,e){if(void 0===t&&(t=10),10!==t)return W(this,t,e);for(var r,n=this.value,i=n.length,s=String(n[--i]);--i>=0;)r=String(n[i]),s+="0000000".slice(r.length)+r;return(this.sign?"-":"")+s},a.prototype.toString=function(t,e){return void 0===t&&(t=10),10!=t?W(this,t,e):String(this.value)},p.prototype.toString=a.prototype.toString,p.prototype.toJSON=u.prototype.toJSON=a.prototype.toJSON=function(){return this.toString()},u.prototype.valueOf=function(){return parseInt(this.toString(),10)},u.prototype.toJSNumber=u.prototype.valueOf,a.prototype.valueOf=function(){return this.value},a.prototype.toJSNumber=a.prototype.valueOf,p.prototype.valueOf=p.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};for(var G=0;G<1e3;G++)o[G]=j(G),G>0&&(o[-G]=j(-G));return o.one=o[1],o.zero=o[0],o.minusOne=o[-1],o.max=R,o.min=K,o.gcd=L,o.lcm=function(t,e){return t=j(t).abs(),e=j(e).abs(),t.divide(L(t,e)).multiply(e)},o.isInstance=function(t){return t instanceof u||t instanceof a||t instanceof p},o.randBetween=function(t,r,n){t=j(t),r=j(r);var i=n||Math.random,s=K(t,r),u=R(t,r).subtract(s).add(1);if(u.isSmall)return s.add(Math.floor(i()*u));for(var a=F(u,e).value,p=[],c=!0,h=0;h<a.length;h++){var f=c?a[h]+(h+1<a.length?a[h+1]/e:0):e,l=y(i()*f);p.push(l),l<a[h]&&(c=!1)}return s.add(o.fromArray(p,e,!1))},o.fromArray=function(t,e,r){return q(t.map(j),j(e||10),r)},o}();t.hasOwnProperty("exports")&&(t.exports=i),void 0===(n=function(){return i}.call(e,r,e,t))||(t.exports=n)}).call(this,r(156)(t))},3160:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(428);function i(t){try{return n("rmd160").update(t).digest()}catch(e){return n("ripemd160").update(t).digest()}}function s(t){return n("sha256").update(t).digest()}e.ripemd160=i,e.sha1=function(t){return n("sha1").update(t).digest()},e.sha256=s,e.hash160=function(t){return i(s(t))},e.hash256=function(t){return s(s(t))}},3200:function(t,e,r){"use strict";var n=r(203),i=r(3277),s=r(2069),o=r(202).Buffer,u=r(2071),a=r(1142),p=r(1143),c=o.alloc(128);function h(t,e){s.call(this,"digest"),"string"===typeof e&&(e=o.from(e));var r="sha512"===t||"sha384"===t?128:64;(this._alg=t,this._key=e,e.length>r)?e=("rmd160"===t?new a:p(t)).update(e).digest():e.length<r&&(e=o.concat([e,c],r));for(var n=this._ipad=o.allocUnsafe(r),i=this._opad=o.allocUnsafe(r),u=0;u<r;u++)n[u]=54^e[u],i[u]=92^e[u];this._hash="rmd160"===t?new a:p(t),this._hash.update(n)}n(h,s),h.prototype._update=function(t){this._hash.update(t)},h.prototype._final=function(){var t=this._hash.digest();return("rmd160"===this._alg?new a:p(this._alg)).update(this._opad).update(t).digest()},t.exports=function(t,e){return"rmd160"===(t=t.toLowerCase())||"ripemd160"===t?new h("rmd160",e):"md5"===t?new i(u,e):new h(t,e)}},3216:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.prop=function(t,e,r){Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get(){const t=r.call(this);return this[e]=t,t},set(t){Object.defineProperty(this,e,{configurable:!0,enumerable:!0,value:t,writable:!0})}})},e.value=function(t){let e;return()=>(void 0!==e||(e=t()),e)}},3228:function(t,e,r){var n=r(3157),i=r(3158),s=r(3079);function o(t,e){return t.value-e*s.inputBytes(t)}t.exports=function(t,e,r){t=t.concat().sort((function(t,e){return o(e,r)-o(t,r)}));var s=i(t,e,r);return s.inputs?s:n(t,e,r)}},3229:function(t,e,r){var n=r(3079);t.exports=function(t,e,r){if(!isFinite(n.uintOrNaN(r)))return{};var i=n.transactionBytes(t,e),s=r*i;if(0===e.length)return{fee:s};var o=n.sumOrNaN(t)-n.sumForgiving(e)-s;if(!isFinite(o)||o<0)return{fee:s};var u=e.reduce((function(t,e){return t+!isFinite(e.value)}),0);if(0===o&&0===u)return n.finalize(t,e,r);var a=e.reduce((function(t,e){return t+!e.value}),0),p=Math.floor(o/a);return e.every((function(t){return void 0!==t.value||p>n.dustThreshold(t,r)}))?(e=e.map((function(t){if(void 0!==t.value)return t;var e={};for(var r in t)e[r]=t[r];return e.value=p,e})),n.finalize(t,e,r)):{fee:s}}},3232:function(t,e,r){(function(e){var n=r(391);function i(t,e){if(void 0!==e&&t[0]!==e)throw new Error("Invalid network version");if(33===t.length)return{version:t[0],privateKey:t.slice(1,33),compressed:!1};if(34!==t.length)throw new Error("Invalid WIF length");if(1!==t[33])throw new Error("Invalid compression flag");return{version:t[0],privateKey:t.slice(1,33),compressed:!0}}function s(t,r,n){var i=new e(n?34:33);return i.writeUInt8(t,0),r.copy(i,1),n&&(i[33]=1),i}t.exports={decode:function(t,e){return i(n.decode(t),e)},decodeRaw:i,encode:function(t,e,r){return"number"===typeof t?n.encode(s(t,e,r)):n.encode(s(t.version,t.privateKey,t.compressed))},encodeRaw:s}}).call(this,r(19).Buffer)},3274:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(3275);e.fromSeed=n.fromSeed,e.fromBase58=n.fromBase58,e.fromPublicKey=n.fromPublicKey,e.fromPrivateKey=n.fromPrivateKey},3275:function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});const n=r(3276),i=r(391),s=r(3117),o=r(2066),u=r(3232),a=o.BufferN(32),p=o.compile({wif:o.UInt8,bip32:{public:o.UInt32,private:o.UInt32}}),c={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},h=Math.pow(2,31)-1;function f(t){return o.String(t)&&null!==t.match(/^(m\/)?(\d+'?\/)*\d+'?$/)}function l(t){return o.UInt32(t)&&t<=h}class d{constructor(t,e,r,n,i=0,s=0,u=0){this.__D=t,this.__Q=e,this.chainCode=r,this.network=n,this.__DEPTH=i,this.__INDEX=s,this.__PARENT_FINGERPRINT=u,o(p,n),this.lowR=!1}get depth(){return this.__DEPTH}get index(){return this.__INDEX}get parentFingerprint(){return this.__PARENT_FINGERPRINT}get publicKey(){return void 0===this.__Q&&(this.__Q=s.pointFromScalar(this.__D,!0)),this.__Q}get privateKey(){return this.__D}get identifier(){return n.hash160(this.publicKey)}get fingerprint(){return this.identifier.slice(0,4)}get compressed(){return!0}isNeutered(){return void 0===this.__D}neutered(){return g(this.publicKey,this.chainCode,this.network,this.depth,this.index,this.parentFingerprint)}toBase58(){const e=this.network,r=this.isNeutered()?e.bip32.public:e.bip32.private,n=t.allocUnsafe(78);return n.writeUInt32BE(r,0),n.writeUInt8(this.depth,4),n.writeUInt32BE(this.parentFingerprint,5),n.writeUInt32BE(this.index,9),this.chainCode.copy(n,13),this.isNeutered()?this.publicKey.copy(n,45):(n.writeUInt8(0,45),this.privateKey.copy(n,46)),i.encode(n)}toWIF(){if(!this.privateKey)throw new TypeError("Missing private key");return u.encode(this.network.wif,this.privateKey,!0)}derive(e){o(o.UInt32,e);const r=e>=2147483648,i=t.allocUnsafe(37);if(r){if(this.isNeutered())throw new TypeError("Missing private key for hardened child key");i[0]=0,this.privateKey.copy(i,1),i.writeUInt32BE(e,33)}else this.publicKey.copy(i,0),i.writeUInt32BE(e,33);const u=n.hmacSHA512(this.chainCode,i),a=u.slice(0,32),p=u.slice(32);if(!s.isPrivate(a))return this.derive(e+1);let c;if(this.isNeutered()){const t=s.pointAddScalar(this.publicKey,a,!0);if(null===t)return this.derive(e+1);c=g(t,p,this.network,this.depth+1,e,this.fingerprint.readUInt32BE(0))}else{const t=s.privateAdd(this.privateKey,a);if(null==t)return this.derive(e+1);c=w(t,p,this.network,this.depth+1,e,this.fingerprint.readUInt32BE(0))}return c}deriveHardened(t){return o(l,t),this.derive(t+2147483648)}derivePath(t){o(f,t);let e=t.split("/");if("m"===e[0]){if(this.parentFingerprint)throw new TypeError("Expected master, got child");e=e.slice(1)}return e.reduce((t,e)=>{let r;return"'"===e.slice(-1)?(r=parseInt(e.slice(0,-1),10),t.deriveHardened(r)):(r=parseInt(e,10),t.derive(r))},this)}sign(e,r){if(!this.privateKey)throw new Error("Missing private key");if(void 0===r&&(r=this.lowR),!1===r)return s.sign(e,this.privateKey);{let r=s.sign(e,this.privateKey);const n=t.alloc(32,0);let i=0;for(;r[0]>127;)i++,n.writeUIntLE(i,0,6),r=s.signWithEntropy(e,this.privateKey,n);return r}}verify(t,e){return s.verify(t,this.publicKey,e)}}function y(t,e,r){return w(t,e,r)}function w(t,e,r,n,i,u){if(o({privateKey:a,chainCode:a},{privateKey:t,chainCode:e}),r=r||c,!s.isPrivate(t))throw new TypeError("Private key not in range [1, n)");return new d(t,void 0,e,r,n,i,u)}function g(t,e,r,n,i,u){if(o({publicKey:o.BufferN(33),chainCode:a},{publicKey:t,chainCode:e}),r=r||c,!s.isPoint(t))throw new TypeError("Point is not on the curve");return new d(void 0,t,e,r,n,i,u)}e.fromBase58=function(t,e){const r=i.decode(t);if(78!==r.length)throw new TypeError("Invalid buffer length");e=e||c;const n=r.readUInt32BE(0);if(n!==e.bip32.private&&n!==e.bip32.public)throw new TypeError("Invalid network version");const s=r[4],o=r.readUInt32BE(5);if(0===s&&0!==o)throw new TypeError("Invalid parent fingerprint");const u=r.readUInt32BE(9);if(0===s&&0!==u)throw new TypeError("Invalid index");const a=r.slice(13,45);let p;if(n===e.bip32.private){if(0!==r.readUInt8(45))throw new TypeError("Invalid private key");p=w(r.slice(46,78),a,e,s,u,o)}else{p=g(r.slice(45,78),a,e,s,u,o)}return p},e.fromPrivateKey=y,e.fromPublicKey=function(t,e,r){return g(t,e,r)},e.fromSeed=function(e,r){if(o(o.Buffer,e),e.length<16)throw new TypeError("Seed should be at least 128 bits");if(e.length>64)throw new TypeError("Seed should be at most 512 bits");r=r||c;const i=n.hmacSHA512(t.from("Bitcoin seed","utf8"),e);return y(i.slice(0,32),i.slice(32),r)}}).call(this,r(19).Buffer)},3276:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(428),i=r(3200);e.hash160=function(t){const e=n("sha256").update(t).digest();try{return n("rmd160").update(e).digest()}catch(r){return n("ripemd160").update(e).digest()}},e.hmacSHA512=function(t,e){return i("sha512",t).update(e).digest()}},3277:function(t,e,r){"use strict";var n=r(203),i=r(202).Buffer,s=r(2069),o=i.alloc(128);function u(t,e){s.call(this,"digest"),"string"===typeof e&&(e=i.from(e)),this._alg=t,this._key=e,e.length>64?e=t(e):e.length<64&&(e=i.concat([e,o],64));for(var r=this._ipad=i.allocUnsafe(64),n=this._opad=i.allocUnsafe(64),u=0;u<64;u++)r[u]=54^e[u],n[u]=92^e[u];this._hash=[r]}n(u,s),u.prototype._update=function(t){this._hash.push(t)},u.prototype._final=function(){var t=this._alg(i.concat(this._hash));return this._alg(i.concat([this._opad,t]))},t.exports=u},3278:function(t,e,r){(function(e){const n=r(3200),i=e.alloc(1,1),s=e.alloc(1,0);t.exports=function(t,r,o,u,a){let p=e.alloc(32,0),c=e.alloc(32,1);p=n("sha256",p).update(c).update(s).update(r).update(t).update(a||"").digest(),c=n("sha256",p).update(c).digest(),p=n("sha256",p).update(c).update(i).update(r).update(t).update(a||"").digest(),c=n("sha256",p).update(c).digest(),c=n("sha256",p).update(c).digest();let h=c;for(;!u(h)||!o(h);)p=n("sha256",p).update(c).update(s).digest(),c=n("sha256",p).update(c).digest(),c=n("sha256",p).update(c).digest(),h=c;return h}}).call(this,r(19).Buffer)},3342:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(3954);e.embed=n.p2data;const i=r(3959);e.p2ms=i.p2ms;const s=r(3960);e.p2pk=s.p2pk;const o=r(3961);e.p2pkh=o.p2pkh;const u=r(3962);e.p2sh=u.p2sh;const a=r(3963);e.p2wpkh=a.p2wpkh;const p=r(3964);e.p2wsh=p.p2wsh},3343:function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});const n=r(3140),i=r(2066),s=r(1144);function o(t,e){if("number"!==typeof t)throw new Error("cannot write a non-number as a number");if(t<0)throw new Error("specified a negative value for writing an unsigned value");if(t>e)throw new Error("RangeError: value out of range");if(Math.floor(t)!==t)throw new Error("value has a fractional component")}function u(t,e){const r=t.readUInt32LE(e);let n=t.readUInt32LE(e+4);return n*=4294967296,o(n+r,9007199254740991),n+r}function a(t,e,r){return o(e,9007199254740991),t.writeInt32LE(-1&e,r),t.writeUInt32LE(Math.floor(e/4294967296),r+4),r+8}e.readUInt64LE=u,e.writeUInt64LE=a,e.reverseBuffer=function(t){if(t.length<1)return t;let e=t.length-1,r=0;for(let n=0;n<t.length/2;n++)r=t[n],t[n]=t[e],t[e]=r,e--;return t},e.cloneBuffer=function(e){const r=t.allocUnsafe(e.length);return e.copy(r),r};e.BufferWriter=class{constructor(t,e=0){this.buffer=t,this.offset=e,i(n.tuple(n.Buffer,n.UInt32),[t,e])}writeUInt8(t){this.offset=this.buffer.writeUInt8(t,this.offset)}writeInt32(t){this.offset=this.buffer.writeInt32LE(t,this.offset)}writeUInt32(t){this.offset=this.buffer.writeUInt32LE(t,this.offset)}writeUInt64(t){this.offset=a(this.buffer,t,this.offset)}writeVarInt(t){s.encode(t,this.buffer,this.offset),this.offset+=s.encode.bytes}writeSlice(t){if(this.buffer.length<this.offset+t.length)throw new Error("Cannot write slice out of bounds");this.offset+=t.copy(this.buffer,this.offset)}writeVarSlice(t){this.writeVarInt(t.length),this.writeSlice(t)}writeVector(t){this.writeVarInt(t.length),t.forEach(t=>this.writeVarSlice(t))}};e.BufferReader=class{constructor(t,e=0){this.buffer=t,this.offset=e,i(n.tuple(n.Buffer,n.UInt32),[t,e])}readUInt8(){const t=this.buffer.readUInt8(this.offset);return this.offset++,t}readInt32(){const t=this.buffer.readInt32LE(this.offset);return this.offset+=4,t}readUInt32(){const t=this.buffer.readUInt32LE(this.offset);return this.offset+=4,t}readUInt64(){const t=u(this.buffer,this.offset);return this.offset+=8,t}readVarInt(){const t=s.decode(this.buffer,this.offset);return this.offset+=s.decode.bytes,t}readSlice(t){if(this.buffer.length<this.offset+t)throw new Error("Cannot read slice out of bounds");const e=this.buffer.slice(this.offset,this.offset+t);return this.offset+=t,e}readVarSlice(){return this.readSlice(this.readVarInt())}readVector(){const t=this.readVarInt(),e=[];for(let r=0;r<t;r++)e.push(this.readVarSlice());return e}}}).call(this,r(19).Buffer)},3344:function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});const n=r(3343),i=r(3160),s=r(3060),o=r(3060),u=r(3140),a=r(2066),p=r(1144);function c(t){const e=t.length;return p.encodingLength(e)+e}const h=t.allocUnsafe(0),f=[],l=t.from("0000000000000000000000000000000000000000000000000000000000000000","hex"),d=t.from("0000000000000000000000000000000000000000000000000000000000000001","hex"),y=t.from("ffffffffffffffff","hex"),w={script:h,valueBuffer:y};class g{constructor(){this.version=1,this.locktime=0,this.ins=[],this.outs=[]}static fromBuffer(t,e){const r=new n.BufferReader(t),i=new g;i.version=r.readInt32();const s=r.readUInt8(),o=r.readUInt8();let u=!1;s===g.ADVANCED_TRANSACTION_MARKER&&o===g.ADVANCED_TRANSACTION_FLAG?u=!0:r.offset-=2;const a=r.readVarInt();for(let n=0;n<a;++n)i.ins.push({hash:r.readSlice(32),index:r.readUInt32(),script:r.readVarSlice(),sequence:r.readUInt32(),witness:f});const p=r.readVarInt();for(let n=0;n<p;++n)i.outs.push({value:r.readUInt64(),script:r.readVarSlice()});if(u){for(let t=0;t<a;++t)i.ins[t].witness=r.readVector();if(!i.hasWitnesses())throw new Error("Transaction has superfluous witness data")}if(i.locktime=r.readUInt32(),e)return i;if(r.offset!==t.length)throw new Error("Transaction has unexpected data");return i}static fromHex(e){return g.fromBuffer(t.from(e,"hex"),!1)}static isCoinbaseHash(t){a(u.Hash256bit,t);for(let e=0;e<32;++e)if(0!==t[e])return!1;return!0}isCoinbase(){return 1===this.ins.length&&g.isCoinbaseHash(this.ins[0].hash)}addInput(t,e,r,n){return a(u.tuple(u.Hash256bit,u.UInt32,u.maybe(u.UInt32),u.maybe(u.Buffer)),arguments),u.Null(r)&&(r=g.DEFAULT_SEQUENCE),this.ins.push({hash:t,index:e,script:n||h,sequence:r,witness:f})-1}addOutput(t,e){return a(u.tuple(u.Buffer,u.Satoshi),arguments),this.outs.push({script:t,value:e})-1}hasWitnesses(){return this.ins.some(t=>0!==t.witness.length)}weight(){return 3*this.byteLength(!1)+this.byteLength(!0)}virtualSize(){return Math.ceil(this.weight()/4)}byteLength(t=!0){const e=t&&this.hasWitnesses();return(e?10:8)+p.encodingLength(this.ins.length)+p.encodingLength(this.outs.length)+this.ins.reduce((t,e)=>t+40+c(e.script),0)+this.outs.reduce((t,e)=>t+8+c(e.script),0)+(e?this.ins.reduce((t,e)=>t+function(t){const e=t.length;return p.encodingLength(e)+t.reduce((t,e)=>t+c(e),0)}(e.witness),0):0)}clone(){const t=new g;return t.version=this.version,t.locktime=this.locktime,t.ins=this.ins.map(t=>({hash:t.hash,index:t.index,script:t.script,sequence:t.sequence,witness:t.witness})),t.outs=this.outs.map(t=>({script:t.script,value:t.value})),t}hashForSignature(e,r,n){if(a(u.tuple(u.UInt32,u.Buffer,u.Number),arguments),e>=this.ins.length)return d;const p=s.compile(s.decompile(r).filter(t=>t!==o.OPS.OP_CODESEPARATOR)),c=this.clone();if((31&n)===g.SIGHASH_NONE)c.outs=[],c.ins.forEach((t,r)=>{r!==e&&(t.sequence=0)});else if((31&n)===g.SIGHASH_SINGLE){if(e>=this.outs.length)return d;c.outs.length=e+1;for(let t=0;t<e;t++)c.outs[t]=w;c.ins.forEach((t,r)=>{r!==e&&(t.sequence=0)})}n&g.SIGHASH_ANYONECANPAY?(c.ins=[c.ins[e]],c.ins[0].script=p):(c.ins.forEach(t=>{t.script=h}),c.ins[e].script=p);const f=t.allocUnsafe(c.byteLength(!1)+4);return f.writeInt32LE(n,f.length-4),c.__toBuffer(f,0,!1),i.hash256(f)}hashForWitnessV0(e,r,s,o){a(u.tuple(u.UInt32,u.Buffer,u.Satoshi,u.UInt32),arguments);let p,h=t.from([]),f=l,d=l,y=l;if(o&g.SIGHASH_ANYONECANPAY||(h=t.allocUnsafe(36*this.ins.length),p=new n.BufferWriter(h,0),this.ins.forEach(t=>{p.writeSlice(t.hash),p.writeUInt32(t.index)}),d=i.hash256(h)),o&g.SIGHASH_ANYONECANPAY||(31&o)===g.SIGHASH_SINGLE||(31&o)===g.SIGHASH_NONE||(h=t.allocUnsafe(4*this.ins.length),p=new n.BufferWriter(h,0),this.ins.forEach(t=>{p.writeUInt32(t.sequence)}),y=i.hash256(h)),(31&o)!==g.SIGHASH_SINGLE&&(31&o)!==g.SIGHASH_NONE){const e=this.outs.reduce((t,e)=>t+8+c(e.script),0);h=t.allocUnsafe(e),p=new n.BufferWriter(h,0),this.outs.forEach(t=>{p.writeUInt64(t.value),p.writeVarSlice(t.script)}),f=i.hash256(h)}else if((31&o)===g.SIGHASH_SINGLE&&e<this.outs.length){const r=this.outs[e];h=t.allocUnsafe(8+c(r.script)),p=new n.BufferWriter(h,0),p.writeUInt64(r.value),p.writeVarSlice(r.script),f=i.hash256(h)}h=t.allocUnsafe(156+c(r)),p=new n.BufferWriter(h,0);const w=this.ins[e];return p.writeUInt32(this.version),p.writeSlice(d),p.writeSlice(y),p.writeSlice(w.hash),p.writeUInt32(w.index),p.writeVarSlice(r),p.writeUInt64(s),p.writeUInt32(w.sequence),p.writeSlice(f),p.writeUInt32(this.locktime),p.writeUInt32(o),i.hash256(h)}hashForCashSignature(t,e,r,n){if(a(u.tuple(u.UInt32,u.Buffer,u.Number,u.maybe(u.UInt53)),arguments),n&g.SIGHASH_BITCOINCASHBIP143){if(u.Null(r))throw new Error("Bitcoin Cash sighash requires value of input to be signed.");return this.hashForWitnessV0(t,e,r,n)}return this.hashForSignature(t,e,n)}hashForGoldSignature(t,e,r,n,i){a(u.tuple(u.UInt32,u.Buffer,u.Number,u.maybe(u.UInt53)),arguments);let s=n;const o=(n&g.SIGHASH_BITCOINCASHBIP143)>0;if(o&&(s|=g.FORKID_BTG<<8),i||o){if(u.Null(r))throw new Error("Bitcoin Cash sighash requires value of input to be signed.");return this.hashForWitnessV0(t,e,r,s)}return this.hashForSignature(t,e,s)}getHash(e){return e&&this.isCoinbase()?t.alloc(32,0):i.hash256(this.__toBuffer(void 0,void 0,e))}getId(){return n.reverseBuffer(this.getHash(!1)).toString("hex")}toBuffer(t,e){return this.__toBuffer(t,e,!0)}toHex(){return this.toBuffer(void 0,void 0).toString("hex")}setInputScript(t,e){a(u.tuple(u.Number,u.Buffer),arguments),this.ins[t].script=e}setWitness(t,e){a(u.tuple(u.Number,[u.Buffer]),arguments),this.ins[t].witness=e}__toBuffer(e,r,i=!1){e||(e=t.allocUnsafe(this.byteLength(i)));const s=new n.BufferWriter(e,r||0);s.writeInt32(this.version);const o=i&&this.hasWitnesses();return o&&(s.writeUInt8(g.ADVANCED_TRANSACTION_MARKER),s.writeUInt8(g.ADVANCED_TRANSACTION_FLAG)),s.writeVarInt(this.ins.length),this.ins.forEach(t=>{s.writeSlice(t.hash),s.writeUInt32(t.index),s.writeVarSlice(t.script),s.writeUInt32(t.sequence)}),s.writeVarInt(this.outs.length),this.outs.forEach(t=>{void 0!==t.value?s.writeUInt64(t.value):s.writeSlice(t.valueBuffer),s.writeVarSlice(t.script)}),o&&this.ins.forEach(t=>{s.writeVector(t.witness)}),s.writeUInt32(this.locktime),void 0!==r?e.slice(r,s.offset):e}}g.DEFAULT_SEQUENCE=4294967295,g.SIGHASH_ALL=1,g.SIGHASH_NONE=2,g.SIGHASH_SINGLE=3,g.SIGHASH_ANYONECANPAY=128,g.SIGHASH_BITCOINCASHBIP143=64,g.ADVANCED_TRANSACTION_MARKER=0,g.ADVANCED_TRANSACTION_FLAG=1,g.FORKID_BTG=79,g.FORKID_BCH=0,e.Transaction=g}).call(this,r(19).Buffer)},3437:function(t,e,r){"use strict";function n(t){var e=new Error;this.name=e.name="ValidationError",this.message=e.message=t,this.stack=e.stack}n.prototype=Object.create(Error.prototype),t.exports={ValidationError:n,validate:function(t,e){if(!t)throw new n(e)}}},3438:function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});const n=r(3951),i=r(3118),s=r(3342),o=r(3060),u=r(3140),a=r(3441),p=r(391),c=r(2066);function h(e){if(n.VALID_PREFIXES.indexOf(e.split(":")[0])>-1){const r=n.decode(e);let s,o;switch(r.prefix){case"bitcoincash":s=i.bitcoin;break;case"bchtest":s=i.testnet;break;case"bchreg":s=i.regtest}switch(r.type){case"P2PKH":o=s.pubKeyHash;break;case"P2SH":o=s.scriptHash}if(r.hash.length<20)throw new TypeError(e+" is too short");if(r.hash.length>20)throw new TypeError(e+" is too long");return{version:o,hash:t.from(r.hash)}}{const t=p.decode(e);if(t.length<21)throw new TypeError(e+" is too short");if(t.length>21)throw new TypeError(e+" is too long");return{version:t.readUInt8(0),hash:t.slice(1)}}}function f(e){const r=a.decode(e),n=a.fromWords(r.words.slice(1));return{version:r.words[0],prefix:r.prefix,data:t.from(n)}}e.fromBase58Check=h,e.fromBech32=f,e.toBase58Check=function(e,r){c(u.tuple(u.Hash160bit,u.UInt8),arguments);const n=t.allocUnsafe(21);return n.writeUInt8(r,0),e.copy(n,1),p.encode(n)},e.toBech32=function(t,e,r){const n=a.toWords(t);return n.unshift(e),a.encode(r,n)},e.fromOutputScript=function(t,e){e=e||i.bitcoin;try{return s.p2pkh({output:t,network:e}).address}catch(r){}try{return s.p2sh({output:t,network:e}).address}catch(r){}try{return s.p2wpkh({output:t,network:e}).address}catch(r){}try{return s.p2wsh({output:t,network:e}).address}catch(r){}throw new Error(o.toASM(t)+" has no matching Address")},e.toOutputScript=function(t,e){let r,n;e=e||i.bitcoin;try{r=h(t)}catch(o){}if(r){if(r.version===e.pubKeyHash)return s.p2pkh({hash:r.hash}).output;if(r.version===e.scriptHash)return s.p2sh({hash:r.hash}).output}else{try{n=f(t)}catch(o){}if(n){if(n.prefix!==e.bech32)throw new Error(t+" has an invalid prefix");if(0===n.version){if(20===n.data.length)return s.p2wpkh({hash:n.data}).output;if(32===n.data.length)return s.p2wsh({hash:n.data}).output}}}throw new Error(t+" has no matching Script")}}).call(this,r(19).Buffer)},3439:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class n extends Error{constructor(t){super(t),this.name="ValidationError",Object.setPrototypeOf(this,n.prototype)}}e.ValidationError=n,e.validate=function(t,e){if(!t)throw new n(e)}},3440:function(t){t.exports=JSON.parse('{"OP_FALSE":0,"OP_0":0,"OP_PUSHDATA1":76,"OP_PUSHDATA2":77,"OP_PUSHDATA4":78,"OP_1NEGATE":79,"OP_RESERVED":80,"OP_TRUE":81,"OP_1":81,"OP_2":82,"OP_3":83,"OP_4":84,"OP_5":85,"OP_6":86,"OP_7":87,"OP_8":88,"OP_9":89,"OP_10":90,"OP_11":91,"OP_12":92,"OP_13":93,"OP_14":94,"OP_15":95,"OP_16":96,"OP_NOP":97,"OP_VER":98,"OP_IF":99,"OP_NOTIF":100,"OP_VERIF":101,"OP_VERNOTIF":102,"OP_ELSE":103,"OP_ENDIF":104,"OP_VERIFY":105,"OP_RETURN":106,"OP_TOALTSTACK":107,"OP_FROMALTSTACK":108,"OP_2DROP":109,"OP_2DUP":110,"OP_3DUP":111,"OP_2OVER":112,"OP_2ROT":113,"OP_2SWAP":114,"OP_IFDUP":115,"OP_DEPTH":116,"OP_DROP":117,"OP_DUP":118,"OP_NIP":119,"OP_OVER":120,"OP_PICK":121,"OP_ROLL":122,"OP_ROT":123,"OP_SWAP":124,"OP_TUCK":125,"OP_CAT":126,"OP_SUBSTR":127,"OP_LEFT":128,"OP_RIGHT":129,"OP_SIZE":130,"OP_INVERT":131,"OP_AND":132,"OP_OR":133,"OP_XOR":134,"OP_EQUAL":135,"OP_EQUALVERIFY":136,"OP_RESERVED1":137,"OP_RESERVED2":138,"OP_1ADD":139,"OP_1SUB":140,"OP_2MUL":141,"OP_2DIV":142,"OP_NEGATE":143,"OP_ABS":144,"OP_NOT":145,"OP_0NOTEQUAL":146,"OP_ADD":147,"OP_SUB":148,"OP_MUL":149,"OP_DIV":150,"OP_MOD":151,"OP_LSHIFT":152,"OP_RSHIFT":153,"OP_BOOLAND":154,"OP_BOOLOR":155,"OP_NUMEQUAL":156,"OP_NUMEQUALVERIFY":157,"OP_NUMNOTEQUAL":158,"OP_LESSTHAN":159,"OP_GREATERTHAN":160,"OP_LESSTHANOREQUAL":161,"OP_GREATERTHANOREQUAL":162,"OP_MIN":163,"OP_MAX":164,"OP_WITHIN":165,"OP_RIPEMD160":166,"OP_SHA1":167,"OP_SHA256":168,"OP_HASH160":169,"OP_HASH256":170,"OP_CODESEPARATOR":171,"OP_CHECKSIG":172,"OP_CHECKSIGVERIFY":173,"OP_CHECKMULTISIG":174,"OP_CHECKMULTISIGVERIFY":175,"OP_NOP1":176,"OP_NOP2":177,"OP_CHECKLOCKTIMEVERIFY":177,"OP_NOP3":178,"OP_CHECKSEQUENCEVERIFY":178,"OP_NOP4":179,"OP_NOP5":180,"OP_NOP6":181,"OP_NOP7":182,"OP_NOP8":183,"OP_NOP9":184,"OP_NOP10":185,"OP_PUBKEYHASH":253,"OP_PUBKEY":254,"OP_INVALIDOPCODE":255}')},3441:function(t,e,r){"use strict";for(var n="qpzry9x8gf2tvdw0s3jn54khce6mua7l",i={},s=0;s<n.length;s++){var o=n.charAt(s);if(void 0!==i[o])throw new TypeError(o+" is ambiguous");i[o]=s}function u(t){var e=t>>25;return(33554431&t)<<5^996825010&-(e>>0&1)^642813549&-(e>>1&1)^513874426&-(e>>2&1)^1027748829&-(e>>3&1)^705979059&-(e>>4&1)}function a(t){for(var e=1,r=0;r<t.length;++r){var n=t.charCodeAt(r);if(n<33||n>126)return"Invalid prefix ("+t+")";e=u(e)^n>>5}for(e=u(e),r=0;r<t.length;++r){var i=t.charCodeAt(r);e=u(e)^31&i}return e}function p(t,e){if(e=e||90,t.length<8)return t+" too short";if(t.length>e)return"Exceeds length limit";var r=t.toLowerCase(),n=t.toUpperCase();if(t!==r&&t!==n)return"Mixed-case string "+t;var s=(t=r).lastIndexOf("1");if(-1===s)return"No separator character for "+t;if(0===s)return"Missing prefix for "+t;var o=t.slice(0,s),p=t.slice(s+1);if(p.length<6)return"Data too short";var c=a(o);if("string"===typeof c)return c;for(var h=[],f=0;f<p.length;++f){var l=p.charAt(f),d=i[l];if(void 0===d)return"Unknown character "+l;c=u(c)^d,f+6>=p.length||h.push(d)}return 1!==c?"Invalid checksum for "+t:{prefix:o,words:h}}function c(t,e,r,n){for(var i=0,s=0,o=(1<<r)-1,u=[],a=0;a<t.length;++a)for(i=i<<e|t[a],s+=e;s>=r;)s-=r,u.push(i>>s&o);if(n)s>0&&u.push(i<<r-s&o);else{if(s>=e)return"Excess padding";if(i<<r-s&o)return"Non-zero padding"}return u}t.exports={decodeUnsafe:function(){var t=p.apply(null,arguments);if("object"===typeof t)return t},decode:function(t){var e=p.apply(null,arguments);if("object"===typeof e)return e;throw new Error(e)},encode:function(t,e,r){if(r=r||90,t.length+7+e.length>r)throw new TypeError("Exceeds length limit");var i=a(t=t.toLowerCase());if("string"===typeof i)throw new Error(i);for(var s=t+"1",o=0;o<e.length;++o){var p=e[o];if(p>>5!==0)throw new Error("Non 5-bit word");i=u(i)^p,s+=n.charAt(p)}for(o=0;o<6;++o)i=u(i);for(i^=1,o=0;o<6;++o){s+=n.charAt(i>>5*(5-o)&31)}return s},toWordsUnsafe:function(t){var e=c(t,8,5,!0);if(Array.isArray(e))return e},toWords:function(t){var e=c(t,8,5,!0);if(Array.isArray(e))return e;throw new Error(e)},fromWordsUnsafe:function(t){var e=c(t,5,8,!1);if(Array.isArray(e))return e},fromWords:function(t){var e=c(t,5,8,!1);if(Array.isArray(e))return e;throw new Error(e)}}},3442:function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});const n=r(3118),i=r(3140),s=r(3117),o=r(1167),u=r(2066),a=r(3232),p=u.maybe(u.compile({compressed:i.maybe(i.Boolean),network:i.maybe(i.Network)}));class c{constructor(t,e,r){this.__D=t,this.__Q=e,this.lowR=!1,void 0===r&&(r={}),this.compressed=void 0===r.compressed||r.compressed,this.network=r.network||n.bitcoin,void 0!==e&&(this.__Q=s.pointCompress(e,this.compressed))}get privateKey(){return this.__D}get publicKey(){return this.__Q||(this.__Q=s.pointFromScalar(this.__D,this.compressed)),this.__Q}toWIF(){if(!this.__D)throw new Error("Missing private key");return a.encode(this.network.wif,this.__D,this.compressed)}sign(e,r){if(!this.__D)throw new Error("Missing private key");if(void 0===r&&(r=this.lowR),!1===r)return s.sign(e,this.__D);{let r=s.sign(e,this.__D);const n=t.alloc(32,0);let i=0;for(;r[0]>127;)i++,n.writeUIntLE(i,0,6),r=s.signWithEntropy(e,this.__D,n);return r}}verify(t,e){return s.verify(t,this.publicKey,e)}}function h(t,e){if(u(i.Buffer256bit,t),!s.isPrivate(t))throw new TypeError("Private key not in range [1, n)");return u(p,e),new c(t,void 0,e)}e.fromPrivateKey=h,e.fromPublicKey=function(t,e){return u(s.isPoint,t),u(p,e),new c(void 0,t,e)},e.fromWIF=function(t,e){const r=a.decode(t),s=r.version;if(i.Array(e)){if(!(e=e.filter(t=>s===t.wif).pop()))throw new Error("Unknown network version")}else if(e=e||n.bitcoin,s!==e.wif)throw new Error("Invalid network version");return h(r.privateKey,{compressed:r.compressed,network:e})},e.makeRandom=function(t){u(p,t),void 0===t&&(t={});const e=t.rng||o;let r;do{r=e(32),u(i.Buffer256bit,r)}while(!s.isPrivate(r));return h(r,t)}}).call(this,r(19).Buffer)},3443:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(3970);e.input=n;const i=r(3971);e.output=i},3444:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(3973);e.input=n;const i=r(3974);e.output=i},3445:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(3975);e.input=n;const i=r(3976);e.output=i},3609:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(3060),i=r(3060);function s(t){const e=n.compile(t);return 22===e.length&&e[0]===i.OPS.OP_0&&20===e[1]}e.check=s,s.toJSON=()=>"Witness pubKeyHash output"},3610:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(3060),i=r(3060);function s(t){const e=n.compile(t);return 34===e.length&&e[0]===i.OPS.OP_0&&32===e[1]}e.check=s,s.toJSON=()=>"Witness scriptHash output"},3946:function(t,e,r){var n=r(391),i=r(3947),s=r(19).Buffer,o={Legacy:"legacy",Bitpay:"bitpay",Cashaddr:"cashaddr"},u={Mainnet:"mainnet",Testnet:"testnet"},a={};function p(t){return l(t).format}function c(t){return l(t).network}function h(t){return l(t).type}a.P2PKH="p2pkh",a.P2SH="p2sh";var f={};function l(t){try{return function(t){try{var e=n.decode(t);if(21!==e.length)throw new y;var r=e[0],i=Array.prototype.slice.call(e,1);switch(r){case f[o.Legacy][u.Mainnet][a.P2PKH]:return{hash:i,format:o.Legacy,network:u.Mainnet,type:a.P2PKH};case f[o.Legacy][u.Mainnet][a.P2SH]:return{hash:i,format:o.Legacy,network:u.Mainnet,type:a.P2SH};case f[o.Legacy][u.Testnet][a.P2PKH]:return{hash:i,format:o.Legacy,network:u.Testnet,type:a.P2PKH};case f[o.Legacy][u.Testnet][a.P2SH]:return{hash:i,format:o.Legacy,network:u.Testnet,type:a.P2SH};case f[o.Bitpay][u.Mainnet][a.P2PKH]:return{hash:i,format:o.Bitpay,network:u.Mainnet,type:a.P2PKH};case f[o.Bitpay][u.Mainnet][a.P2SH]:return{hash:i,format:o.Bitpay,network:u.Mainnet,type:a.P2SH}}}catch(s){}throw new y}(t)}catch(e){}try{return function(t){if(-1!==t.indexOf(":"))try{return d(t)}catch(e){}else for(var r=["bitcoincash","bchtest","bchreg"],n=0;n<r.length;++n)try{return d(r[n]+":"+t)}catch(e){}throw new y}(t)}catch(e){}throw new y}f[o.Legacy]={},f[o.Legacy][u.Mainnet]={},f[o.Legacy][u.Mainnet][a.P2PKH]=0,f[o.Legacy][u.Mainnet][a.P2SH]=5,f[o.Legacy][u.Testnet]={},f[o.Legacy][u.Testnet][a.P2PKH]=111,f[o.Legacy][u.Testnet][a.P2SH]=196,f[o.Bitpay]={},f[o.Bitpay][u.Mainnet]={},f[o.Bitpay][u.Mainnet][a.P2PKH]=28,f[o.Bitpay][u.Mainnet][a.P2SH]=40,f[o.Bitpay][u.Testnet]={},f[o.Bitpay][u.Testnet][a.P2PKH]=111,f[o.Bitpay][u.Testnet][a.P2SH]=196;function d(t){try{var e=i.decode(t),r=Array.prototype.slice.call(e.hash,0),n="P2PKH"===e.type?a.P2PKH:a.P2SH;switch(e.prefix){case"bitcoincash":return{hash:r,format:o.Cashaddr,network:u.Mainnet,type:n};case"bchtest":case"bchreg":return{hash:r,format:o.Cashaddr,network:u.Testnet,type:n}}}catch(s){}throw new y}function y(){var t=new Error;this.name=t.name="InvalidAddressError",this.message=t.message="Received an invalid Bitcoin Cash address as input.",this.stack=t.stack}y.prototype=Object.create(Error.prototype),t.exports={Format:o,Network:u,Type:a,isValidAddress:function(t){try{return l(t),!0}catch(e){return!1}},detectAddressFormat:p,detectAddressNetwork:c,detectAddressType:h,toLegacyAddress:function(t){var e=l(t);return e.format===o.Legacy?t:function(t){var e=f[o.Legacy][t.network][t.type],r=s.alloc(1+t.hash.length);return r[0]=e,r.set(t.hash,1),n.encode(r)}(e)},toBitpayAddress:function(t){var e=l(t);return e.format===o.Bitpay?t:function(t){var e=f[o.Bitpay][t.network][t.type],r=s.alloc(1+t.hash.length);return r[0]=e,r.set(t.hash,1),n.encode(r)}(e)},toCashAddress:function(t){return function(t){var e=t.network===u.Mainnet?"bitcoincash":"bchtest",r=t.type===a.P2PKH?"P2PKH":"P2SH",n=new Uint8Array(t.hash);return i.encode(e,r,n)}(l(t))},isLegacyAddress:function(t){return p(t)===o.Legacy},isBitpayAddress:function(t){return p(t)===o.Bitpay},isCashAddress:function(t){return p(t)===o.Cashaddr},isMainnetAddress:function(t){return c(t)===u.Mainnet},isTestnetAddress:function(t){return c(t)===u.Testnet},isP2PKHAddress:function(t){return h(t)===a.P2PKH},isP2SHAddress:function(t){return h(t)===a.P2SH},InvalidAddressError:y}},3947:function(t,e,r){"use strict";var n=r(3948),i=r(3159),s=r(3949),o=r(3437),u=o.validate;var a=o.ValidationError,p=["bitcoincash","bchtest","bchreg"];function c(t){for(var e=new Uint8Array(t.length),r=0;r<t.length;++r)e[r]=31&t[r].charCodeAt(0);return e}function h(t,e){var r=new Uint8Array(t.length+e.length);return r.set(t),r.set(e,t.length),r}function f(t){for(var e=[656907472481,522768456162,0xf33e5fb3c4,748107326120,130178868336],r=i(1),n=0;n<t.length;++n){var s=t[n],o=r.shiftRight(35);r=r.and(34359738367).shiftLeft(5).xor(s);for(var u=0;u<e.length;++u)o.shiftRight(u).and(1).equals(1)&&(r=r.xor(e[u]))}return r.xor(1)}function l(t){return t===t.toLowerCase()||t===t.toUpperCase()}t.exports={encode:function(t,e,r){u("string"===typeof t&&function(t){return l(t)&&-1!==p.indexOf(t.toLowerCase())}(t),"Invalid prefix: "+t+"."),u("string"===typeof e,"Invalid type: "+e+"."),u(r instanceof Uint8Array,"Invalid hash: "+r+".");var i,o=h(c(t),new Uint8Array(1)),d=function(t){switch(t){case"P2PKH":return 0;case"P2SH":return 8;default:throw new a("Invalid type: "+t+".")}}(e)+function(t){switch(8*t.length){case 160:return 0;case 192:return 1;case 224:return 2;case 256:return 3;case 320:return 4;case 384:return 5;case 448:return 6;case 512:return 7;default:throw new a("Invalid hash size: "+t.length+".")}}(r),y=(i=h(new Uint8Array([d]),r),s(i,8,5)),w=h(h(o,y),new Uint8Array(8)),g=h(y,function(t){for(var e=new Uint8Array(8),r=0;r<8;++r)e[7-r]=t.and(31).toJSNumber(),t=t.shiftRight(5);return e}(f(w)));return t+":"+n.encode(g)},decode:function(t){u("string"===typeof t&&l(t),"Invalid address: "+t+".");var e=t.toLowerCase().split(":");u(2===e.length,"Missing prefix: "+t+".");var r=e[0],i=n.decode(e[1]);u(function(t,e){var r=h(c(t),new Uint8Array(1));return f(h(r,e)).equals(0)}(r,i),"Invalid checksum: "+t+".");var o,p=(o=i.subarray(0,-8),s(o,5,8,!0)),d=p[0],y=p.subarray(1);return u(function(t){switch(7&t){case 0:return 160;case 1:return 192;case 2:return 224;case 3:return 256;case 4:return 320;case 5:return 384;case 6:return 448;case 7:return 512}}(d)===8*y.length,"Invalid hash size: "+t+"."),{prefix:r,type:function(t){switch(120&t){case 0:return"P2PKH";case 8:return"P2SH";default:throw new a("Invalid address type in version byte: "+t+".")}}(d),hash:y}},ValidationError:a}},3948:function(t,e,r){"use strict";var n=r(3437).validate,i={q:0,p:1,z:2,r:3,y:4,9:5,x:6,8:7,g:8,f:9,2:10,t:11,v:12,d:13,w:14,0:15,s:16,3:17,j:18,n:19,5:20,4:21,k:22,h:23,c:24,e:25,6:26,m:27,u:28,a:29,7:30,l:31};t.exports={encode:function(t){n(t instanceof Uint8Array,"Invalid data: "+t+".");for(var e="",r=0;r<t.length;++r){var i=t[r];n(0<=i&&i<32,"Invalid value: "+i+"."),e+="qpzry9x8gf2tvdw0s3jn54khce6mua7l"[i]}return e},decode:function(t){n("string"===typeof t,"Invalid base32-encoded string: "+t+".");for(var e=new Uint8Array(t.length),r=0;r<t.length;++r){var s=t[r];n(s in i,"Invalid value: "+s+"."),e[r]=i[s]}return e}}},3949:function(t,e,r){"use strict";var n=r(3437).validate;t.exports=function(t,e,r,i){for(var s=i?Math.floor(t.length*e/r):Math.ceil(t.length*e/r),o=(1<<r)-1,u=new Uint8Array(s),a=0,p=0,c=0,h=0;h<t.length;++h){var f=t[h];for(n(0<=f&&f>>e===0,"Invalid value: "+f+"."),p=p<<e|f,c+=e;c>=r;)c-=r,u[a]=p>>c&o,++a}return i?n(c<e&&0===(p<<r-c&o),"Input cannot be converted to "+r+" bits without padding, but strict mode was used."):c>0&&(u[a]=p<<r-c&o,++a),u}},3950:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(3274);e.bip32=n;const i=r(3438);e.address=i;const s=r(3160);e.crypto=s;const o=r(3442);e.ECPair=o;const u=r(3118);e.networks=u;const a=r(3342);e.payments=a;const p=r(3060);e.script=p;var c=r(3965);e.Block=c.Block;var h=r(3967);e.Psbt=h.Psbt;var f=r(3060);e.opcodes=f.OPS;var l=r(3344);e.Transaction=l.Transaction;var d=r(3968);e.TransactionBuilder=d.TransactionBuilder},3951:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(3159),i=r(3952),s=r(3953),o=r(3439),u=o.validate;function a(t){const e=new Uint8Array(t.length);for(let r=0;r<t.length;++r)e[r]=31&t[r].charCodeAt(0);return e}function p(t,e){const r=new Uint8Array(t.length+e.length);return r.set(t),r.set(e,t.length),r}function c(t){const e=[656907472481,522768456162,0xf33e5fb3c4,748107326120,130178868336];let r=n(1);for(const n of t){const t=r.shiftRight(35);r=r.and(34359738367).shiftLeft(5).xor(n);for(let n=0;n<e.length;++n)t.shiftRight(n).and(1).equals(1)&&(r=r.xor(e[n]))}return r.xor(1)}function h(t){return t===t.toLowerCase()||t===t.toUpperCase()}e.encode=function(t,r,n){u("string"===typeof t&&function(t){return h(t)&&-1!==e.VALID_PREFIXES.indexOf(t.toLowerCase())}(t),"Invalid prefix: "+t+"."),u("string"===typeof r,"Invalid type: "+r+"."),u(n instanceof Uint8Array,"Invalid hash: "+n+".");const o=p(a(t),new Uint8Array(1)),f=function(t){switch(t){case"P2PKH":return 0;case"P2SH":return 8;default:throw new e.ValidationError("Invalid type: "+t+".")}}(r)+function(t){switch(8*t.length){case 160:return 0;case 192:return 1;case 224:return 2;case 256:return 3;case 320:return 4;case 384:return 5;case 448:return 6;case 512:return 7;default:throw new e.ValidationError("Invalid hash size: "+t.length+".")}}(n),l=(d=p(new Uint8Array([f]),n),s.convertBits(d,8,5));var d;const y=p(p(o,l),new Uint8Array(8)),w=p(l,function(t){const e=new Uint8Array(8);for(let r=0;r<8;++r)e[7-r]=t.and(31).toJSNumber(),t=t.shiftRight(5);return e}(c(y)));return t+":"+i.encode(w)},e.decode=function(t){u("string"===typeof t&&h(t),"Invalid address: "+t+".");const r=t.toLowerCase().split(":");u(2===r.length,"Missing prefix: "+t+".");const n=r[0],o=i.decode(r[1]);u(function(t,e){const r=p(a(t),new Uint8Array(1));return c(p(r,e)).equals(0)}(n,o),"Invalid checksum: "+t+".");const f=(l=o.subarray(0,-8),s.convertBits(l,5,8,!0));var l;const d=f[0],y=f.subarray(1);return u(function(t){switch(7&t){case 0:return 160;case 1:return 192;case 2:return 224;case 3:return 256;case 4:return 320;case 5:return 384;case 6:return 448;case 7:return 512;default:throw new e.ValidationError("Invalid versionByte: "+(7&t)+".")}}(d)===8*y.length,"Invalid hash size: "+t+"."),{prefix:n,type:function(t){switch(120&t){case 0:return"P2PKH";case 8:return"P2SH";default:throw new e.ValidationError("Invalid address type in version byte: "+t+".")}}(d),hash:y}},e.ValidationError=o.ValidationError,e.VALID_PREFIXES=["bitcoincash","bchtest","bchreg"]},3952:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(3439),i={q:0,p:1,z:2,r:3,y:4,9:5,x:6,8:7,g:8,f:9,2:10,t:11,v:12,d:13,w:14,0:15,s:16,3:17,j:18,n:19,5:20,4:21,k:22,h:23,c:24,e:25,6:26,m:27,u:28,a:29,7:30,l:31};e.encode=function(t){n.validate(t instanceof Uint8Array,"Invalid data: "+t+".");let e="";for(const r of t)n.validate(0<=r&&r<32,"Invalid value: "+r+"."),e+="qpzry9x8gf2tvdw0s3jn54khce6mua7l"[r];return e},e.decode=function(t){n.validate("string"===typeof t,"Invalid base32-encoded string: "+t+".");const e=new Uint8Array(t.length);for(let r=0;r<t.length;++r){const s=t[r];n.validate(s in i,"Invalid value: "+s+"."),e[r]=i[s]}return e}},3953:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(3439);e.convertBits=function(t,e,r,i){const s=i?Math.floor(t.length*e/r):Math.ceil(t.length*e/r),o=(1<<r)-1,u=new Uint8Array(s);let a=0,p=0,c=0;for(const h of t)for(n.validate(0<=h&&h>>e===0,"Invalid value: "+h+"."),p=p<<e|h,c+=e;c>=r;)c-=r,u[a]=p>>c&o,++a;return i?n.validate(c<e&&0===(p<<r-c&o),"Input cannot be converted to "+r+" bits without padding, but strict mode was used."):c>0&&(u[a]=p<<r-c&o,++a),u}},3954:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(3118),i=r(3060),s=r(3216),o=r(2066),u=i.OPS;e.p2data=function(t,e){if(!t.data&&!t.output)throw new TypeError("Not enough data");e=Object.assign({validate:!0},e||{}),o({network:o.maybe(o.Object),output:o.maybe(o.Buffer),data:o.maybe(o.arrayOf(o.Buffer))},t);const r={name:"embed",network:t.network||n.bitcoin};if(s.prop(r,"output",()=>{if(t.data)return i.compile([u.OP_RETURN].concat(t.data))}),s.prop(r,"data",()=>{if(t.output)return i.decompile(t.output).slice(1)}),e.validate&&t.output){const e=i.decompile(t.output);if(e[0]!==u.OP_RETURN)throw new TypeError("Output is invalid");if(!e.slice(1).every(o.Buffer))throw new TypeError("Output is invalid");if(t.data&&!function(t,e){return t.length===e.length&&t.every((t,r)=>t.equals(e[r]))}(t.data,r.data))throw new TypeError("Data mismatch")}return Object.assign(r,t)}},3955:function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.decode=function(t,e,r){e=e||4,r=void 0===r||r;const n=t.length;if(0===n)return 0;if(n>e)throw new TypeError("Script number overflow");if(r&&0===(127&t[n-1])&&(n<=1||0===(128&t[n-2])))throw new Error("Non-minimally encoded script number");if(5===n){const e=t.readUInt32LE(0),r=t.readUInt8(4);return 128&r?-(4294967296*(-129&r)+e):4294967296*r+e}let i=0;for(let s=0;s<n;++s)i|=t[s]<<8*s;return 128&t[n-1]?-(i&~(128<<8*(n-1))):i},e.encode=function(e){let r=Math.abs(e);const n=(i=r)>2147483647?5:i>8388607?4:i>32767?3:i>127?2:i>0?1:0;var i;const s=t.allocUnsafe(n),o=e<0;for(let t=0;t<n;++t)s.writeUInt8(255&r,t),r>>=8;return 128&s[n-1]?s.writeUInt8(o?128:0,n-1):o&&(s[n-1]|=128),s}}).call(this,r(19).Buffer)},3956:function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});const n=r(3140),i=r(2073),s=r(2066),o=t.alloc(1,0);function u(e){let r=0;for(;0===e[r];)++r;return r===e.length?o:128&(e=e.slice(r))[0]?t.concat([o,e],1+e.length):e}function a(e){0===e[0]&&(e=e.slice(1));const r=t.alloc(32,0),n=Math.max(0,32-e.length);return e.copy(r,n),r}e.decode=function(e){const r=e.readUInt8(e.length-1),n=-193&r;if(n<=0||n>=4)throw new Error("Invalid hashType "+r);const s=i.decode(e.slice(0,-1)),o=a(s.r),u=a(s.s);return{signature:t.concat([o,u],64),hashType:r}},e.encode=function(e,r){s({signature:n.BufferN(64),hashType:n.UInt8},{signature:e,hashType:r});const o=-193&r;if(o<=0||o>=4)throw new Error("Invalid hashType "+r);const a=t.allocUnsafe(1);a.writeUInt8(r,0);const p=u(e.slice(0,32)),c=u(e.slice(32,64));return t.concat([i.encode(p,c),a])}}).call(this,r(19).Buffer)},3957:function(t,e,r){var n=r(3440);function i(t){return t<n.OP_PUSHDATA1?1:t<=255?2:t<=65535?3:5}t.exports={encodingLength:i,encode:function(t,e,r){var s=i(e);return 1===s?t.writeUInt8(e,r):2===s?(t.writeUInt8(n.OP_PUSHDATA1,r),t.writeUInt8(e,r+1)):3===s?(t.writeUInt8(n.OP_PUSHDATA2,r),t.writeUInt16LE(e,r+1)):(t.writeUInt8(n.OP_PUSHDATA4,r),t.writeUInt32LE(e,r+1)),s},decode:function(t,e){var r,i,s=t.readUInt8(e);if(s<n.OP_PUSHDATA1)r=s,i=1;else if(s===n.OP_PUSHDATA1){if(e+2>t.length)return null;r=t.readUInt8(e+1),i=2}else if(s===n.OP_PUSHDATA2){if(e+3>t.length)return null;r=t.readUInt16LE(e+1),i=3}else{if(e+5>t.length)return null;if(s!==n.OP_PUSHDATA4)throw new Error("Unexpected opcode");r=t.readUInt32LE(e+1),i=5}return{opcode:s,number:r,size:i}}}},3958:function(t,e,r){var n=r(3440),i={};for(var s in n){i[n[s]]=s}t.exports=i},3959:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(3118),i=r(3060),s=r(3216),o=i.OPS,u=r(2066),a=r(3117),p=o.OP_RESERVED;function c(t,e){return t.length===e.length&&t.every((t,r)=>t.equals(e[r]))}e.p2ms=function(t,e){if(!t.input&&!t.output&&(!t.pubkeys||void 0===t.m)&&!t.signatures)throw new TypeError("Not enough data");function r(t){return i.isCanonicalScriptSignature(t)||void 0!==(e.allowIncomplete&&t===o.OP_0)}e=Object.assign({validate:!0},e||{}),u({network:u.maybe(u.Object),m:u.maybe(u.Number),n:u.maybe(u.Number),output:u.maybe(u.Buffer),pubkeys:u.maybe(u.arrayOf(a.isPoint)),signatures:u.maybe(u.arrayOf(r)),input:u.maybe(u.Buffer)},t);const h={network:t.network||n.bitcoin};let f=[],l=!1;function d(t){l||(l=!0,f=i.decompile(t),h.m=f[0]-p,h.n=f[f.length-2]-p,h.pubkeys=f.slice(1,-2))}if(s.prop(h,"output",()=>{if(t.m&&h.n&&t.pubkeys)return i.compile([].concat(p+t.m,t.pubkeys,p+h.n,o.OP_CHECKMULTISIG))}),s.prop(h,"m",()=>{if(h.output)return d(h.output),h.m}),s.prop(h,"n",()=>{if(h.pubkeys)return h.pubkeys.length}),s.prop(h,"pubkeys",()=>{if(t.output)return d(t.output),h.pubkeys}),s.prop(h,"signatures",()=>{if(t.input)return i.decompile(t.input).slice(1)}),s.prop(h,"input",()=>{if(t.signatures)return i.compile([o.OP_0].concat(t.signatures))}),s.prop(h,"witness",()=>{if(h.input)return[]}),s.prop(h,"name",()=>{if(h.m&&h.n)return`p2ms(${h.m} of ${h.n})`}),e.validate){if(t.output){if(d(t.output),!u.Number(f[0]))throw new TypeError("Output is invalid");if(!u.Number(f[f.length-2]))throw new TypeError("Output is invalid");if(f[f.length-1]!==o.OP_CHECKMULTISIG)throw new TypeError("Output is invalid");if(h.m<=0||h.n>16||h.m>h.n||h.n!==f.length-3)throw new TypeError("Output is invalid");if(!h.pubkeys.every(t=>a.isPoint(t)))throw new TypeError("Output is invalid");if(void 0!==t.m&&t.m!==h.m)throw new TypeError("m mismatch");if(void 0!==t.n&&t.n!==h.n)throw new TypeError("n mismatch");if(t.pubkeys&&!c(t.pubkeys,h.pubkeys))throw new TypeError("Pubkeys mismatch")}if(t.pubkeys){if(void 0!==t.n&&t.n!==t.pubkeys.length)throw new TypeError("Pubkey count mismatch");if(h.n=t.pubkeys.length,h.n<h.m)throw new TypeError("Pubkey count cannot be less than m")}if(t.signatures){if(t.signatures.length<h.m)throw new TypeError("Not enough signatures provided");if(t.signatures.length>h.m)throw new TypeError("Too many signatures provided")}if(t.input){if(t.input[0]!==o.OP_0)throw new TypeError("Input is invalid");if(0===h.signatures.length||!h.signatures.every(r))throw new TypeError("Input has invalid signature(s)");if(t.signatures&&!c(t.signatures,h.signatures))throw new TypeError("Signature mismatch");if(void 0!==t.m&&t.m!==t.signatures.length)throw new TypeError("Signature count mismatch")}}return Object.assign(h,t)}},3960:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(3118),i=r(3060),s=r(3216),o=r(2066),u=i.OPS,a=r(3117);e.p2pk=function(t,e){if(!t.input&&!t.output&&!t.pubkey&&!t.input&&!t.signature)throw new TypeError("Not enough data");e=Object.assign({validate:!0},e||{}),o({network:o.maybe(o.Object),output:o.maybe(o.Buffer),pubkey:o.maybe(a.isPoint),signature:o.maybe(i.isCanonicalScriptSignature),input:o.maybe(o.Buffer)},t);const r=s.value(()=>i.decompile(t.input)),p={name:"p2pk",network:t.network||n.bitcoin};if(s.prop(p,"output",()=>{if(t.pubkey)return i.compile([t.pubkey,u.OP_CHECKSIG])}),s.prop(p,"pubkey",()=>{if(t.output)return t.output.slice(1,-1)}),s.prop(p,"signature",()=>{if(t.input)return r()[0]}),s.prop(p,"input",()=>{if(t.signature)return i.compile([t.signature])}),s.prop(p,"witness",()=>{if(p.input)return[]}),e.validate){if(t.output){if(t.output[t.output.length-1]!==u.OP_CHECKSIG)throw new TypeError("Output is invalid");if(!a.isPoint(p.pubkey))throw new TypeError("Output pubkey is invalid");if(t.pubkey&&!t.pubkey.equals(p.pubkey))throw new TypeError("Pubkey mismatch")}if(t.signature&&t.input&&!t.input.equals(p.input))throw new TypeError("Signature mismatch");if(t.input){if(1!==r().length)throw new TypeError("Input is invalid");if(!i.isCanonicalScriptSignature(p.signature))throw new TypeError("Input has invalid signature")}}return Object.assign(p,t)}},3961:function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});const n=r(3160),i=r(3118),s=r(3060),o=r(3216),u=r(2066),a=s.OPS,p=r(3117),c=r(391);e.p2pkh=function(e,r){if(!e.address&&!e.hash&&!e.output&&!e.pubkey&&!e.input)throw new TypeError("Not enough data");r=Object.assign({validate:!0},r||{}),u({network:u.maybe(u.Object),address:u.maybe(u.String),hash:u.maybe(u.BufferN(20)),output:u.maybe(u.BufferN(25)),pubkey:u.maybe(p.isPoint),signature:u.maybe(s.isCanonicalScriptSignature),input:u.maybe(u.Buffer)},e);const h=o.value(()=>{const t=c.decode(e.address);return{version:t.readUInt8(0),hash:t.slice(1)}}),f=o.value(()=>s.decompile(e.input)),l=e.network||i.bitcoin,d={name:"p2pkh",network:l};if(o.prop(d,"address",()=>{if(!d.hash)return;const e=t.allocUnsafe(21);return e.writeUInt8(l.pubKeyHash,0),d.hash.copy(e,1),c.encode(e)}),o.prop(d,"hash",()=>e.output?e.output.slice(3,23):e.address?h().hash:e.pubkey||d.pubkey?n.hash160(e.pubkey||d.pubkey):void 0),o.prop(d,"output",()=>{if(d.hash)return s.compile([a.OP_DUP,a.OP_HASH160,d.hash,a.OP_EQUALVERIFY,a.OP_CHECKSIG])}),o.prop(d,"pubkey",()=>{if(e.input)return f()[1]}),o.prop(d,"signature",()=>{if(e.input)return f()[0]}),o.prop(d,"input",()=>{if(e.pubkey&&e.signature)return s.compile([e.signature,e.pubkey])}),o.prop(d,"witness",()=>{if(d.input)return[]}),r.validate){let r=t.from([]);if(e.address){if(h().version!==l.pubKeyHash)throw new TypeError("Invalid version or Network mismatch");if(20!==h().hash.length)throw new TypeError("Invalid address");r=h().hash}if(e.hash){if(r.length>0&&!r.equals(e.hash))throw new TypeError("Hash mismatch");r=e.hash}if(e.output){if(25!==e.output.length||e.output[0]!==a.OP_DUP||e.output[1]!==a.OP_HASH160||20!==e.output[2]||e.output[23]!==a.OP_EQUALVERIFY||e.output[24]!==a.OP_CHECKSIG)throw new TypeError("Output is invalid");const t=e.output.slice(3,23);if(r.length>0&&!r.equals(t))throw new TypeError("Hash mismatch");r=t}if(e.pubkey){const t=n.hash160(e.pubkey);if(r.length>0&&!r.equals(t))throw new TypeError("Hash mismatch");r=t}if(e.input){const t=f();if(2!==t.length)throw new TypeError("Input is invalid");if(!s.isCanonicalScriptSignature(t[0]))throw new TypeError("Input has invalid signature");if(!p.isPoint(t[1]))throw new TypeError("Input has invalid pubkey");if(e.signature&&!e.signature.equals(t[0]))throw new TypeError("Signature mismatch");if(e.pubkey&&!e.pubkey.equals(t[1]))throw new TypeError("Pubkey mismatch");const i=n.hash160(t[1]);if(r.length>0&&!r.equals(i))throw new TypeError("Hash mismatch")}}return Object.assign(d,e)}}).call(this,r(19).Buffer)},3962:function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});const n=r(3160),i=r(3118),s=r(3060),o=r(3216),u=r(2066),a=s.OPS,p=r(391);e.p2sh=function(e,r){if(!e.address&&!e.hash&&!e.output&&!e.redeem&&!e.input)throw new TypeError("Not enough data");r=Object.assign({validate:!0},r||{}),u({network:u.maybe(u.Object),address:u.maybe(u.String),hash:u.maybe(u.BufferN(20)),output:u.maybe(u.BufferN(23)),redeem:u.maybe({network:u.maybe(u.Object),output:u.maybe(u.Buffer),input:u.maybe(u.Buffer),witness:u.maybe(u.arrayOf(u.Buffer))}),input:u.maybe(u.Buffer),witness:u.maybe(u.arrayOf(u.Buffer))},e);let c=e.network;c||(c=e.redeem&&e.redeem.network||i.bitcoin);const h={network:c},f=o.value(()=>{const t=p.decode(e.address);return{version:t.readUInt8(0),hash:t.slice(1)}}),l=o.value(()=>s.decompile(e.input)),d=o.value(()=>{const t=l();return{network:c,output:t[t.length-1],input:s.compile(t.slice(0,-1)),witness:e.witness||[]}});if(o.prop(h,"address",()=>{if(!h.hash)return;const e=t.allocUnsafe(21);return e.writeUInt8(h.network.scriptHash,0),h.hash.copy(e,1),p.encode(e)}),o.prop(h,"hash",()=>e.output?e.output.slice(2,22):e.address?f().hash:h.redeem&&h.redeem.output?n.hash160(h.redeem.output):void 0),o.prop(h,"output",()=>{if(h.hash)return s.compile([a.OP_HASH160,h.hash,a.OP_EQUAL])}),o.prop(h,"redeem",()=>{if(e.input)return d()}),o.prop(h,"input",()=>{if(e.redeem&&e.redeem.input&&e.redeem.output)return s.compile([].concat(s.decompile(e.redeem.input),e.redeem.output))}),o.prop(h,"witness",()=>h.redeem&&h.redeem.witness?h.redeem.witness:h.input?[]:void 0),o.prop(h,"name",()=>{const t=["p2sh"];return void 0!==h.redeem&&t.push(h.redeem.name),t.join("-")}),r.validate){let r=t.from([]);if(e.address){if(f().version!==c.scriptHash)throw new TypeError("Invalid version or Network mismatch");if(20!==f().hash.length)throw new TypeError("Invalid address");r=f().hash}if(e.hash){if(r.length>0&&!r.equals(e.hash))throw new TypeError("Hash mismatch");r=e.hash}if(e.output){if(23!==e.output.length||e.output[0]!==a.OP_HASH160||20!==e.output[1]||e.output[22]!==a.OP_EQUAL)throw new TypeError("Output is invalid");const t=e.output.slice(2,22);if(r.length>0&&!r.equals(t))throw new TypeError("Hash mismatch");r=t}const i=t=>{if(t.output){const e=s.decompile(t.output);if(!e||e.length<1)throw new TypeError("Redeem.output too short");const i=n.hash160(t.output);if(r.length>0&&!r.equals(i))throw new TypeError("Hash mismatch");r=i}if(t.input){const e=t.input.length>0,r=t.witness&&t.witness.length>0;if(!e&&!r)throw new TypeError("Empty input");if(e&&r)throw new TypeError("Input and witness provided");if(e){const e=s.decompile(t.input);if(!s.isPushOnly(e))throw new TypeError("Non push-only scriptSig")}}};if(e.input){const e=l();if(!e||e.length<1)throw new TypeError("Input too short");if(!t.isBuffer(d().output))throw new TypeError("Input is invalid");i(d())}if(e.redeem){if(e.redeem.network&&e.redeem.network!==c)throw new TypeError("Network mismatch");if(e.input){const t=d();if(e.redeem.output&&!e.redeem.output.equals(t.output))throw new TypeError("Redeem.output mismatch");if(e.redeem.input&&!e.redeem.input.equals(t.input))throw new TypeError("Redeem.input mismatch")}i(e.redeem)}if(e.witness&&e.redeem&&e.redeem.witness&&!function(t,e){return t.length===e.length&&t.every((t,r)=>t.equals(e[r]))}(e.redeem.witness,e.witness))throw new TypeError("Witness and redeem.witness mismatch")}return Object.assign(h,e)}}).call(this,r(19).Buffer)},3963:function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});const n=r(3160),i=r(3118),s=r(3060),o=r(3216),u=r(2066),a=s.OPS,p=r(3117),c=r(3441),h=t.alloc(0);e.p2wpkh=function(e,r){if(!e.address&&!e.hash&&!e.output&&!e.pubkey&&!e.witness)throw new TypeError("Not enough data");r=Object.assign({validate:!0},r||{}),u({address:u.maybe(u.String),hash:u.maybe(u.BufferN(20)),input:u.maybe(u.BufferN(0)),network:u.maybe(u.Object),output:u.maybe(u.BufferN(22)),pubkey:u.maybe(p.isPoint),signature:u.maybe(s.isCanonicalScriptSignature),witness:u.maybe(u.arrayOf(u.Buffer))},e);const f=o.value(()=>{const r=c.decode(e.address),n=r.words.shift(),i=c.fromWords(r.words);return{version:n,prefix:r.prefix,data:t.from(i)}}),l=e.network||i.bitcoin,d={name:"p2wpkh",network:l};if(o.prop(d,"address",()=>{if(!d.hash)return;const t=c.toWords(d.hash);return t.unshift(0),c.encode(l.bech32,t)}),o.prop(d,"hash",()=>e.output?e.output.slice(2,22):e.address?f().data:e.pubkey||d.pubkey?n.hash160(e.pubkey||d.pubkey):void 0),o.prop(d,"output",()=>{if(d.hash)return s.compile([a.OP_0,d.hash])}),o.prop(d,"pubkey",()=>e.pubkey?e.pubkey:e.witness?e.witness[1]:void 0),o.prop(d,"signature",()=>{if(e.witness)return e.witness[0]}),o.prop(d,"input",()=>{if(d.witness)return h}),o.prop(d,"witness",()=>{if(e.pubkey&&e.signature)return[e.signature,e.pubkey]}),r.validate){let r=t.from([]);if(e.address){if(l&&l.bech32!==f().prefix)throw new TypeError("Invalid prefix or Network mismatch");if(0!==f().version)throw new TypeError("Invalid address version");if(20!==f().data.length)throw new TypeError("Invalid address data");r=f().data}if(e.hash){if(r.length>0&&!r.equals(e.hash))throw new TypeError("Hash mismatch");r=e.hash}if(e.output){if(22!==e.output.length||e.output[0]!==a.OP_0||20!==e.output[1])throw new TypeError("Output is invalid");if(r.length>0&&!r.equals(e.output.slice(2)))throw new TypeError("Hash mismatch");r=e.output.slice(2)}if(e.pubkey){const t=n.hash160(e.pubkey);if(r.length>0&&!r.equals(t))throw new TypeError("Hash mismatch");if(r=t,!p.isPoint(e.pubkey)||33!==e.pubkey.length)throw new TypeError("Invalid pubkey for p2wpkh")}if(e.witness){if(2!==e.witness.length)throw new TypeError("Witness is invalid");if(!s.isCanonicalScriptSignature(e.witness[0]))throw new TypeError("Witness has invalid signature");if(!p.isPoint(e.witness[1])||33!==e.witness[1].length)throw new TypeError("Witness has invalid pubkey");if(e.signature&&!e.signature.equals(e.witness[0]))throw new TypeError("Signature mismatch");if(e.pubkey&&!e.pubkey.equals(e.witness[1]))throw new TypeError("Pubkey mismatch");const t=n.hash160(e.witness[1]);if(r.length>0&&!r.equals(t))throw new TypeError("Hash mismatch")}}return Object.assign(d,e)}}).call(this,r(19).Buffer)},3964:function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});const n=r(3160),i=r(3118),s=r(3060),o=r(3216),u=r(2066),a=s.OPS,p=r(3117),c=r(3441),h=t.alloc(0);function f(e){return!(!t.isBuffer(e)||65!==e.length||4!==e[0]||!p.isPoint(e))}e.p2wsh=function(e,r){if(!e.address&&!e.hash&&!e.output&&!e.redeem&&!e.witness)throw new TypeError("Not enough data");r=Object.assign({validate:!0},r||{}),u({network:u.maybe(u.Object),address:u.maybe(u.String),hash:u.maybe(u.BufferN(32)),output:u.maybe(u.BufferN(34)),redeem:u.maybe({input:u.maybe(u.Buffer),network:u.maybe(u.Object),output:u.maybe(u.Buffer),witness:u.maybe(u.arrayOf(u.Buffer))}),input:u.maybe(u.BufferN(0)),witness:u.maybe(u.arrayOf(u.Buffer))},e);const p=o.value(()=>{const r=c.decode(e.address),n=r.words.shift(),i=c.fromWords(r.words);return{version:n,prefix:r.prefix,data:t.from(i)}}),l=o.value(()=>s.decompile(e.redeem.input));let d=e.network;d||(d=e.redeem&&e.redeem.network||i.bitcoin);const y={network:d};if(o.prop(y,"address",()=>{if(!y.hash)return;const t=c.toWords(y.hash);return t.unshift(0),c.encode(d.bech32,t)}),o.prop(y,"hash",()=>e.output?e.output.slice(2):e.address?p().data:y.redeem&&y.redeem.output?n.sha256(y.redeem.output):void 0),o.prop(y,"output",()=>{if(y.hash)return s.compile([a.OP_0,y.hash])}),o.prop(y,"redeem",()=>{if(e.witness)return{output:e.witness[e.witness.length-1],input:h,witness:e.witness.slice(0,-1)}}),o.prop(y,"input",()=>{if(y.witness)return h}),o.prop(y,"witness",()=>{if(e.redeem&&e.redeem.input&&e.redeem.input.length>0&&e.redeem.output&&e.redeem.output.length>0){const t=s.toStack(l());return y.redeem=Object.assign({witness:t},e.redeem),y.redeem.input=h,[].concat(t,e.redeem.output)}if(e.redeem&&e.redeem.output&&e.redeem.witness)return[].concat(e.redeem.witness,e.redeem.output)}),o.prop(y,"name",()=>{const t=["p2wsh"];return void 0!==y.redeem&&t.push(y.redeem.name),t.join("-")}),r.validate){let r=t.from([]);if(e.address){if(p().prefix!==d.bech32)throw new TypeError("Invalid prefix or Network mismatch");if(0!==p().version)throw new TypeError("Invalid address version");if(32!==p().data.length)throw new TypeError("Invalid address data");r=p().data}if(e.hash){if(r.length>0&&!r.equals(e.hash))throw new TypeError("Hash mismatch");r=e.hash}if(e.output){if(34!==e.output.length||e.output[0]!==a.OP_0||32!==e.output[1])throw new TypeError("Output is invalid");const t=e.output.slice(2);if(r.length>0&&!r.equals(t))throw new TypeError("Hash mismatch");r=t}if(e.redeem){if(e.redeem.network&&e.redeem.network!==d)throw new TypeError("Network mismatch");if(e.redeem.input&&e.redeem.input.length>0&&e.redeem.witness&&e.redeem.witness.length>0)throw new TypeError("Ambiguous witness source");if(e.redeem.output){if(0===s.decompile(e.redeem.output).length)throw new TypeError("Redeem.output is invalid");const t=n.sha256(e.redeem.output);if(r.length>0&&!r.equals(t))throw new TypeError("Hash mismatch");r=t}if(e.redeem.input&&!s.isPushOnly(l()))throw new TypeError("Non push-only scriptSig");if(e.witness&&e.redeem.witness&&!function(t,e){return t.length===e.length&&t.every((t,r)=>t.equals(e[r]))}(e.witness,e.redeem.witness))throw new TypeError("Witness and redeem.witness mismatch");if(e.redeem.input&&l().some(f)||e.redeem.output&&(s.decompile(e.redeem.output)||[]).some(f))throw new TypeError("redeem.input or redeem.output contains uncompressed pubkey")}if(e.witness&&e.witness.length>0){const t=e.witness[e.witness.length-1];if(e.redeem&&e.redeem.output&&!e.redeem.output.equals(t))throw new TypeError("Witness and redeem.output mismatch");if(e.witness.some(f)||(s.decompile(t)||[]).some(f))throw new TypeError("Witness contains uncompressed pubkey")}}return Object.assign(y,e)}}).call(this,r(19).Buffer)},3965:function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});const n=r(3343),i=r(3160),s=r(3344),o=r(3140),u=r(3966),a=r(2066),p=r(1144),c=new TypeError("Cannot compute merkle root for zero transactions"),h=new TypeError("Cannot compute witness commit for non-segwit block");class f{constructor(){this.version=1,this.prevHash=void 0,this.merkleRoot=void 0,this.timestamp=0,this.witnessCommit=void 0,this.bits=0,this.nonce=0,this.transactions=void 0}static fromBuffer(t){if(t.length<80)throw new Error("Buffer too small (< 80 bytes)");const e=new n.BufferReader(t),r=new f;if(r.version=e.readInt32(),r.prevHash=e.readSlice(32),r.merkleRoot=e.readSlice(32),r.timestamp=e.readUInt32(),r.bits=e.readUInt32(),r.nonce=e.readUInt32(),80===t.length)return r;const i=()=>{const t=s.Transaction.fromBuffer(e.buffer.slice(e.offset),!0);return e.offset+=t.byteLength(),t},o=e.readVarInt();r.transactions=[];for(let n=0;n<o;++n){const t=i();r.transactions.push(t)}const u=r.getWitnessCommit();return u&&(r.witnessCommit=u),r}static fromHex(e){return f.fromBuffer(t.from(e,"hex"))}static calculateTarget(e){const r=((4278190080&e)>>24)-3,n=8388607&e,i=t.alloc(32,0);return i.writeUIntBE(n,29-r,3),i}static calculateMerkleRoot(e,r){if(a([{getHash:o.Function}],e),0===e.length)throw c;if(r&&!l(e))throw h;const n=e.map(t=>t.getHash(r)),s=u(n,i.hash256);return r?i.hash256(t.concat([s,e[0].ins[0].witness[0]])):s}getWitnessCommit(){if(!l(this.transactions))return null;const e=this.transactions[0].outs.filter(e=>e.script.slice(0,6).equals(t.from("6a24aa21a9ed","hex"))).map(t=>t.script.slice(6,38));if(0===e.length)return null;const r=e[e.length-1];return r instanceof t&&32===r.length?r:null}hasWitnessCommit(){return this.witnessCommit instanceof t&&32===this.witnessCommit.length||null!==this.getWitnessCommit()}hasWitness(){return(t=this.transactions)instanceof Array&&t.some(t=>"object"===typeof t&&t.ins instanceof Array&&t.ins.some(t=>"object"===typeof t&&t.witness instanceof Array&&t.witness.length>0));var t}weight(){return 3*this.byteLength(!1,!1)+this.byteLength(!1,!0)}byteLength(t,e=!0){return t||!this.transactions?80:80+p.encodingLength(this.transactions.length)+this.transactions.reduce((t,r)=>t+r.byteLength(e),0)}getHash(){return i.hash256(this.toBuffer(!0))}getId(){return n.reverseBuffer(this.getHash()).toString("hex")}getUTCDate(){const t=new Date(0);return t.setUTCSeconds(this.timestamp),t}toBuffer(e){const r=t.allocUnsafe(this.byteLength(e)),i=new n.BufferWriter(r);return i.writeInt32(this.version),i.writeSlice(this.prevHash),i.writeSlice(this.merkleRoot),i.writeUInt32(this.timestamp),i.writeUInt32(this.bits),i.writeUInt32(this.nonce),e||!this.transactions||(p.encode(this.transactions.length,r,i.offset),i.offset+=p.encode.bytes,this.transactions.forEach(t=>{const e=t.byteLength();t.toBuffer(r,i.offset),i.offset+=e})),r}toHex(t){return this.toBuffer(t).toString("hex")}checkTxRoots(){const t=this.hasWitnessCommit();return!(!t&&this.hasWitness())&&(this.__checkMerkleRoot()&&(!t||this.__checkWitnessCommit()))}checkProofOfWork(){const t=n.reverseBuffer(this.getHash()),e=f.calculateTarget(this.bits);return t.compare(e)<=0}__checkMerkleRoot(){if(!this.transactions)throw c;const t=f.calculateMerkleRoot(this.transactions);return 0===this.merkleRoot.compare(t)}__checkWitnessCommit(){if(!this.transactions)throw c;if(!this.hasWitnessCommit())throw h;const t=f.calculateMerkleRoot(this.transactions,!0);return 0===this.witnessCommit.compare(t)}}function l(t){return t instanceof Array&&t[0]&&t[0].ins&&t[0].ins instanceof Array&&t[0].ins[0]&&t[0].ins[0].witness&&t[0].ins[0].witness instanceof Array&&t[0].ins[0].witness.length>0}e.Block=f}).call(this,r(19).Buffer)},3966:function(t,e,r){(function(e){t.exports=function(t,r){if(!Array.isArray(t))throw TypeError("Expected values Array");if("function"!==typeof r)throw TypeError("Expected digest Function");for(var n=t.length,i=t.concat();n>1;){for(var s=0,o=0;o<n;o+=2,++s){var u=i[o],a=o+1===n?u:i[o+1],p=e.concat([u,a]);i[s]=r(p)}n=s}return i[0]}}).call(this,r(19).Buffer)},3967:function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});const n=r(2085),i=r(769),s=r(1171),o=r(3438),u=r(3343),a=r(3160),p=r(3442),c=r(3118),h=r(3342),f=r(3060),l=r(3344),d=l.Transaction.SIGHASH_ALL|l.Transaction.SIGHASH_BITCOINCASHBIP143,y=l.Transaction.SIGHASH_ALL|l.Transaction.SIGHASH_BITCOINCASHBIP143|l.Transaction.FORKID_BTG<<8,w=[l.Transaction.SIGHASH_ALL,d,y],g={network:c.bitcoin,maximumFeeRate:5e3,forkCoin:"none"};class v{constructor(t={},e=new n.Psbt(new _)){this.data=e,this.opts=Object.assign({},g,t),this.__CACHE={__NON_WITNESS_UTXO_TX_CACHE:[],__NON_WITNESS_UTXO_BUF_CACHE:[],__TX_IN_CACHE:{},__TX:this.data.globalMap.unsignedTx.tx,__UNSAFE_SIGN_NONSEGWIT:!1},0===this.data.inputs.length&&this.setVersion(2);const r=(t,e,r,n)=>Object.defineProperty(t,e,{enumerable:r,writable:n});r(this,"__CACHE",!1,!0),r(this,"opts",!1,!0)}static fromBase64(e,r={}){const n=t.from(e,"base64");return this.fromBuffer(n,r)}static fromHex(e,r={}){const n=t.from(e,"hex");return this.fromBuffer(n,r)}static fromBuffer(t,e={}){const r=n.Psbt.fromBuffer(t,m),i=new v(e,r);var s,o;return s=i.__CACHE.__TX,o=i.__CACHE,s.ins.forEach(t=>{x(o,t)}),i}get inputCount(){return this.data.inputs.length}get version(){return this.__CACHE.__TX.version}set version(t){this.setVersion(t)}get locktime(){return this.__CACHE.__TX.locktime}set locktime(t){this.setLocktime(t)}get txInputs(){return this.__CACHE.__TX.ins.map(t=>({hash:u.cloneBuffer(t.hash),index:t.index,sequence:t.sequence}))}get txOutputs(){return this.__CACHE.__TX.outs.map(t=>{let e;try{e=o.fromOutputScript(t.script,this.opts.network)}catch(r){}return{script:u.cloneBuffer(t.script),value:t.value,address:e}})}combine(...t){return this.data.combine(...t.map(t=>t.data)),this}clone(){const t=v.fromBuffer(this.data.toBuffer());return t.opts=JSON.parse(JSON.stringify(this.opts)),t}setMaximumFeeRate(t){U(t),this.opts.maximumFeeRate=t}setVersion(t){U(t),B(this.data.inputs,"setVersion");const e=this.__CACHE;return e.__TX.version=t,e.__EXTRACTED_TX=void 0,this}setLocktime(t){U(t),B(this.data.inputs,"setLocktime");const e=this.__CACHE;return e.__TX.locktime=t,e.__EXTRACTED_TX=void 0,this}setInputSequence(t,e){U(e),B(this.data.inputs,"setInputSequence");const r=this.__CACHE;if(r.__TX.ins.length<=t)throw new Error("Input index too high");return r.__TX.ins[t].sequence=e,r.__EXTRACTED_TX=void 0,this}addInputs(t){return t.forEach(t=>this.addInput(t)),this}addInput(t){if(arguments.length>1||!t||void 0===t.hash||void 0===t.index)throw new Error("Invalid arguments for Psbt.addInput. Requires single object with at least [hash] and [index]");B(this.data.inputs,"addInput"),t.witnessScript&&Q(t.witnessScript);const e=this.__CACHE;this.data.addInput(t);x(e,e.__TX.ins[e.__TX.ins.length-1]);const r=this.data.inputs.length-1,n=this.data.inputs[r];return n.nonWitnessUtxo&&G(this.__CACHE,n,r),e.__FEE=void 0,e.__FEE_RATE=void 0,e.__EXTRACTED_TX=void 0,this}addOutputs(t){return t.forEach(t=>this.addOutput(t)),this}addOutput(t){if(arguments.length>1||!t||void 0===t.value||void 0===t.address&&void 0===t.script)throw new Error("Invalid arguments for Psbt.addOutput. Requires single object with at least [script or address] and [value]");B(this.data.inputs,"addOutput");const{address:e}=t;if("string"===typeof e){const{network:r}=this.opts,n=o.toOutputScript(e,r);t=Object.assign(t,{script:n})}const r=this.__CACHE;return this.data.addOutput(t),r.__FEE=void 0,r.__FEE_RATE=void 0,r.__EXTRACTED_TX=void 0,this}extractTransaction(t){if(!this.data.inputs.every(E))throw new Error("Not finalized");const e=this.__CACHE;if(t||function(t,e,r){const n=e.__FEE_RATE||t.getFeeRate(),i=e.__EXTRACTED_TX.virtualSize(),s=n*i;if(n>=r.maximumFeeRate)throw new Error(`Warning: You are paying around ${(s/1e8).toFixed(8)} in fees, which is ${n} satoshi per byte for a transaction with a VSize of ${i} bytes (segwit counted as 0.25 byte per byte). Use setMaximumFeeRate method to raise your threshold, or pass true to the first arg of extractTransaction.`)}(this,e,this.opts),e.__EXTRACTED_TX)return e.__EXTRACTED_TX;const r=e.__TX.clone();return X(this.data.inputs,r,e,!0),r}getFeeRate(){return L("__FEE_RATE","fee rate",this.data.inputs,this.__CACHE)}getFee(){return L("__FEE","fee",this.data.inputs,this.__CACHE)}finalizeAllInputs(){return s.checkForInput(this.data.inputs,0),et(this.data.inputs.length).forEach(t=>this.finalizeInput(t)),this}finalizeInput(t,e=D){const r=s.checkForInput(this.data.inputs,t),{script:n,isP2SH:i,isP2WSH:o,isSegwit:u}=function(t,e,r){const n=r.__TX,i={script:null,isSegwit:!1,isP2SH:!1,isP2WSH:!1};if(i.isP2SH=!!e.redeemScript,i.isP2WSH=!!e.witnessScript,e.witnessScript)i.script=e.witnessScript;else if(e.redeemScript)i.script=e.redeemScript;else if(e.nonWitnessUtxo){const s=z(r,e,t),o=n.ins[t].index;i.script=s.outs[o].script}else e.witnessUtxo&&(i.script=e.witnessUtxo.script);(e.witnessScript||k(i.script))&&(i.isSegwit=!0);return i}(t,r,this.__CACHE);if(!n)throw new Error("No script found for input #"+t);!function(t){if(!t.sighashType||!t.partialSig)return;const{partialSig:e,sighashType:r}=t;e.forEach(t=>{const{hashType:e}=f.signature.decode(t.signature);if((255&r)!==e)throw new Error("Signature sighash does not match input sighash type")})}(r);const{finalScriptSig:a,finalScriptWitness:p}=e(t,r,n,u,i,o);if(a&&this.data.updateInput(t,{finalScriptSig:a}),p&&this.data.updateInput(t,{finalScriptWitness:p}),!a&&!p)throw new Error("Unknown error finalizing input #"+t);return this.data.clearFinalizedInput(t),this}getInputType(e){const r=s.checkForInput(this.data.inputs,e),n=Y(J(e,r,this.__CACHE),e,"input",r.redeemScript||function(e){if(!e)return;const r=f.decompile(e);if(!r)return;const n=r[r.length-1];if(!t.isBuffer(n)||$(n)||(i=n,f.isCanonicalScriptSignature(i)))return;var i;if(!f.decompile(n))return;return n}(r.finalScriptSig),r.witnessScript||function(t){if(!t)return;const e=V(t),r=e[e.length-1];if($(r))return;if(!f.decompile(r))return;return r}(r.finalScriptWitness));return("raw"===n.type?"":n.type+"-")+tt(n.meaningfulScript)}inputHasPubkey(t,e){return function(t,e,r,n){const i=J(r,e,n),{meaningfulScript:s}=Y(i,r,"input",e.redeemScript,e.witnessScript);return Z(t,s)}(e,s.checkForInput(this.data.inputs,t),t,this.__CACHE)}inputHasHDKey(t,e){const r=s.checkForInput(this.data.inputs,t),n=H(e);return!!r.bip32Derivation&&r.bip32Derivation.some(n)}outputHasPubkey(t,e){return function(t,e,r,n){const i=n.__TX.outs[r].script,{meaningfulScript:s}=Y(i,r,"output",e.redeemScript,e.witnessScript);return Z(t,s)}(e,s.checkForOutput(this.data.outputs,t),t,this.__CACHE)}outputHasHDKey(t,e){const r=s.checkForOutput(this.data.outputs,t),n=H(e);return!!r.bip32Derivation&&r.bip32Derivation.some(n)}validateSignaturesOfAllInputs(){s.checkForInput(this.data.inputs,0);return et(this.data.inputs.length).map(t=>this.validateSignaturesOfInput(t)).reduce((t,e)=>!0===e&&t,!0)}validateSignaturesOfInput(t,e){const r=this.data.inputs[t],n=(r||{}).partialSig;if(!r||!n||n.length<1)throw new Error("No signatures to validate");const i=e?n.filter(t=>t.pubkey.equals(e)):n;if(i.length<1)throw new Error("No signatures for this pubkey");const s=[];let o,u,a;for(const c of i){const e=f.signature.decode(c.signature),{hash:n,script:i}=a!==e.hashType?F(t,Object.assign({},r,{sighashType:e.hashType}),this.__CACHE,!0,this.opts.forkCoin):{hash:o,script:u};a=e.hashType,o=n,u=i,C(c.pubkey,i,"verify");const h=p.fromPublicKey(c.pubkey);s.push(h.verify(n,e.signature))}return s.every(t=>!0===t)}signAllInputsHD(t,e=w){if(!t||!t.publicKey||!t.fingerprint)throw new Error("Need HDSigner to sign input");const r=[];for(const i of et(this.data.inputs.length))try{this.signInputHD(i,t,e),r.push(!0)}catch(n){r.push(!1)}if(r.every(t=>!1===t))throw new Error("No inputs were signed");return this}signAllInputsHDAsync(t,e=w){return new Promise((r,n)=>{if(!t||!t.publicKey||!t.fingerprint)return n(new Error("Need HDSigner to sign input"));const i=[],s=[];for(const o of et(this.data.inputs.length))s.push(this.signInputHDAsync(o,t,e).then(()=>{i.push(!0)},()=>{i.push(!1)}));return Promise.all(s).then(()=>{if(i.every(t=>!1===t))return n(new Error("No inputs were signed"));r()})})}signInputHD(t,e,r=w){if(!e||!e.publicKey||!e.fingerprint)throw new Error("Need HDSigner to sign input");return W(t,this.data.inputs,e).forEach(e=>this.signInput(t,e,r)),this}signInputHDAsync(t,e,r=w){return new Promise((n,i)=>{if(!e||!e.publicKey||!e.fingerprint)return i(new Error("Need HDSigner to sign input"));const s=W(t,this.data.inputs,e).map(e=>this.signInputAsync(t,e,r));return Promise.all(s).then(()=>{n()}).catch(i)})}signAllInputs(t,e=w){if(!t||!t.publicKey)throw new Error("Need Signer to sign input");const r=[];for(const i of et(this.data.inputs.length))try{this.signInput(i,t,e),r.push(!0)}catch(n){r.push(!1)}if(r.every(t=>!1===t))throw new Error("No inputs were signed");return this}signAllInputsAsync(t,e=w){return new Promise((r,n)=>{if(!t||!t.publicKey)return n(new Error("Need Signer to sign input"));const i=[],s=[];for(const[o]of this.data.inputs.entries())s.push(this.signInputAsync(o,t,e).then(()=>{i.push(!0)},()=>{i.push(!1)}));return Promise.all(s).then(()=>{if(i.every(t=>!1===t))return n(new Error("No inputs were signed"));r()})})}signInput(t,e,r=w){if(!e||!e.publicKey)throw new Error("Need Signer to sign input");const{hash:n,sighashType:i}=q(this.data.inputs,t,e.publicKey,this.__CACHE,r,this.opts.forkCoin),s=[{pubkey:e.publicKey,signature:f.signature.encode(e.sign(n),255&i)}];return this.data.updateInput(t,{partialSig:s}),this}signInputAsync(t,e,r=w){return Promise.resolve().then(()=>{if(!e||!e.publicKey)throw new Error("Need Signer to sign input");const{hash:n,sighashType:i}=q(this.data.inputs,t,e.publicKey,this.__CACHE,r,this.opts.forkCoin);return Promise.resolve(e.sign(n)).then(r=>{const n=[{pubkey:e.publicKey,signature:f.signature.encode(r,255&i)}];this.data.updateInput(t,{partialSig:n})})})}toBuffer(){return S(this.__CACHE),this.data.toBuffer()}toHex(){return S(this.__CACHE),this.data.toHex()}toBase64(){return S(this.__CACHE),this.data.toBase64()}updateGlobal(t){return this.data.updateGlobal(t),this}updateInput(t,e){return e.witnessScript&&Q(e.witnessScript),this.data.updateInput(t,e),e.nonWitnessUtxo&&G(this.__CACHE,this.data.inputs[t],t),this}updateOutput(t,e){return this.data.updateOutput(t,e),this}addUnknownKeyValToGlobal(t){return this.data.addUnknownKeyValToGlobal(t),this}addUnknownKeyValToInput(t,e){return this.data.addUnknownKeyValToInput(t,e),this}addUnknownKeyValToOutput(t,e){return this.data.addUnknownKeyValToOutput(t,e),this}clearFinalizedInput(t){return this.data.clearFinalizedInput(t),this}}e.Psbt=v;const m=t=>new _(t);class _{constructor(e=t.from([2,0,0,0,0,0,0,0,0,0])){this.tx=l.Transaction.fromBuffer(e),function(t){if(!t.ins.every(t=>t.script&&0===t.script.length&&t.witness&&0===t.witness.length))throw new Error("Format Error: Transaction ScriptSigs are not empty")}(this.tx),Object.defineProperty(this,"tx",{enumerable:!1,writable:!0})}getInputOutputCounts(){return{inputCount:this.tx.ins.length,outputCount:this.tx.outs.length}}addInput(e){if(void 0===e.hash||void 0===e.index||!t.isBuffer(e.hash)&&"string"!==typeof e.hash||"number"!==typeof e.index)throw new Error("Error adding input.");const r="string"===typeof e.hash?u.reverseBuffer(t.from(e.hash,"hex")):e.hash;this.tx.addInput(r,e.index,e.sequence)}addOutput(e){if(void 0===e.script||void 0===e.value||!t.isBuffer(e.script)||"number"!==typeof e.value)throw new Error("Error adding output.");this.tx.addOutput(e.script,e.value)}toBuffer(){return this.tx.toBuffer()}}function S(t){if(!1!==t.__UNSAFE_SIGN_NONSEGWIT)throw new Error("Not BIP174 compliant, can not export")}function b(t,e,r){if(!e)return!1;let n;if(n=r?r.map(t=>{const r=p.fromPublicKey(t,{compressed:!0}).publicKey;return e.find(t=>t.pubkey.equals(r))}).filter(t=>!!t):e,n.length>t)throw new Error("Too many signatures");return n.length===t}function E(t){return!!t.finalScriptSig||!!t.finalScriptWitness}function P(t){return e=>{try{return t({output:e}),!0}catch(r){return!1}}}const O=P(h.p2ms),T=P(h.p2pk),I=P(h.p2pkh),k=P(h.p2wpkh),A=P(h.p2wsh),N=P(h.p2sh);function H(t){return e=>!!e.masterFingerprint.equals(t.fingerprint)&&!!t.derivePath(e.path).publicKey.equals(e.pubkey)}function U(t){if("number"!==typeof t||t!==Math.floor(t)||t>4294967295||t<0)throw new Error("Invalid 32 bit integer")}function B(e,r){e.forEach(e=>{let n=!1,i=[];if(0===(e.partialSig||[]).length){if(!e.finalScriptSig&&!e.finalScriptWitness)return;i=function(e){const r=e.finalScriptSig&&f.decompile(e.finalScriptSig)||[],n=e.finalScriptWitness&&f.decompile(e.finalScriptWitness)||[];return r.concat(n).filter(e=>t.isBuffer(e)&&f.isCanonicalScriptSignature(e)).map(t=>({signature:t}))}(e)}else i=e.partialSig;if(i.forEach(t=>{const{hashType:e}=f.signature.decode(t.signature),i=[];e&l.Transaction.SIGHASH_ANYONECANPAY&&i.push("addInput");switch(31&e){case l.Transaction.SIGHASH_ALL:break;case l.Transaction.SIGHASH_SINGLE:case l.Transaction.SIGHASH_NONE:i.push("addOutput"),i.push("setInputSequence")}-1===i.indexOf(r)&&(n=!0)}),n)throw new Error("Can not modify transaction, signatures exist.")})}function C(t,e,r){if(!Z(t,e))throw new Error(`Can not ${r} for this input with the key ${t.toString("hex")}`)}function x(e,r){const n=u.reverseBuffer(t.from(r.hash)).toString("hex")+":"+r.index;if(e.__TX_IN_CACHE[n])throw new Error("Duplicate input detected.");e.__TX_IN_CACHE[n]=1}function M(t,e){return(r,n,i,s)=>{const o=t({redeem:{output:i}}).output;if(!n.equals(o))throw new Error(`${e} for ${s} #${r} doesn't match the scriptPubKey in the prevout`)}}const R=M(h.p2sh,"Redeem script"),K=M(h.p2wsh,"Witness script");function L(t,e,r,n){if(!r.every(E))throw new Error("PSBT must be finalized to calculate "+e);if("__FEE_RATE"===t&&n.__FEE_RATE)return n.__FEE_RATE;if("__FEE"===t&&n.__FEE)return n.__FEE;let i,s=!0;return n.__EXTRACTED_TX?(i=n.__EXTRACTED_TX,s=!1):i=n.__TX.clone(),X(r,i,n,s),"__FEE_RATE"===t?n.__FEE_RATE:"__FEE"===t?n.__FEE:void 0}function D(t,e,r,n,i,s){const o=tt(r);if(!function(t,e,r){switch(r){case"pubkey":case"pubkeyhash":case"witnesspubkeyhash":return b(1,t.partialSig);case"multisig":const r=h.p2ms({output:e});return b(r.m,t.partialSig,r.pubkeys);default:return!1}}(e,r,o))throw new Error("Can not finalize input #"+t);return function(t,e,r,n,i,s){let o,u;const a=function(t,e,r){let n;switch(e){case"multisig":const e=function(t,e){return h.p2ms({output:t}).pubkeys.map(t=>(e.filter(e=>e.pubkey.equals(t))[0]||{}).signature).filter(t=>!!t)}(t,r);n=h.p2ms({output:t,signatures:e});break;case"pubkey":n=h.p2pk({output:t,signature:r[0].signature});break;case"pubkeyhash":n=h.p2pkh({output:t,pubkey:r[0].pubkey,signature:r[0].signature});break;case"witnesspubkeyhash":n=h.p2wpkh({output:t,pubkey:r[0].pubkey,signature:r[0].signature})}return n}(t,e,r),p=s?h.p2wsh({redeem:a}):null,c=i?h.p2sh({redeem:p||a}):null;n?(u=j(p?p.witness:a.witness),c&&(o=c.input)):o=c?c.input:a.input;return{finalScriptSig:o,finalScriptWitness:u}}(r,o,e.partialSig,n,i,s)}function q(t,e,r,n,i,o){const u=s.checkForInput(t,e),{hash:a,sighashType:p,script:c}=F(e,u,n,!1,o,i);return C(r,c,"sign"),{hash:a,sighashType:p}}function F(t,e,r,n,i,s){const o=r.__TX,u=e.sighashType||function(t){switch(t){case"bch":return d;case"btg":return y;case"none":return l.Transaction.SIGHASH_ALL}}(i);if(s&&s.indexOf(u)<0){const t=function(t){let e=t&l.Transaction.SIGHASH_ANYONECANPAY?"SIGHASH_ANYONECANPAY | ":"";t&l.Transaction.SIGHASH_BITCOINCASHBIP143&&(e+="SIGHASH_BITCOINCASHBIP143 | ");t&l.Transaction.FORKID_BTG<<8?e+="FORKID_BTG | ":e+="FORKID_BCH | ";switch(31&t){case l.Transaction.SIGHASH_ALL:e+="SIGHASH_ALL";break;case l.Transaction.SIGHASH_SINGLE:e+="SIGHASH_SINGLE";break;case l.Transaction.SIGHASH_NONE:e+="SIGHASH_NONE"}return e}(u);throw new Error("Sighash type is not allowed. Retry the sign method passing the sighashTypes array of whitelisted types. Sighash type: "+t)}let a,p;const c=(u&l.Transaction.SIGHASH_BITCOINCASHBIP143)>0,f=(u&l.Transaction.FORKID_BTG<<8)>0;if(e.nonWitnessUtxo){const n=z(r,e,t),i=o.ins[t].hash,s=n.getHash();if(!i.equals(s))throw new Error(`Non-witness UTXO hash for input #${t} doesn't match the hash specified in the prevout`);const u=o.ins[t].index;p=n.outs[u]}else{if(!e.witnessUtxo)throw new Error("Need a Utxo input item for signing");p=e.witnessUtxo}const{meaningfulScript:w,type:g}=Y(p.script,t,"input",e.redeemScript,e.witnessScript);if(["p2sh-p2wsh","p2wsh"].indexOf(g)>=0)a=c&&f?o.hashForGoldSignature(t,w,p.value,u,!0):o.hashForWitnessV0(t,w,p.value,u);else if(k(w)){const e=h.p2pkh({hash:w.slice(2)}).output;a=c&&f?o.hashForGoldSignature(t,e,p.value,u,!0):o.hashForWitnessV0(t,e,p.value,u)}else{if(!c&&void 0===e.nonWitnessUtxo&&!1===r.__UNSAFE_SIGN_NONSEGWIT)throw new Error(`Input #${t} has witnessUtxo but non-segwit script: `+w.toString("hex"));!n&&r.__UNSAFE_SIGN_NONSEGWIT,a=c&&f?o.hashForGoldSignature(t,w,p.value,u,!0):c?o.hashForCashSignature(t,w,p.value,u):o.hashForSignature(t,w,u)}return{script:w,sighashType:u,hash:a}}function W(t,e,r){const n=s.checkForInput(e,t);if(!n.bip32Derivation||0===n.bip32Derivation.length)throw new Error("Need bip32Derivation to sign with HD");const i=n.bip32Derivation.map(t=>t.masterFingerprint.equals(r.fingerprint)?t:void 0).filter(t=>!!t);if(0===i.length)throw new Error("Need one bip32Derivation masterFingerprint to match the HDSigner fingerprint");return i.map(t=>{const e=r.derivePath(t.path);if(!t.pubkey.equals(e.publicKey))throw new Error("pubkey did not match bip32Derivation");return e})}function V(t){let e=0;function r(){const r=i.decode(t,e);return e+=i.decode.bytes,r}function n(){return n=r(),e+=n,t.slice(e-n,e);var n}return function(){const t=r(),e=[];for(let r=0;r<t;r++)e.push(n());return e}()}function j(e){let r=t.allocUnsafe(0);function n(e){const n=r.length,s=i.encodingLength(e);r=t.concat([r,t.allocUnsafe(s)]),i.encode(e,r,n)}function s(e){n(e.length),function(e){r=t.concat([r,t.from(e)])}(e)}var o;return n((o=e).length),o.forEach(s),r}function G(t,e,r){t.__NON_WITNESS_UTXO_BUF_CACHE[r]=e.nonWitnessUtxo;const n=l.Transaction.fromBuffer(e.nonWitnessUtxo);t.__NON_WITNESS_UTXO_TX_CACHE[r]=n;const i=t,s=r;delete e.nonWitnessUtxo,Object.defineProperty(e,"nonWitnessUtxo",{enumerable:!0,get(){const t=i.__NON_WITNESS_UTXO_BUF_CACHE[s],e=i.__NON_WITNESS_UTXO_TX_CACHE[s];if(void 0!==t)return t;{const t=e.toBuffer();return i.__NON_WITNESS_UTXO_BUF_CACHE[s]=t,t}},set(t){i.__NON_WITNESS_UTXO_BUF_CACHE[s]=t}})}function X(t,e,r,n){let i=0;t.forEach((t,s)=>{if(n&&t.finalScriptSig&&(e.ins[s].script=t.finalScriptSig),n&&t.finalScriptWitness&&(e.ins[s].witness=V(t.finalScriptWitness)),t.witnessUtxo)i+=t.witnessUtxo.value;else if(t.nonWitnessUtxo){const n=z(r,t,s),o=e.ins[s].index,u=n.outs[o];i+=u.value}});const s=e.outs.reduce((t,e)=>t+e.value,0),o=i-s;if(o<0)throw new Error("Outputs are spending more than Inputs");const u=e.virtualSize();r.__FEE=o,r.__EXTRACTED_TX=e,r.__FEE_RATE=Math.floor(o/u)}function z(t,e,r){const n=t.__NON_WITNESS_UTXO_TX_CACHE;return n[r]||G(t,e,r),n[r]}function J(t,e,r){if(void 0!==e.witnessUtxo)return e.witnessUtxo.script;if(void 0!==e.nonWitnessUtxo){return z(r,e,t).outs[r.__TX.ins[t].index].script}throw new Error("Can't find pubkey in input without Utxo data")}function $(t){return 33===t.length&&f.isCanonicalPubKey(t)}function Y(t,e,r,n,i){const s=N(t),o=s&&n&&A(n),u=A(t);if(s&&void 0===n)throw new Error("scriptPubkey is P2SH but redeemScript missing");if((u||o)&&void 0===i)throw new Error("scriptPubkey or redeemScript is P2WSH but witnessScript missing");let a;return o?(a=i,R(e,t,n,r),K(e,n,i,r),Q(a)):u?(a=i,K(e,t,i,r),Q(a)):s?(a=n,R(e,t,n,r)):a=t,{meaningfulScript:a,type:o?"p2sh-p2wsh":s?"p2sh":u?"p2wsh":"raw"}}function Q(t){if(k(t)||N(t))throw new Error("P2WPKH or P2SH can not be contained within P2WSH")}function Z(t,e){const r=a.hash160(t),n=f.decompile(e);if(null===n)throw new Error("Unknown script error");return n.some(e=>"number"!==typeof e&&(e.equals(t)||e.equals(r)))}function tt(t){return k(t)?"witnesspubkeyhash":I(t)?"pubkeyhash":O(t)?"multisig":T(t)?"pubkey":"nonstandard"}function et(t){return[...Array(t).keys()]}}).call(this,r(19).Buffer)},3968:function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});const n=r(3438),i=r(3343),s=r(3969),o=r(3160),u=r(3442),a=r(3118),p=r(3342),c=r(3060),h=r(3060),f=r(3344),l=r(3140),d=r(2066),y=s.types,w=new Set(["p2pkh","p2pk","p2wpkh","p2ms","p2sh-p2pkh","p2sh-p2pk","p2sh-p2wpkh","p2sh-p2ms","p2wsh-p2pkh","p2wsh-p2pk","p2wsh-p2ms","p2sh-p2wsh-p2pkh","p2sh-p2wsh-p2pk","p2sh-p2wsh-p2ms"]);function g(t,e,r){try{d(t,e)}catch(n){throw new Error(r)}}class v{constructor(t=a.bitcoin,e=2500){this.network=t,this.maximumFeeRate=e,this.__PREV_TX_SET={},this.__INPUTS=[],this.__BITCOINCASH=!1,this.__BITCOINGOLD=!1,this.__TX=new f.Transaction,this.__TX.version=2,this.__USE_LOW_R=!1}static fromTransaction(t,e,r){const n=new v(e);return"number"===typeof r&&(r===f.Transaction.FORKID_BTG?n.enableBitcoinGold(!0):r===f.Transaction.FORKID_BCH&&n.enableBitcoinCash(!0)),n.setVersion(t.version),n.setLockTime(t.locktime),t.outs.forEach(t=>{n.addOutput(t.script,t.value)}),t.ins.forEach(t=>{n.__addInputUnsafe(t.hash,t.index,{sequence:t.sequence,script:t.script,witness:t.witness,value:t.value})}),n.__INPUTS.forEach((e,n)=>{!function(t,e,r,n,i){if(t.redeemScriptType!==y.P2MS||!t.redeemScript)return;if(t.pubkeys.length===t.signatures.length)return;const s=t.signatures.concat();t.signatures=t.pubkeys.map(o=>{const a=u.fromPublicKey(o);let p;return s.some((o,u)=>{if(!o)return!1;const h=c.signature.decode(o);let l;switch(i){case f.Transaction.FORKID_BCH:l=e.hashForCashSignature(r,t.redeemScript,n,h.hashType);break;case f.Transaction.FORKID_BTG:l=e.hashForGoldSignature(r,t.redeemScript,n,h.hashType);break;default:l=t.witness?e.hashForWitnessV0(r,t.redeemScript,n,h.hashType):e.hashForSignature(r,t.redeemScript,h.hashType)}return!!a.verify(l,h.signature)&&(s[u]=void 0,p=o,!0)}),p})}(e,t,n,e.value,r)}),n}enableBitcoinCash(t){"undefined"===typeof t&&(t=!0),this.__BITCOINCASH=t}enableBitcoinGold(t){"undefined"===typeof t&&(t=!0),this.__BITCOINGOLD=t}setLowR(t){return d(d.maybe(d.Boolean),t),void 0===t&&(t=!0),this.__USE_LOW_R=t,t}setLockTime(t){if(d(l.UInt32,t),this.__INPUTS.some(t=>!!t.signatures&&t.signatures.some(t=>void 0!==t)))throw new Error("No, this would invalidate signatures");this.__TX.locktime=t}setVersion(t){d(l.UInt32,t),this.__TX.version=t}addInput(e,r,n,s){if(!this.__canModifyInputs())throw new Error("No, this would invalidate signatures");let o;if("string"===typeof(u=e)||u instanceof String)e=i.reverseBuffer(t.from(e,"hex"));else if(function(t){return t instanceof f.Transaction}(e)){const t=e.outs[r];s=t.script,o=t.value,e=e.getHash(!1)}var u;return this.__addInputUnsafe(e,r,{sequence:n,prevOutScript:s,value:o})}addOutput(t,e){if(!this.__canModifyOutputs())throw new Error("No, this would invalidate signatures");return"string"===typeof t&&(t=n.toOutputScript(t,this.network)),this.__TX.addOutput(t,e)}build(){return this.__build(!1)}buildIncomplete(){return this.__build(!0)}sign(t,e,r,n,i,s){!function({input:t,ourPubKey:e,keyPair:r,signatureHash:n,hashType:i,useLowR:s}){let o=!1;for(const[u,a]of t.pubkeys.entries()){if(!e.equals(a))continue;if(t.signatures[u])throw new Error("Signature already exists");if(33!==e.length&&t.hasWitness)throw new Error("BIP143 rejects uncompressed public keys in P2WPKH or P2WSH");const p=r.sign(n,s);t.signatures[u]=c.signature.encode(p,i),o=!0}if(!o)throw new Error("Key pair cannot sign for this input")}(function(t,e,r,n,i,s,o,u,a,h,v,S){let b;if("number"===typeof i)b=i;else{if("object"!==typeof i)throw new TypeError("TransactionBuilder sign first arg must be TxbSignArg or number");!function(t,e){if(!w.has(e.prevOutScriptType))throw new TypeError(`Unknown prevOutScriptType "${e.prevOutScriptType}"`);g(d.Number,e.vin,"sign must include vin parameter as Number (input index)"),g(l.Signer,e.keyPair,"sign must include keyPair parameter as Signer interface"),g(d.maybe(d.Number),e.hashType,"sign hashType parameter must be a number");const r=(t[e.vin]||[]).prevOutType,n=e.prevOutScriptType;switch(n){case"p2pkh":if(r&&"pubkeyhash"!==r)throw new TypeError(`input #${e.vin} is not of type p2pkh: ${r}`);g(d.value(void 0),e.witnessScript,n+" requires NO witnessScript"),g(d.value(void 0),e.redeemScript,n+" requires NO redeemScript"),g(d.value(void 0),e.witnessValue,n+" requires NO witnessValue");break;case"p2pk":if(r&&"pubkey"!==r)throw new TypeError(`input #${e.vin} is not of type p2pk: ${r}`);g(d.value(void 0),e.witnessScript,n+" requires NO witnessScript"),g(d.value(void 0),e.redeemScript,n+" requires NO redeemScript"),g(d.value(void 0),e.witnessValue,n+" requires NO witnessValue");break;case"p2wpkh":if(r&&"witnesspubkeyhash"!==r)throw new TypeError(`input #${e.vin} is not of type p2wpkh: ${r}`);g(d.value(void 0),e.witnessScript,n+" requires NO witnessScript"),g(d.value(void 0),e.redeemScript,n+" requires NO redeemScript"),g(l.Satoshi,e.witnessValue,n+" requires witnessValue");break;case"p2ms":if(r&&"multisig"!==r)throw new TypeError(`input #${e.vin} is not of type p2ms: ${r}`);g(d.value(void 0),e.witnessScript,n+" requires NO witnessScript"),g(d.value(void 0),e.redeemScript,n+" requires NO redeemScript"),g(d.value(void 0),e.witnessValue,n+" requires NO witnessValue");break;case"p2sh-p2wpkh":if(r&&"scripthash"!==r)throw new TypeError(`input #${e.vin} is not of type p2sh-p2wpkh: ${r}`);g(d.value(void 0),e.witnessScript,n+" requires NO witnessScript"),g(d.Buffer,e.redeemScript,n+" requires redeemScript"),g(l.Satoshi,e.witnessValue,n+" requires witnessValue");break;case"p2sh-p2ms":case"p2sh-p2pk":case"p2sh-p2pkh":if(r&&"scripthash"!==r)throw new TypeError(`input #${e.vin} is not of type ${n}: ${r}`);g(d.value(void 0),e.witnessScript,n+" requires NO witnessScript"),g(d.Buffer,e.redeemScript,n+" requires redeemScript"),g(d.value(void 0),e.witnessValue,n+" requires NO witnessValue");break;case"p2wsh-p2ms":case"p2wsh-p2pk":case"p2wsh-p2pkh":if(r&&"witnessscripthash"!==r)throw new TypeError(`input #${e.vin} is not of type ${n}: ${r}`);g(d.Buffer,e.witnessScript,n+" requires witnessScript"),g(d.value(void 0),e.redeemScript,n+" requires NO redeemScript"),g(l.Satoshi,e.witnessValue,n+" requires witnessValue");break;case"p2sh-p2wsh-p2ms":case"p2sh-p2wsh-p2pk":case"p2sh-p2wsh-p2pkh":if(r&&"scripthash"!==r)throw new TypeError(`input #${e.vin} is not of type ${n}: ${r}`);g(d.Buffer,e.witnessScript,n+" requires witnessScript"),g(d.Buffer,e.redeemScript,n+" requires witnessScript"),g(l.Satoshi,e.witnessValue,n+" requires witnessScript")}}(e,i),({vin:b,keyPair:o,redeemScript:u,hashType:a,witnessValue:h,witnessScript:v}=i)}if(void 0===o)throw new Error("sign requires keypair");if(o.network&&o.network!==t)throw new TypeError("Inconsistent network");if(!e[b])throw new Error("No input at index: "+b);if(a=a||f.Transaction.SIGHASH_ALL,r(a))throw new Error("Transaction needs outputs");const E=e[b];if(void 0!==E.redeemScript&&u&&!E.redeemScript.equals(u))throw new Error("Inconsistent redeemScript");const P=o.publicKey||o.getPublicKey&&o.getPublicKey();if(!_(E)){if(void 0!==h){if(void 0!==E.value&&E.value!==h)throw new Error("Input did not match witnessValue");d(l.Satoshi,h),E.value=h}if(!_(E)){const t=function(t,e,r,n){if(r&&n){const i=p.p2wsh({redeem:{output:n}}),s=p.p2wsh({output:r}),o=p.p2sh({redeem:{output:r}}),u=p.p2sh({redeem:i});if(!i.hash.equals(s.hash))throw new Error("Witness script inconsistent with prevOutScript");if(!o.hash.equals(u.hash))throw new Error("Redeem script inconsistent with prevOutScript");const a=m(i.redeem.output,e);if(!a.pubkeys)throw new Error(a.type+" not supported as witnessScript ("+c.toASM(n)+")");t.signatures&&t.signatures.some(t=>void 0!==t)&&(a.signatures=t.signatures);const h=n;if(a.type===y.P2WPKH)throw new Error("P2SH(P2WSH(P2WPKH)) is a consensus failure");return{redeemScript:r,redeemScriptType:y.P2WSH,witnessScript:n,witnessScriptType:a.type,prevOutType:y.P2SH,prevOutScript:o.output,hasWitness:!0,signScript:h,signType:a.type,pubkeys:a.pubkeys,signatures:a.signatures,maxSignatures:a.maxSignatures}}if(r){const n=p.p2sh({redeem:{output:r}});if(t.prevOutScript){let e;try{e=p.p2sh({output:t.prevOutScript})}catch(s){throw new Error("PrevOutScript must be P2SH")}if(!n.hash.equals(e.hash))throw new Error("Redeem script inconsistent with prevOutScript")}const i=m(n.redeem.output,e);if(!i.pubkeys)throw new Error(i.type+" not supported as redeemScript ("+c.toASM(r)+")");t.signatures&&t.signatures.some(t=>void 0!==t)&&(i.signatures=t.signatures);let o=r;return i.type===y.P2WPKH&&(o=p.p2pkh({pubkey:i.pubkeys[0]}).output),{redeemScript:r,redeemScriptType:i.type,prevOutType:y.P2SH,prevOutScript:n.output,hasWitness:i.type===y.P2WPKH,signScript:o,signType:i.type,pubkeys:i.pubkeys,signatures:i.signatures,maxSignatures:i.maxSignatures}}if(n){const r=p.p2wsh({redeem:{output:n}});if(t.prevOutScript){const e=p.p2wsh({output:t.prevOutScript});if(!r.hash.equals(e.hash))throw new Error("Witness script inconsistent with prevOutScript")}const i=m(r.redeem.output,e);if(!i.pubkeys)throw new Error(i.type+" not supported as witnessScript ("+c.toASM(n)+")");t.signatures&&t.signatures.some(t=>void 0!==t)&&(i.signatures=t.signatures);const s=n;if(i.type===y.P2WPKH)throw new Error("P2WSH(P2WPKH) is a consensus failure");return{witnessScript:n,witnessScriptType:i.type,prevOutType:y.P2WSH,prevOutScript:r.output,hasWitness:!0,signScript:s,signType:i.type,pubkeys:i.pubkeys,signatures:i.signatures,maxSignatures:i.maxSignatures}}if(t.prevOutType&&t.prevOutScript){if(t.prevOutType===y.P2SH)throw new Error("PrevOutScript is "+t.prevOutType+", requires redeemScript");if(t.prevOutType===y.P2WSH)throw new Error("PrevOutScript is "+t.prevOutType+", requires witnessScript");if(!t.prevOutScript)throw new Error("PrevOutScript is missing");const r=m(t.prevOutScript,e);if(!r.pubkeys)throw new Error(r.type+" not supported ("+c.toASM(t.prevOutScript)+")");t.signatures&&t.signatures.some(t=>void 0!==t)&&(r.signatures=t.signatures);let n=t.prevOutScript;return r.type===y.P2WPKH&&(n=p.p2pkh({pubkey:r.pubkeys[0]}).output),{prevOutType:r.type,prevOutScript:t.prevOutScript,hasWitness:r.type===y.P2WPKH,signScript:n,signType:r.type,pubkeys:r.pubkeys,signatures:r.signatures,maxSignatures:r.maxSignatures}}const i=p.p2pkh({pubkey:e}).output;return{prevOutType:y.P2PKH,prevOutScript:i,hasWitness:!1,signScript:i,signType:y.P2PKH,pubkeys:[e],signatures:[void 0]}}(E,P,u,v);Object.assign(E,t)}if(!_(E))throw Error(E.prevOutType+" not supported")}let O;O=s.btg?n.hashForGoldSignature(b,E.signScript,E.value,a,!!E.witness):s.bch?n.hashForCashSignature(b,E.signScript,E.value,a):E.hasWitness?n.hashForWitnessV0(b,E.signScript,E.value,a):n.hashForSignature(b,E.signScript,a);return{input:E,ourPubKey:P,keyPair:o,signatureHash:O,hashType:a,useLowR:!!S}}(this.network,this.__INPUTS,this.__needsOutputs.bind(this),this.__TX,t,{btg:this.__BITCOINGOLD,bch:this.__BITCOINCASH},e,r,n,i,s,this.__USE_LOW_R))}__addInputUnsafe(t,e,r){if(f.Transaction.isCoinbaseHash(t))throw new Error("coinbase inputs not supported");const n=t.toString("hex")+":"+e;if(void 0!==this.__PREV_TX_SET[n])throw new Error("Duplicate TxOut: "+n);let i={};if(void 0!==r.script&&(i=function t(e,r,n,i){if(0===e.length&&0===r.length)return{};if(!n){let t=s.input(e,!0),i=s.witness(r,!0);t===y.NONSTANDARD&&(t=void 0),i===y.NONSTANDARD&&(i=void 0),n=t||i}switch(n){case y.P2WPKH:{const{output:t,pubkey:e,signature:n}=p.p2wpkh({witness:r});return{prevOutScript:t,prevOutType:y.P2WPKH,pubkeys:[e],signatures:[n]}}case y.P2PKH:{const{output:t,pubkey:r,signature:n}=p.p2pkh({input:e});return{prevOutScript:t,prevOutType:y.P2PKH,pubkeys:[r],signatures:[n]}}case y.P2PK:{const{signature:t}=p.p2pk({input:e});return{prevOutType:y.P2PK,pubkeys:[void 0],signatures:[t]}}case y.P2MS:{const{m:t,pubkeys:r,signatures:n}=p.p2ms({input:e,output:i},{allowIncomplete:!0});return{prevOutType:y.P2MS,pubkeys:r,signatures:n,maxSignatures:t}}}if(n===y.P2SH){const{output:n,redeem:i}=p.p2sh({input:e,witness:r}),o=s.output(i.output),u=t(i.input,i.witness,o,i.output);return u.prevOutType?{prevOutScript:n,prevOutType:y.P2SH,redeemScript:i.output,redeemScriptType:u.prevOutType,witnessScript:u.witnessScript,witnessScriptType:u.witnessScriptType,pubkeys:u.pubkeys,signatures:u.signatures}:{}}if(n===y.P2WSH){const{output:n,redeem:i}=p.p2wsh({input:e,witness:r}),o=s.output(i.output);let u;return u=o===y.P2WPKH?t(i.input,i.witness,o):t(c.compile(i.witness),[],o,i.output),u.prevOutType?{prevOutScript:n,prevOutType:y.P2WSH,witnessScript:i.output,witnessScriptType:u.prevOutType,pubkeys:u.pubkeys,signatures:u.signatures}:{}}return{prevOutType:y.NONSTANDARD,prevOutScript:e}}(r.script,r.witness||[])),void 0!==r.value&&(i.value=r.value),!i.prevOutScript&&r.prevOutScript){let t;if(!i.pubkeys&&!i.signatures){const e=m(r.prevOutScript);e.pubkeys&&(i.pubkeys=e.pubkeys,i.signatures=e.signatures),t=e.type}i.prevOutScript=r.prevOutScript,i.prevOutType=t||s.output(r.prevOutScript)}const o=this.__TX.addInput(t,e,r.sequence,r.scriptSig);return this.__INPUTS[o]=i,this.__PREV_TX_SET[n]=!0,o}__build(t){if(!t){if(!this.__TX.ins.length)throw new Error("Transaction has no inputs");if(!this.__TX.outs.length)throw new Error("Transaction has no outputs")}const e=this.__TX.clone();if(this.__INPUTS.forEach((r,n)=>{if(!r.prevOutType&&!t)throw new Error("Transaction is not complete");const i=function t(e,r,n){const i=r.pubkeys||[];let s=r.signatures||[];switch(e){case y.P2PKH:if(0===i.length)break;if(0===s.length)break;return p.p2pkh({pubkey:i[0],signature:s[0]});case y.P2WPKH:if(0===i.length)break;if(0===s.length)break;return p.p2wpkh({pubkey:i[0],signature:s[0]});case y.P2PK:if(0===i.length)break;if(0===s.length)break;return p.p2pk({signature:s[0]});case y.P2MS:{const t=r.maxSignatures;s=n?s.map(t=>t||h.OPS.OP_0):s.filter(t=>t);const e=!n||t===s.length;return p.p2ms({m:t,pubkeys:i,signatures:s},{allowIncomplete:n,validate:e})}case y.P2SH:{const e=t(r.redeemScriptType,r,n);if(!e)return;return p.p2sh({redeem:{output:e.output||r.redeemScript,input:e.input,witness:e.witness}})}case y.P2WSH:{const e=t(r.witnessScriptType,r,n);if(!e)return;return p.p2wsh({redeem:{output:r.witnessScript,input:e.input,witness:e.witness}})}}}(r.prevOutType,r,t);if(i)e.setInputScript(n,i.input),e.setWitness(n,i.witness);else{if(!t&&r.prevOutType===y.NONSTANDARD)throw new Error("Unknown input type");if(!t)throw new Error("Not enough information")}}),!t&&this.__overMaximumFees(e.virtualSize()))throw new Error("Transaction has absurd fees");return e}__canModifyInputs(){return this.__INPUTS.every(t=>!t.signatures||t.signatures.every(t=>{if(!t)return!0;return 0!==(S(t)&f.Transaction.SIGHASH_ANYONECANPAY)}))}__needsOutputs(t){return t===f.Transaction.SIGHASH_ALL?0===this.__TX.outs.length:0===this.__TX.outs.length&&this.__INPUTS.some(t=>!!t.signatures&&t.signatures.some(t=>{if(!t)return!1;return!(S(t)&f.Transaction.SIGHASH_NONE)}))}__canModifyOutputs(){const t=this.__TX.ins.length,e=this.__TX.outs.length;return this.__INPUTS.every(r=>void 0===r.signatures||r.signatures.every(r=>{if(!r)return!0;const n=31&S(r);return n===f.Transaction.SIGHASH_NONE||n===f.Transaction.SIGHASH_SINGLE&&t<=e}))}__overMaximumFees(t){return(this.__INPUTS.reduce((t,e)=>t+(e.value>>>0),0)-this.__TX.outs.reduce((t,e)=>t+e.value,0))/t>this.maximumFeeRate}}function m(t,e){d(l.Buffer,t);const r=s.output(t);switch(r){case y.P2PKH:{if(!e)return{type:r};const n=p.p2pkh({output:t}).hash,i=o.hash160(e);return n.equals(i)?{type:r,pubkeys:[e],signatures:[void 0]}:{type:r}}case y.P2WPKH:{if(!e)return{type:r};const n=p.p2wpkh({output:t}).hash,i=o.hash160(e);return n.equals(i)?{type:r,pubkeys:[e],signatures:[void 0]}:{type:r}}case y.P2PK:return{type:r,pubkeys:[p.p2pk({output:t}).pubkey],signatures:[void 0]};case y.P2MS:{const e=p.p2ms({output:t});return{type:r,pubkeys:e.pubkeys,signatures:e.pubkeys.map(()=>{}),maxSignatures:e.m}}}return{type:r}}function _(t){return void 0!==t.signScript&&void 0!==t.signType&&void 0!==t.pubkeys&&void 0!==t.signatures&&t.signatures.length===t.pubkeys.length&&t.pubkeys.length>0&&(!1===t.hasWitness||void 0!==t.value)}function S(t){return t.readUInt8(t.length-1)}e.TransactionBuilder=v}).call(this,r(19).Buffer)},3969:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(3060),i=r(3443),s=r(3972),o=r(3444),u=r(3445),a=r(3977),p=r(3980),c=r(3982),h=r(3984),f={P2MS:"multisig",NONSTANDARD:"nonstandard",NULLDATA:"nulldata",P2PK:"pubkey",P2PKH:"pubkeyhash",P2SH:"scripthash",P2WPKH:"witnesspubkeyhash",P2WSH:"witnessscripthash",WITNESS_COMMITMENT:"witnesscommitment"};e.types=f,e.output=function(t){if(c.output.check(t))return f.P2WPKH;if(h.output.check(t))return f.P2WSH;if(u.output.check(t))return f.P2PKH;if(a.output.check(t))return f.P2SH;const e=n.decompile(t);if(!e)throw new TypeError("Invalid script");return i.output.check(e)?f.P2MS:o.output.check(e)?f.P2PK:p.output.check(e)?f.WITNESS_COMMITMENT:s.output.check(e)?f.NULLDATA:f.NONSTANDARD},e.input=function(t,e){const r=n.decompile(t);if(!r)throw new TypeError("Invalid script");return u.input.check(r)?f.P2PKH:a.input.check(r,e)?f.P2SH:i.input.check(r,e)?f.P2MS:o.input.check(r)?f.P2PK:f.NONSTANDARD},e.witness=function(t,e){const r=n.decompile(t);if(!r)throw new TypeError("Invalid script");return c.input.check(r)?f.P2WPKH:h.input.check(r,e)?f.P2WSH:f.NONSTANDARD}},3970:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(3060),i=r(3060);function s(t){return t===i.OPS.OP_0||n.isCanonicalScriptSignature(t)}function o(t,e){const r=n.decompile(t);return!(r.length<2)&&(r[0]===i.OPS.OP_0&&(e?r.slice(1).every(s):r.slice(1).every(n.isCanonicalScriptSignature)))}e.check=o,o.toJSON=()=>"multisig input"},3971:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(3060),i=r(3060),s=r(3140),o=i.OPS.OP_RESERVED;function u(t,e){const r=n.decompile(t);if(r.length<4)return!1;if(r[r.length-1]!==i.OPS.OP_CHECKMULTISIG)return!1;if(!s.Number(r[0]))return!1;if(!s.Number(r[r.length-2]))return!1;const u=r[0]-o,a=r[r.length-2]-o;if(u<=0)return!1;if(a>16)return!1;if(u>a)return!1;if(a!==r.length-3)return!1;if(e)return!0;return r.slice(1,-2).every(n.isCanonicalPubKey)}e.check=u,u.toJSON=()=>"multi-sig output"},3972:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(3060),i=n.OPS;function s(t){const e=n.compile(t);return e.length>1&&e[0]===i.OP_RETURN}e.check=s,s.toJSON=()=>"null data output";const o={check:s};e.output=o},3973:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(3060);function i(t){const e=n.decompile(t);return 1===e.length&&n.isCanonicalScriptSignature(e[0])}e.check=i,i.toJSON=()=>"pubKey input"},3974:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(3060),i=r(3060);function s(t){const e=n.decompile(t);return 2===e.length&&n.isCanonicalPubKey(e[0])&&e[1]===i.OPS.OP_CHECKSIG}e.check=s,s.toJSON=()=>"pubKey output"},3975:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(3060);function i(t){const e=n.decompile(t);return 2===e.length&&n.isCanonicalScriptSignature(e[0])&&n.isCanonicalPubKey(e[1])}e.check=i,i.toJSON=()=>"pubKeyHash input"},3976:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(3060),i=r(3060);function s(t){const e=n.compile(t);return 25===e.length&&e[0]===i.OPS.OP_DUP&&e[1]===i.OPS.OP_HASH160&&20===e[2]&&e[23]===i.OPS.OP_EQUALVERIFY&&e[24]===i.OPS.OP_CHECKSIG}e.check=s,s.toJSON=()=>"pubKeyHash output"},3977:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(3978);e.input=n;const i=r(3979);e.output=i},3978:function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});const n=r(3060),i=r(3443),s=r(3444),o=r(3445),u=r(3609),a=r(3610);function p(e,r){const p=n.decompile(e);if(p.length<1)return!1;const c=p[p.length-1];if(!t.isBuffer(c))return!1;const h=n.decompile(n.compile(p.slice(0,-1))),f=n.decompile(c);return!!f&&(!!n.isPushOnly(h)&&(1===p.length?a.check(f)||u.check(f):!(!o.input.check(h)||!o.output.check(f))||(!(!i.input.check(h,r)||!i.output.check(f))||!(!s.input.check(h)||!s.output.check(f)))))}e.check=p,p.toJSON=()=>"scriptHash input"}).call(this,r(19).Buffer)},3979:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(3060),i=r(3060);function s(t){const e=n.compile(t);return 23===e.length&&e[0]===i.OPS.OP_HASH160&&20===e[1]&&e[22]===i.OPS.OP_EQUAL}e.check=s,s.toJSON=()=>"scriptHash output"},3980:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(3981);e.output=n},3981:function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});const n=r(3060),i=r(3060),s=r(3140),o=r(2066),u=t.from("aa21a9ed","hex");function a(t){const e=n.compile(t);return e.length>37&&e[0]===i.OPS.OP_RETURN&&36===e[1]&&e.slice(2,6).equals(u)}e.check=a,a.toJSON=()=>"Witness commitment output",e.encode=function(e){o(s.Hash256bit,e);const r=t.allocUnsafe(36);return u.copy(r,0),e.copy(r,4),n.compile([i.OPS.OP_RETURN,r])},e.decode=function(t){return o(a,t),n.decompile(t)[1].slice(4,36)}}).call(this,r(19).Buffer)},3982:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(3983);e.input=n;const i=r(3609);e.output=i},3983:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(3060);function i(t){const e=n.decompile(t);return 2===e.length&&n.isCanonicalScriptSignature(e[0])&&(r=e[1],n.isCanonicalPubKey(r)&&33===r.length);var r}e.check=i,i.toJSON=()=>"witnessPubKeyHash input"},3984:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(3985);e.input=n;const i=r(3610);e.output=i},3985:function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});const n=r(3060),i=r(2066),s=r(3443),o=r(3444),u=r(3445);function a(e,r){if(i(i.Array,e),e.length<1)return!1;const a=e[e.length-1];if(!t.isBuffer(a))return!1;const p=n.decompile(a);if(!p||0===p.length)return!1;const c=n.compile(e.slice(0,-1));return!(!u.input.check(c)||!u.output.check(p))||(!(!s.input.check(c,r)||!s.output.check(p))||!(!o.input.check(c)||!o.output.check(p)))}e.check=a,a.toJSON=()=>"witnessScriptHash input"}).call(this,r(19).Buffer)}}]);