(this.webpackJsonp=this.webpackJsonp||[]).push([[55],{3050:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(6),i=n.n(r),o=n(9),a=n.n(o),c=n(12),u=n.n(c),s=n(5),d=n.n(s);function l(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d()(e);if(t){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u()(this,n)}}var f=function(e){a()(n,e);var t=l(n);function n(e){var n;return(n=t.call(this,e.options)).vault=e,n}return i()(n)}(n(1108).a);!function(e){a()(n,e);var t=l(n);function n(){return t.apply(this,arguments)}i()(n)}(f)},3055:function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var r=n(10),i=n.n(r),o=n(2),a=n.n(o),c=n(3),u=n.n(c),s=n(6),d=n.n(s),l=n(9),f=n.n(l),p=n(12),y=n.n(p),h=n(5),v=n.n(h),g=n(22),w=n(21);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function T(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}var O=function(e){f()(n,e);var t=T(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.signTransaction=function(){var e=u()((function*(e,t){var n=t.password;if("undefined"===typeof n)throw new w.p("Software signing requires a password.");var r=yield this.getSigners(n,e.inputs.map((function(e){return e.address})));return g.a.engine.info("signTransaction",this.networkId,e),b(b({},yield this.engine.providerManager.signTransaction(this.networkId,e,r)),{},{encodedTx:e.encodedTx})}));return function(t,n){return e.apply(this,arguments)}}(),r.signMessage=function(){var e=u()((function*(e,t){var n=this,r=t.password;if("undefined"===typeof r)throw new w.p("Software signing requires a password.");var o=yield this.getDbAccount(),a=Object.values(yield this.getSigners(r,[o.address])),c=i()(a,1)[0];return g.a.engine.info("signMessage",this.networkId,e),Promise.all(e.map((function(e){return n.engine.providerManager.signMessage(n.networkId,e,c)})))}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},d()(n)}(n(3050).a)},3068:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(44),i=n(72),o=n(22),a=n(15);function c(e,t){return"string"!==typeof t?null:e===r.HardwareErrorCode.DeviceInitializeFailed&&t.includes("ECONNABORTED")?new i.g({message:t}):t.includes("Bridge network error")?new i.e({message:t}):null}function u(e){var t,n=e||{},u=n.code,s=n.error,d=n.message,l=null!=(t=null!=s?s:d)?t:"Unknown error";if(c(u,l))return c(u,l);switch(o.a.hardwareSDK.info("Device Utils Convert Device Error:",u,l),u){case r.HardwareErrorCode.UnknownError:return new i.F(e);case r.HardwareErrorCode.DeviceFwException:return new i.s(e);case r.HardwareErrorCode.DeviceUnexpectedMode:return"string"===typeof l&&-1!==l.indexOf("ui-device_bootloader_mode")?new i.C(e):new i.F(e);case r.HardwareErrorCode.DeviceCheckDeviceIdError:return new i.l(e);case r.HardwareErrorCode.DeviceNotFound:return new i.j(e);case r.HardwareErrorCode.DeviceUnexpectedBootloaderMode:return new i.C(e);case r.HardwareErrorCode.DeviceInterruptedFromOutside:case r.HardwareErrorCode.DeviceInterruptedFromUser:return new i.I(e);case r.HardwareErrorCode.DeviceNotSupportPassphrase:return new i.D(e);case r.HardwareErrorCode.IFrameLoadFail:return new i.t(e);case r.HardwareErrorCode.IframeTimeout:return new i.u(e);case r.HardwareErrorCode.FirmwareUpdateDownloadFailed:return new i.o(e);case r.HardwareErrorCode.FirmwareUpdateManuallyEnterBoot:return new i.r(e);case r.HardwareErrorCode.FirmwareUpdateAutoEnterBootFailure:return new i.p(e);case r.HardwareErrorCode.FirmwareUpdateLimitOneDevice:return new i.q(e);case r.HardwareErrorCode.CallMethodNeedUpgradeFirmware:return new i.s(e);case r.HardwareErrorCode.NewFirmwareUnRelease:return new i.B(e);case r.HardwareErrorCode.NetworkError:return new i.A(e);case r.HardwareErrorCode.BlePermissionError:return new i.y(e);case r.HardwareErrorCode.BleLocationError:return new i.x({message:l});case r.HardwareErrorCode.BleLocationServicesDisabled:return new i.b({message:l});case r.HardwareErrorCode.BleDeviceNotBonded:return new i.i(e);case r.HardwareErrorCode.BleWriteCharacteristicError:return new i.d(e);case r.HardwareErrorCode.BleScanError:return new i.c({message:l});case r.HardwareErrorCode.BleAlreadyConnected:return new i.a(e);case r.HardwareErrorCode.RuntimeError:return-1!==l.indexOf("EIP712 blind sign is disabled")?new i.E(e):-1!==l.indexOf("Unknown message")||-1!==l.indexOf("Failure_UnexpectedMessage")?new i.G(e):new i.F(e);case r.HardwareErrorCode.PinInvalid:return new i.v(e);case r.HardwareErrorCode.DeviceCheckPassphraseStateError:return new i.w(e);case r.HardwareErrorCode.DeviceOpenedPassphrase:return new i.m(e);case r.HardwareErrorCode.DeviceNotOpenedPassphrase:return new i.k(e);case r.HardwareErrorCode.PinCancelled:case r.HardwareErrorCode.ActionCancelled:return new i.H(e);case r.HardwareErrorCode.BridgeNotInstalled:case i.h.NeedOneKeyBridge:return new i.z(e);case r.HardwareErrorCode.BridgeNetworkError:return new i.e(e);case r.HardwareErrorCode.BridgeTimeoutError:return a.a.isDesktop&&(o.a.hardwareSDK.debug("desktop bridge timeout, restart desktop bridge."),window.desktopApi.reloadBridgeProcess()),new i.f(e);case r.HardwareErrorCode.PollingTimeout:return new i.g(e);case r.HardwareErrorCode.BlindSignDisabled:return new i.E(e);default:return new i.F(e)}}},3069:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return C}));var r=n(2),i=n.n(r),o=n(143),a=n.n(o),c=n(3),u=n.n(c),s=n(6),d=n.n(s),l=n(9),f=n.n(l),p=n(12),y=n.n(p),h=n(5),v=n.n(h),g=n(27),w=n.n(g),m=n(14),b=n(22),T=n(15),O=n(54),A=n(21),P=n(647),x=n(57),E=n(1108);function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}if(T.a.isExtensionUi)throw new Error("engine/VaultBase is not allowed imported from ui");var C=function(t){f()(r,t);var n=S(r);function r(){return n.apply(this,arguments)}var i=r.prototype;return i.init=function(){var e=u()((function*(e){yield this.initProvider(),yield this.initKeyring(e)}));return function(t){return e.apply(this,arguments)}}(),i.initKeyring=function(){var e=u()((function*(e){this.keyring=yield e.keyringCreator(this)}));return function(t){return e.apply(this,arguments)}}(),i.signTransaction=function(){var e=u()((function*(e,t){return this.keyring.signTransaction(e,t)}));return function(t,n){return e.apply(this,arguments)}}(),i.signAndSendTransaction=function(){var e=u()((function*(e,t,n){var r=yield this.signTransaction(e,t);return n?k(k({},r),{},{encodedTx:e.encodedTx}):this.broadcastTransaction(k(k({},r),{},{encodedTx:e.encodedTx}))}));return function(t,n,r){return e.apply(this,arguments)}}(),i.broadcastTransaction=function(){var e=u()((function*(e,t){b.a.engine.info("broadcastTransaction START:",{rawTx:e.rawTx});var n=yield this.engine.providerManager.broadcastTransaction(this.networkId,e.rawTx,t);return b.a.engine.info("broadcastTransaction END:",{txid:n,rawTx:e.rawTx}),k(k({},e),{},{txid:n,encodedTx:e.encodedTx})}));return function(t,n){return e.apply(this,arguments)}}(),i.buildEncodedTxFromBatchTransfer=function(){var e=u()((function*(e,t){throw new A.k}));return function(t,n){return e.apply(this,arguments)}}(),i.buildEncodedTxsFromSetApproveForAll=function(){var e=u()((function*(e,t){throw new A.k}));return function(t,n){return e.apply(this,arguments)}}(),i.activateAccount=function(){var e=u()((function*(){throw new A.k}));return function(){return e.apply(this,arguments)}}(),i.activateToken=function(){var e=u()((function*(e,t){throw new A.k}));return function(t,n){return e.apply(this,arguments)}}(),i.getTokenAllowance=function(){var e=u()((function*(e,t){throw new A.k}));return function(t,n){return e.apply(this,arguments)}}(),i.batchTokensAllowance=function(){var e=u()((function*(e,t){throw new A.k}));return function(t,n){return e.apply(this,arguments)}}(),i.getOutputAccount=function(){var e=u()((function*(){var e=yield this.getDbAccount({noCache:!0});return{id:e.id,name:e.name,type:e.type,path:e.path,coinType:e.coinType,tokens:[],address:e.address}}));return function(){return e.apply(this,arguments)}}(),i.getAccountBalance=function(){var e=u()((function*(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=yield this.getDbAccount(),r=n.address;return this.getBalances((t?[{address:r}]:[]).concat(e.map((function(e){return{address:r,tokenAddress:e}}))))}));return function(t){return e.apply(this,arguments)}}(),i.updatePendingTxs=function(){var e=u()((function*(e){throw new A.k}));return function(t){return e.apply(this,arguments)}}(),i.getAccountNonce=function(){var e=u()((function*(){return Promise.resolve(null)}));return function(){return e.apply(this,arguments)}}(),i.fixActionDirection=function(){var e=u()((function*(e){var t,n,r,i,o=e.action,a=e.accountAddress;(o.direction=x.b.OTHER,o.type===x.a.NATIVE_TRANSFER)&&(o.direction=yield this.buildTxActionDirection({from:(null==(t=o.nativeTransfer)?void 0:t.from)||"",to:(null==(n=o.nativeTransfer)?void 0:n.to)||"",address:a}));o.type===x.a.TOKEN_TRANSFER&&(o.direction=yield this.buildTxActionDirection({from:(null==(r=o.tokenTransfer)?void 0:r.from)||"",to:(null==(i=o.tokenTransfer)?void 0:i.to)||"",address:a}));return o}));return function(t){return e.apply(this,arguments)}}(),i.fixDecodedTx=function(){var e=u()((function*(e){var t,n;e.createdAt=null!=(t=e.createdAt)?t:Date.now();var r=null==(n=e.encodedTx)?void 0:n.nonce;e.nonce=a()(r)?e.nonce:new w.a(r).toNumber();for(var i=e.owner,o=0;o<e.actions.length;o+=1){var c=e.actions[o];yield this.fixActionDirection({action:c,accountAddress:i})}if(e.outputActions)for(var u=0;u<e.outputActions.length;u+=1){var s=e.outputActions[u];yield this.fixActionDirection({action:s,accountAddress:i})}return Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),i.fixHistoryTx=function(){var e=u()((function*(e){return e.decodedTx=yield this.fixDecodedTx(e.decodedTx),T.a.isDev&&T.a.isDesktop&&Object.assign(e,{_tmpCreatedAtText:new Date(e.decodedTx.createdAt||0).toLocaleString(),_tmpUpdatedAtText:new Date(e.decodedTx.updatedAt||0).toLocaleString(),_tmpStatus:e.decodedTx.status,_tmpIsFinal:e.decodedTx.isFinal}),Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),i.buildHistoryTx=function(){var e=u()((function*(e){var t=e.historyTxToMerge,n=(e.encodedTx,e.decodedTx),r=e.signedTx,i=e.isSigner,o=e.isLocalCreated,a=(null==r?void 0:r.txid)||(null==n?void 0:n.txid)||"";if(!a)throw new Error("buildHistoryTx txid not found");var c=yield this.getAccountAddress();n.txid=a||n.txid,n.owner=c,i&&(n.signer=c);var u=k(k({id:this.networkId+"_"+a+"_"+this.accountId,isLocalCreated:Boolean(o)},t),{},{decodedTx:n});return u=yield this.fixHistoryTx(u),Promise.resolve(u)}));return function(t){return e.apply(this,arguments)}}(),i.checkIsScamHistoryTx=function(){var e=u()((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),i.fetchOnChainHistory=function(){var e=u()((function*(e){throw new A.k}));return function(t){return e.apply(this,arguments)}}(),i.fixAddressCase=function(e){return Promise.resolve(e)},i.buildTxActionDirection=function(){var e=u()((function*(e){var t=e.from,n=e.to,r=e.address;return t=yield this.fixAddressCase(t||""),n=yield this.fixAddressCase(n),r=yield this.fixAddressCase(r),t===n&&t===r?x.b.SELF:t&&t===r?x.b.OUT:n&&n===r?x.b.IN:x.b.OTHER}));return function(t){return e.apply(this,arguments)}}(),i.getNextNonce=function(){var e=u()((function*(e,t){var n,r,i=null!=(n=null==(r=(yield this.engine.providerManager.getAddresses(e,[t.address]))[0])?void 0:r.nonce)?n:0,o=(yield this.engine.getHistory(e,t.id,void 0,!1),yield O.a.history.getMaxPendingNonce({accountId:this.accountId,networkId:e})),c=yield O.a.history.getPendingNonceList({accountId:this.accountId,networkId:e}),u=Math.max(a()(o)?0:o+1,i);if(Number.isNaN(u)&&(u=i),u>i)for(var s=i;s<u;s+=1)if(!c.includes(s)){u=s;break}if(u<i&&(u=i),u-i>=m.t.PENDING_QUEUE_MAX_LENGTH)throw new A.u(m.t.PENDING_QUEUE_MAX_LENGTH);return u}));return function(t,n){return e.apply(this,arguments)}}(),i.validateSendAmount=function(e,t,n){return Promise.resolve(!0)},i.notifyChainChanged=function(e,t){},i.getFetchBalanceAddress=function(e){return Promise.resolve(e.address)},i.getPrivateKeyByCredential=function(t){return e.from(t.startsWith("0x")?t.slice(2):t,"hex")},d()(r)}(function(e){f()(n,e);var t=S(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.initProvider=function(){var e=u()((function*(){var e=(yield this.getNetwork()).impl;a()(P.a[e])||(this.engineProvider=yield this.engine.providerManager.getProvider(this.networkId))}));return function(){return e.apply(this,arguments)}}(),r.proxyJsonRPCCall=function(){var e=u()((function*(e){throw new A.k}));return function(t){return e.apply(this,arguments)}}(),r.createClientFromURL=function(e){throw new A.k},r.getEthersProvider=function(){var e=u()((function*(){throw new A.k}));return function(){return e.apply(this,arguments)}}(),r.getClientEndpointStatus=function(){var e=u()((function*(e){var t=this.createClientFromURL(e),n=performance.now(),r=(yield t.getInfo()).bestBlockNumber;return{responseTime:Math.floor(performance.now()-n),latestBlock:r}}));return function(t){return e.apply(this,arguments)}}(),r.validateAddress=function(){var e=u()((function*(e){var t=yield this.engineProvider.verifyAddress(e),n=t.normalizedAddress;if(!t.isValid||"undefined"===typeof n)throw new A.e;return Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),r.validateImportedCredential=function(e){return Promise.resolve(this.settings.importedAccountEnabled&&/^(0x)?[0-9a-zA-Z]{64}$/.test(e))},r.validateWatchingCredential=function(){var e=u()((function*(e){return Promise.resolve(this.settings.watchingAccountEnabled&&(yield this.engineProvider.verifyAddress(e)).isValid)}));return function(t){return e.apply(this,arguments)}}(),r.validateTokenAddress=function(){var e=u()((function*(e){var t=yield this.engineProvider.verifyTokenAddress(e),n=t.normalizedAddress;if(!t.isValid||"undefined"===typeof n)throw new A.h;return Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),r.checkAccountExistence=function(){var e=u()((function*(e){return Promise.resolve(!0)}));return function(t){return e.apply(this,arguments)}}(),r.getBalances=function(){var e=u()((function*(e){return(yield this.engine.providerManager.getClient(this.networkId)).getBalances(e.map((function(e){var t=e.address,n=e.tokenAddress;return{address:t,coin:k({},"string"===typeof n?{tokenAddress:n}:{})}})))}));return function(t){return e.apply(this,arguments)}}(),r.getFrozenBalance=function(){var e=u()((function*(){return 0}));return function(){return e.apply(this,arguments)}}(),r.getTransactionStatuses=function(e){return this.engine.providerManager.getTransactionStatuses(this.networkId,e)},r.getTransactionFeeInNative=function(e){return Promise.resolve("")},r.isContractAddress=function(){var e=u()((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),d()(n)}(E.a))}).call(this,n(19).Buffer)},3070:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return h}));var r=n(3),i=n.n(r),o=n(6),a=n.n(o),c=n(9),u=n.n(c),s=n(12),d=n.n(s),l=n(5),f=n.n(l),p=n(299);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var i=f()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d()(this,n)}}var h=function(t){u()(r,t);var n=y(r);function r(){return n.apply(this,arguments)}var o=r.prototype;return o.getHardwareInfo=function(){var e=i()((function*(){var e,t,n=yield this.engine.getHWDeviceByWalletId(this.vault.walletId);return{connectId:null!=(e=null==n?void 0:n.mac)?e:"",deviceId:null!=(t=null==n?void 0:n.deviceId)?t:""}}));return function(){return e.apply(this,arguments)}}(),o.getWalletPassphraseState=function(){var e=i()((function*(){var e=yield this.engine.getWallet(this.vault.walletId);return{passphraseState:null==e?void 0:e.passphraseState}}));return function(){return e.apply(this,arguments)}}(),o.getHardwareSDKInstance=function(){var t=i()((function*(){var t,n,r,i,o;return null!=(o=yield null==(t=e)||null==(n=t.$backgroundApiProxy)||null==(r=n.backgroundApi)||null==(i=r.serviceHardware)||null==i.getSDKInstance?void 0:i.getSDKInstance())?o:p.b}));return function(){return t.apply(this,arguments)}}(),a()(r)}(n(3050).a)}).call(this,n(40))},3071:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(2),i=n.n(r),o=n(3),a=n.n(o),c=n(6),u=n.n(c),s=n(9),d=n.n(s),l=n(12),f=n.n(l),p=n(5),y=n.n(p),h=n(297),v=n(21);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var i=y()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var b=function(e){d()(n,e);var t=m(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.getPrivateKeys=function(){var e=a()((function*(e,t){var n=(yield this.getDbAccount()).path.split("/"),r=t||[n.pop()],i=n.join("/"),o=(yield this.engine.dbApi.getCredential(this.walletId,e)).seed;if("undefined"===typeof o)throw new v.p("Unable to get credential.");var a=(yield this.engine.providerManager.getChainInfoByNetworkId(this.networkId)).curve;return Object(h.c)(a,o,e,i,r).reduce((function(e,t){var n;return w(w({},e),{},((n={})[t.path]=t.extendedKey.key,n))}),{})}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},u()(n)}(n(3055).a)},3072:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(3),i=n.n(r),o=n(6),a=n.n(o),c=n(9),u=n.n(c),s=n(12),d=n.n(s),l=n(5),f=n.n(l),p=n(21);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var i=f()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d()(this,n)}}var h=function(e){u()(n,e);var t=y(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.getPrivateKeys=function(){var e=i()((function*(e,t){if("undefined"!==typeof t)throw new p.k("Getting private keys from extended private key");var n=(yield this.engine.dbApi.getCredential(this.accountId,e)).privateKey;if("undefined"===typeof n)throw new p.p("Unable to get credential.");return{"":n}}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},a()(n)}(n(3055).a)},3073:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(3),i=n.n(r),o=n(6),a=n.n(o),c=n(9),u=n.n(c),s=n(12),d=n.n(s),l=n(5),f=n.n(l),p=n(21);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var i=f()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d()(this,n)}}var h=function(e){u()(n,e);var t=y(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.signTransaction=function(){var e=i()((function*(e,t){throw new p.p("signTransaction is not supported for watching accounts")}));return function(t,n){return e.apply(this,arguments)}}(),r.signMessage=function(){var e=i()((function*(e,t){throw new p.p("signMessage is not supported for watching accounts")}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},a()(n)}(n(3050).a)},3585:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return l}));var r=n(10),i=n.n(r),o=n(3),a=n.n(o),c=n(132),u=n.n(c);function s(e,t){return d.apply(this,arguments)}function d(){return(d=a()((function*(e,t){var n=e.payload,r=n.nativeTx,o=n.feePayer,a=yield t.sign(r.serializeMessage()),c=i()(a,1)[0];return r.addSignature(o,c),{txid:u.a.encode(c),rawTx:r.serialize({requireAllSignatures:!1}).toString("base64")}}))).apply(this,arguments)}function l(e,t){return f.apply(this,arguments)}function f(){return(f=a()((function*(t,n){var r=yield n.sign(e.from(t)),o=i()(r,1)[0];return u.a.encode(o)}))).apply(this,arguments)}}).call(this,n(19).Buffer)},3832:function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var r,i,o=n(10),a=n.n(o),c=n(2),u=n.n(c),s=n(3),d=n.n(s),l=n(6),f=n.n(l),p=n(9),y=n.n(p),h=n(12),v=n.n(h),g=n(5),w=n.n(g),m=n(27),b=n.n(m),T=n(158),O=n(405),A=n(113);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=w()(e);if(t){var i=w()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v()(this,n)}}!function(e){e.SEND_TRANSACTION="sendTransaction",e.GET_EPOCH_INFO="getEpochInfo",e.GET_HEALTH="getHealth",e.GET_ACCOUNT_INFO="getAccountInfo",e.GET_TOKEN_ACCOUNTS_BY_OWNER="getTokenAccountsByOwner",e.GET_FEES="getFees",e.GET_TRANSACTION="getTransaction"}(r||(r={})),function(e){e.BASE64="base64",e.JSON_PARSED="jsonParsed"}(i||(i={}));var I=function(e){y()(n,e);var t=E(n);function n(e){var n;return(n=t.call(this)).getTokenInfos=function(){var e=d()((function*(e){var t=e.map((function(e){return[r.GET_ACCOUNT_INFO,[e,{encoding:i.JSON_PARSED}]]})),o=yield n.rpc.batchCall(t),a=[];return o.forEach((function(t,n){if("undefined"!==typeof t)if(null!==t.value&&"mint"===t.value.data.parsed.type){var r=t.value.data.parsed.info.decimals,i=e[n].slice(0,4);a.push({name:i,symbol:i.toUpperCase(),decimals:r})}else a.push(void 0);else a.push(void 0)})),a}));return function(t){return e.apply(this,arguments)}}(),n.rpc=new O.a(e),n}var o=n.prototype;return o.broadcastTransaction=function(){var e=d()((function*(e,t){return this.rpc.call(r.SEND_TRANSACTION,[e,x({encoding:i.BASE64},t||{})])}));return function(t,n){return e.apply(this,arguments)}}(),o.getInfo=function(){var e=d()((function*(){var e=yield this.rpc.batchCall([[r.GET_EPOCH_INFO,[]],[r.GET_HEALTH,[]]]),t=a()(e,2),n=t[0],i=t[1];return{bestBlockNumber:n.absoluteSlot,isReady:"ok"===i}}));return function(){return e.apply(this,arguments)}}(),o.getAddresses=function(){var e=d()((function*(e){var t=e.map((function(e){return[r.GET_ACCOUNT_INFO,[e,{encoding:i.JSON_PARSED}]]})),n=yield this.rpc.batchCall(t),o=[];for(var a of n)if("undefined"!==typeof a){var c,u=new b.a(null==a||null==(c=a.value)?void 0:c.lamports),s=u.isFinite()&&u.gte(0);o.push({existing:s,balance:s?u:new b.a(0)})}else o.push(void 0);return o}));return function(t){return e.apply(this,arguments)}}(),o.getBalances=function(){var e=d()((function*(e){var t=e.map((function(e){var t;return null!=(t=e.coin)&&t.tokenAddress?[r.GET_TOKEN_ACCOUNTS_BY_OWNER,[e.address,{mint:e.coin.tokenAddress},{encoding:i.JSON_PARSED,commitment:"processed"}]]:[r.GET_ACCOUNT_INFO,[e.address,{encoding:i.JSON_PARSED,commitment:"processed"}]]})),n=yield this.rpc.batchCall(t),o=[];return n.forEach((function(t,n){if("undefined"!==typeof t){var r,i=new b.a(0);if(null!=(r=e[n].coin)&&r.tokenAddress)for(var a of t.value){var c=a.account.data.parsed.info;c.owner===e[n].address&&(i=b.a.sum(i,c.tokenAmount.amount))}else null!==t.value&&(i=new b.a(t.value.lamports));o.push(i)}else o.push(void 0)})),o}));return function(t){return e.apply(this,arguments)}}(),o.getAccountInfo=function(){var e=d()((function*(e){return(yield this.rpc.call(r.GET_ACCOUNT_INFO,[e,{encoding:i.JSON_PARSED}])).value}));return function(t){return e.apply(this,arguments)}}(),o.getFeePricePerUnit=function(){var e=d()((function*(){var e=yield this.getFees(),t=a()(e,1)[0];return{normal:{price:new b.a(t)}}}));return function(){return e.apply(this,arguments)}}(),o.getFees=function(){var e=d()((function*(){var e=yield this.rpc.call(r.GET_FEES);return[e.value.feeCalculator.lamportsPerSignature,e.value.blockhash]}));return function(){return e.apply(this,arguments)}}(),o.getTransactionStatuses=function(){var e=d()((function*(e){var t=e.map((function(e){return[r.GET_TRANSACTION,[e,i.JSON_PARSED]]})),n=[],o=yield this.rpc.batchCall(t);for(var a of o)"undefined"!==typeof a?null===a?n.push(A.a.NOT_FOUND):n.push(null===a.meta.err?A.a.CONFIRM_AND_SUCCESS:A.a.CONFIRM_BUT_FAILED):n.push(void 0);return n}));return function(t){return e.apply(this,arguments)}}(),f()(n)}(T.a)},3833:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return x}));var r=n(2),i=n.n(r),o=n(3),a=n.n(o),c=n(6),u=n.n(c),s=n(9),d=n.n(s),l=n(12),f=n.n(l),p=n(5),y=n.n(p),h=n(3068),v=n(14),g=n(22),w=n(21),m=n(111),b=n(3070);function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function A(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var i=y()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var P="m/44'/"+v.n+"'",x=function(t){d()(r,t);var n=A(r);function r(){return n.apply(this,arguments)}var i=r.prototype;return i.signTransaction=function(){var t=a()((function*(t,n){var r=yield this.getDbAccount(),i=yield this.getHardwareSDKInstance(),o=yield this.getHardwareInfo(),a=o.connectId,c=o.deviceId,u=yield this.getWalletPassphraseState(),s=t.payload,d=s.nativeTx,l=s.feePayer,f=yield i.solSignTransaction(a,c,O({path:r.path,rawTx:d.serializeMessage().toString("hex")},u));if(f.success&&f.payload.signature){var p=f.payload.signature;return d.addSignature(l,e.from(p,"hex")),{txid:p,rawTx:d.serialize({requireAllSignatures:!1}).toString("base64")}}throw Object(h.a)(f.payload)}));return function(e,n){return t.apply(this,arguments)}}(),i.signMessage=function(e,t){throw new w.k("Signing solana message is not supported yet.")},i.prepareAccounts=function(){var e=a()((function*(e){var t,n=this,r=e.indexes,i=e.names,o=r.map((function(e){return P+"/"+e+"'/0'"})),a=yield this.getHardwareSDKInstance(),c=yield this.getHardwareInfo(),u=c.connectId,s=c.deviceId,d=yield this.getWalletPassphraseState();try{t=yield a.solGetAddress(u,s,O({bundle:o.map((function(e){return{path:e,showOnOneKey:!1}}))},d))}catch(l){throw g.a.common.error(l),new w.o(l)}if(!t.success)throw g.a.common.error(t.payload),Object(h.a)(t.payload);return t.payload.map((function(e,t){var o=e.address,a=e.path;return{id:n.walletId+"--"+a,name:(i||[])[t]||"SOL #"+(r[t]+1),type:m.a.SIMPLE,path:a,coinType:v.n,pub:null!=o?o:"",address:null!=o?o:""}})).filter((function(e){return!!e.address}))}));return function(t){return e.apply(this,arguments)}}(),i.getAddress=function(){var e=a()((function*(e){var t,n=yield this.getHardwareSDKInstance(),r=yield this.getHardwareInfo(),i=r.connectId,o=r.deviceId,a=yield this.getWalletPassphraseState(),c=yield n.solGetAddress(i,o,O({path:e.path,showOnOneKey:e.showOnOneKey},a));if(c.success&&null!=(t=c.payload)&&t.address)return c.payload.address;throw Object(h.a)(c.payload)}));return function(t){return e.apply(this,arguments)}}(),u()(r)}(b.a)}).call(this,n(19).Buffer)},3834:function(e,t,n){"use strict";n.d(t,"a",(function(){return A}));var r=n(3),i=n.n(r),o=n(6),a=n.n(o),c=n(9),u=n.n(c),s=n(12),d=n.n(s),l=n(5),f=n.n(l),p=n(47),y=n(297),h=n(14),v=n(21),g=n(938),w=n(111),m=n(3071),b=n(3585);function T(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var i=f()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d()(this,n)}}var O="m/44'/"+h.n+"'",A=function(e){u()(n,e);var t=T(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.getSigners=function(){var e=i()((function*(e,t){var n,r=yield this.getDbAccount();if(1!==t.length)throw new v.p("SOL signers number should be 1.");if(t[0]!==r.address)throw new v.p("Wrong address required for signing");var i=(yield this.getPrivateKeys(e))[r.path];if("undefined"===typeof i)throw new v.p("Unable to get signer.");return(n={})[r.address]=new g.b(i,e,"ed25519"),n}));return function(t,n){return e.apply(this,arguments)}}(),r.prepareAccounts=function(){var e=i()((function*(e){var t=this,n=e.password,r=e.indexes,i=e.names,o=(yield this.engine.dbApi.getCredential(this.walletId,n)).seed,a=Object(y.d)("ed25519",o,n,O,r.map((function(e){return e+"'/0'"})));if(a.length!==r.length)throw new v.p("Unable to get public keys");return a.map((function(e,n){var o=e.path,a=e.extendedKey.key,c=new p.PublicKey(a).toBase58();return{id:t.walletId+"--"+o,name:(i||[])[n]||"SOL #"+(r[n]+1),type:w.a.SIMPLE,path:o,coinType:h.n,pub:c,address:c}}))}));return function(t){return e.apply(this,arguments)}}(),r.signTransaction=function(){var e=i()((function*(e,t){var n=yield this.getDbAccount(),r=(yield this.getSigners(t.password||"",[n.address]))[n.address];return Object(b.b)(e,r)}));return function(t,n){return e.apply(this,arguments)}}(),r.signMessage=function(){var e=i()((function*(e,t){var n=yield this.getDbAccount(),r=(yield this.getSigners(t.password||"",[n.address]))[n.address];return Promise.all(e.map((function(e){var t=e.message;return Object(b.a)(t,r)})))}));return function(t,n){return e.apply(this,arguments)}}(),a()(n)}(m.a)},3835:function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var r=n(3),i=n.n(r),o=n(6),a=n.n(o),c=n(9),u=n.n(c),s=n(12),d=n.n(s),l=n(5),f=n.n(l),p=n(47),y=n(427),h=n(14),v=n(21),g=n(938),w=n(111),m=n(3072),b=n(3585);function T(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var i=f()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d()(this,n)}}var O=function(e){u()(n,e);var t=T(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.prepareAccounts=function(){var e=i()((function*(e){var t=e.name,n=e.privateKey;if(32!==n.length)throw new v.p("Invalid private key.");var r=new p.PublicKey(y.a.publicFromPrivate(n)).toBase58();return Promise.resolve([{id:"imported--"+h.n+"--"+r,name:t||"",type:w.a.SIMPLE,path:"",coinType:h.n,pub:r,address:r}])}));return function(t){return e.apply(this,arguments)}}(),r.getSigners=function(){var e=i()((function*(e,t){var n,r=yield this.getDbAccount();if(1!==t.length)throw new v.p("SOL signers number should be 1.");if(t[0]!==r.address)throw new v.p("Wrong address required for signing.");var i=(yield this.getPrivateKeys(e))[r.path];if("undefined"===typeof i)throw new v.p("Unable to get signer.");return(n={})[r.address]=new g.b(i,e,"ed25519"),n}));return function(t,n){return e.apply(this,arguments)}}(),r.signTransaction=function(){var e=i()((function*(e,t){var n=yield this.getDbAccount(),r=(yield this.getSigners(t.password||"",[n.address]))[n.address];return Object(b.b)(e,r)}));return function(t,n){return e.apply(this,arguments)}}(),r.signMessage=function(){var e=i()((function*(e,t){var n=yield this.getDbAccount(),r=(yield this.getSigners(t.password||"",[n.address]))[n.address];return Promise.all(e.map((function(e){var t=e.message;return Object(b.a)(t,r)})))}));return function(t,n){return e.apply(this,arguments)}}(),a()(n)}(m.a)},3836:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(3),i=n.n(r),o=n(6),a=n.n(o),c=n(9),u=n.n(c),s=n(12),d=n.n(s),l=n(5),f=n.n(l),p=n(14),y=n(21),h=n(111);function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var i=f()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d()(this,n)}}var g=function(e){u()(n,e);var t=v(n);function n(){return t.apply(this,arguments)}return n.prototype.prepareAccounts=function(){var e=i()((function*(e){var t=e.name,n=e.target,r=yield this.engine.providerManager.verifyAddress(this.networkId,n),i=r.normalizedAddress;if(!r.isValid||"undefined"===typeof i)throw new y.e;return Promise.resolve([{id:"watching--"+p.n+"--"+n,name:t||"",type:h.a.SIMPLE,path:"",coinType:p.n,pub:i,address:i}])}));return function(t){return e.apply(this,arguments)}}(),a()(n)}(n(3073).a)},4432:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"default",(function(){return Z}));var r=n(460),i=n.n(r),o=n(172),a=n.n(o),c=n(20),u=n.n(c),s=n(2),d=n.n(s),l=n(10),f=n.n(l),p=n(3),y=n.n(p),h=n(6),v=n.n(h),g=n(31),w=n.n(g),m=n(9),b=n.n(m),T=n(12),O=n.n(T),A=n(5),P=n.n(A),x=n(423),E=n(47),I=n(55),k=n.n(I),S=n(27),C=n.n(S),R=n(132),D=n.n(R),N=n(126),j=n.n(N),B=n(427),F=n(112),H=n(56),_=n(22),K=n(21),M=n(459),U=n(938),L=n(57),G=n(3069),W=n(3832),z=n(3833),q=n(3834),J=n(3835),V=n(3836),Q=n(2092);function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){d()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=P()(e);if(t){var i=P()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return O()(this,n)}}var Z=function(t){b()(r,t);var n=$(r);function r(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return(e=n.call.apply(n,[this].concat(r))).keyringMap={hd:q.a,hw:z.a,imported:J.a,watching:V.a,external:V.a},e.settings=Q.default,e.getApiExplorerCache=j()((function(e){return k.a.create({baseURL:e})}),{promise:!0,max:1,maxAge:Object(H.b)({minute:3})}),e.getAssociatedAccountInfo=j()(function(){var t=y()((function*(t){var n,r=yield e.getClient(),i=(null!=(n=yield r.getAccountInfo(t))?n:{}).data.parsed.info;return{mint:i.mint,owner:i.owner}}));return function(e){return t.apply(this,arguments)}}(),{promise:!0,primitive:!0,max:50,maxAge:Object(H.b)({minute:3})}),e.createClientFromURL=j()((function(e){return new W.a(e)}),{max:1,maxAge:Object(H.b)({minute:3})}),e}var o=r.prototype;return o.getApiExplorer=function(){return this.getApiExplorerCache("https://public-api.solscan.io/")},o.getClient=function(){var e=y()((function*(){var e=yield this.getRpcUrl();return this.createClientFromURL(e)}));return function(){return e.apply(this,arguments)}}(),o.decodeNativeTxActions=function(){var e=y()((function*(e){var t=[],n={};for(var r of e.instructions)if(r.programId.toString()===E.SystemProgram.programId.toString())try{if("Transfer"===E.SystemInstruction.decodeInstructionType(r)){var i=yield this.engine.getNativeTokenInfo(this.networkId),o=E.SystemInstruction.decodeTransfer(r),a=o.fromPubkey,c=o.toPubkey,u=o.lamports,s=new C.a(u.toString());t.push({type:L.a.NATIVE_TRANSFER,nativeTransfer:{tokenInfo:i,from:a.toString(),to:c.toString(),amount:s.shiftedBy(-i.decimals).toFixed(),amountValue:s.toFixed(),extraInfo:null}})}}catch(_){}else if(r.programId.toString()===x.ASSOCIATED_TOKEN_PROGRAM_ID.toString()&&0===r.data.length&&7===r.keys.length&&r.keys[4].pubkey.toString()===E.SystemProgram.programId.toString()&&r.keys[5].pubkey.toString()===x.TOKEN_PROGRAM_ID.toString()){var d=f()(r.keys,4),l=d[1],p=d[2],y=d[3];l&&p&&y&&(n[l.pubkey.toString()]={owner:p.pubkey.toString(),mint:y.pubkey.toString()})}else if(r.programId.toString()===x.TOKEN_PROGRAM_ID.toString())try{var h=Object(x.decodeInstruction)(r).data.instruction,v=void 0,g=void 0,w=void 0,m=void 0;if(h===x.TokenInstruction.TransferChecked){var b=Object(x.decodeTransferCheckedInstruction)(r),T=b.data.amount,O=b.keys,A=O.owner,P=O.mint,I=O.destination;v=new C.a(T.toString()),g=A.pubkey.toString(),w=P.pubkey.toString(),m=I.pubkey.toString()}else if(h===x.TokenInstruction.Transfer){var k=Object(x.decodeTransferInstruction)(r),S=k.data.amount,R=k.keys,D=R.owner,N=R.destination;v=new C.a(S.toString()),g=D.pubkey.toString(),m=N.pubkey.toString()}if(v&&g&&m){var j=n[m]||(yield this.getAssociatedAccountInfo(m)),B=j.mint,F=j.owner;w=w||B;var H=yield this.engine.ensureTokenInDB(this.networkId,w);H&&t.push({type:L.a.TOKEN_TRANSFER,tokenTransfer:{tokenInfo:H,from:g,to:null!=F?F:m,amount:v.shiftedBy(-H.decimals).toFixed(),amountValue:v.toFixed(),extraInfo:null}})}}catch(K){}return 0===t.length&&t.push({type:L.a.UNKNOWN}),t}));return function(t){return e.apply(this,arguments)}}(),o.proxyJsonRPCCall=function(){var e=y()((function*(e){var t=yield this.getClient();try{return yield t.rpc.call(e.method,e.params)}catch(n){throw Object(U.c)(n)}}));return function(t){return e.apply(this,arguments)}}(),o.getBalances=function(){var e=y()((function*(e){var t=e.map((function(e){var t=e.address,n=e.tokenAddress;return{address:t,coin:Y({},"string"===typeof n?{tokenAddress:n}:{})}}));return(yield this.getClient()).getBalances(t)}));return function(t){return e.apply(this,arguments)}}(),o.fetchTokenInfos=function(e){return this.engine.providerManager.getTokenInfos(this.networkId,e)},o.validateAddress=function(e){try{if(E.PublicKey.isOnCurve(e))return Promise.resolve(e)}catch(t){}return Promise.reject(new K.e)},o.validateImportedCredential=function(e){if(this.settings.importedAccountEnabled)try{var t=D.a.decode(e);if(64===t.length){var n=[t.slice(0,32),t.slice(32)],r=n[0],i=n[1];return Promise.resolve(B.a.publicFromPrivate(r).toString("hex")===i.toString("hex"))}}catch(o){}return Promise.resolve(!1)},o.validateWatchingCredential=function(){var e=y()((function*(e){var t=!1;if(this.settings.watchingAccountEnabled)try{yield this.validateAddress(e),t=!0}catch(n){}return Promise.resolve(t)}));return function(t){return e.apply(this,arguments)}}(),o.attachFeeInfoToEncodedTx=function(e){return Promise.resolve(e.encodedTx)},o.decodeTx=function(){var e=y()((function*(e,t){var n,r=yield this.helper.parseToNativeTx(e),i=yield this.decodeNativeTxActions(r);if("InternalSwap"===(null==t?void 0:t.type)&&null!=t&&t.swapInfo&&(i=[{type:L.a.INTERNAL_SWAP,internalSwap:Y(Y({},t.swapInfo),{},{extraInfo:null})}]),"Transfer"===(null==t?void 0:t.type)&&(null!=t&&t.nftInfo||null!=t&&t.nftInfos)){var o=t.nftInfos?t.nftInfos:[t.nftInfo];i=[],o.map((function(e){return i.push({type:L.a.NFT_TRANSFER,nftTransfer:{asset:e.asset,amount:e.amount,send:e.from,receive:e.to,extraInfo:null}})}))}var a=yield this.getAccountAddress();return{txid:r.signature?D.a.encode(r.signature):"",owner:a,signer:(null==(n=r.feePayer)?void 0:n.toString())||a,nonce:0,actions:i,status:L.c.Pending,networkId:this.networkId,accountId:this.accountId,extraInfo:null,encodedTx:e}}));return function(t,n){return e.apply(this,arguments)}}(),o.decodedTxToLegacy=function(e){return Promise.resolve({})},o.buildEncodedTxFromTransfer=function(){var e=y()((function*(e){var t=e.from,n=e.to,r=e.amount,i=e.token,o=e.sendAddress,a=(yield this.getNetwork(),yield this.getClient()),c=yield this.engine.ensureTokenInDB(this.networkId,null!=i?i:"");if(!c)throw new K.p("Token not found: "+(i||"main"));var u=new E.PublicKey(t),s=new E.PublicKey(n),d=new E.Transaction,l=yield a.getFees(),p=f()(l,2);if(d.recentBlockhash=p[1],d.feePayer=u,i){var y=new E.PublicKey(i),h=s;E.PublicKey.isOnCurve(s.toString())&&(h=yield Object(x.getAssociatedTokenAddress)(y,s)),null===(yield a.getAccountInfo(h.toString()))&&d.add(Object(x.createAssociatedTokenAccountInstruction)(u,h,s,y));var v=o?new E.PublicKey(o):yield Object(x.getAssociatedTokenAddress)(y,u);d.add(Object(x.createTransferCheckedInstruction)(v,y,h,u,BigInt(new C.a(r).shiftedBy(c.decimals).toFixed()),c.decimals))}else d.add(E.SystemProgram.transfer({fromPubkey:new E.PublicKey(t),toPubkey:new E.PublicKey(n),lamports:BigInt(new C.a(r).shiftedBy(c.decimals).toFixed())}));return D.a.encode(d.serialize({requireAllSignatures:!1}))}));return function(t){return e.apply(this,arguments)}}(),o.buildEncodedTxFromBatchTransfer=function(){var e=y()((function*(e){var t=yield this.getClient(),n=e[0],r=n.from,i=n.to,o=new E.PublicKey(r),a=new E.PublicKey(i),c=new E.Transaction,u=yield t.getFees(),s=f()(u,2);c.recentBlockhash=s[1],c.feePayer=o;for(var d=0;d<e.length;d+=1){var l=e[d],p=l.token,y=(l.isNFT,l.amount),h=yield this.engine.ensureTokenInDB(this.networkId,null!=p?p:"");if(!h)throw new K.p("Token not found: "+(p||"main"));if(p){var v=new E.PublicKey(p),g=a;E.PublicKey.isOnCurve(a.toString())&&(g=yield Object(x.getAssociatedTokenAddress)(v,a)),null===(yield t.getAccountInfo(g.toString()))&&c.add(Object(x.createAssociatedTokenAccountInstruction)(o,g,a,v)),c.add(Object(x.createTransferCheckedInstruction)(yield Object(x.getAssociatedTokenAddress)(v,o),v,g,o,BigInt(new C.a(y).shiftedBy(h.decimals).toFixed()),h.decimals))}}return D.a.encode(c.serialize({requireAllSignatures:!1}))}));return function(t){return e.apply(this,arguments)}}(),o.buildEncodedTxFromApprove=function(e){throw new K.k},o.updateEncodedTxTokenApprove=function(e,t){throw new K.k},o.updateEncodedTx=function(){var e=y()((function*(e,t,n){var r=yield this.helper.parseToNativeTx(e),i=f()(r.instructions,1)[0];if("transfer"===n.type&&1===r.instructions.length&&i.programId.toString()===E.SystemProgram.programId.toString()&&"Transfer"===E.SystemInstruction.decodeInstructionType(i)){var o=E.SystemInstruction.decodeTransfer(i),a=o.fromPubkey,c=o.toPubkey,u=yield this.engine.getNativeTokenInfo(this.networkId),s=t.amount;return r.instructions=[E.SystemProgram.transfer({fromPubkey:a,toPubkey:c,lamports:BigInt(new C.a(s).shiftedBy(u.decimals).toFixed())})],D.a.encode(r.serialize({requireAllSignatures:!1}))}return Promise.resolve(e)}));return function(t,n,r){return e.apply(this,arguments)}}(),o.broadcastTransaction=function(){var e=y()((function*(e){var t=this,n=!1,i=0,o="",a=function(){var i=y()((function*(){try{var i=n?{preflightCommitment:"confirmed"}:{};return yield w()(P()(r.prototype),"broadcastTransaction",t).call(t,e,i||{})}catch(c){var a=null==c?void 0:c.data;if(c&&a&&(-32005===a.code||-32002===a.code))return n=!0,void(o=a.message);throw c}}));return function(){return i.apply(this,arguments)}}();do{if((i+=1)>8)throw n=!1,new Error("Solana broadcastTransaction retry times exceeded: "+(o||""));var c=yield a();if(c)return c;yield Object(H.g)(1e3)}while(n);throw new Error("Solana broadcastTransaction retry failed")}));return function(t){return e.apply(this,arguments)}}(),o.buildUnsignedTxFromEncodedTx=function(){var e=y()((function*(e){var t=yield this.getDbAccount(),n=yield this.helper.parseToNativeTx(e);yield this.getClient();return{inputs:[],outputs:[],payload:{nativeTx:n,feePayer:new E.PublicKey(t.pub)},encodedTx:e}}));return function(t){return e.apply(this,arguments)}}(),o.fetchFeeInfo=function(){var e=y()((function*(e){var t=yield Promise.all([this.getNetwork(),this.engine.getGasPrice(this.networkId),this.helper.parseToNativeTx(e)]),n=f()(t,3),r=n[0],i=n[1],o=n[2];return{nativeSymbol:r.symbol,nativeDecimals:r.decimals,feeSymbol:r.feeSymbol,feeDecimals:r.feeDecimals,limit:o.signatures.length.toString(),prices:i,defaultPresetIndex:"0",tx:null}}));return function(t){return e.apply(this,arguments)}}(),o.getExportedCredential=function(){var t=y()((function*(t){var n=yield this.getDbAccount();if(n.id.startsWith("hd-")||n.id.startsWith("imported")){var r=this.keyring,i=Object.values(yield r.getPrivateKeys(t)),o=f()(i,1)[0];return D.a.encode(e.concat([Object(F.a)(t,o),D.a.decode(n.pub)]))}throw new K.p("Only credential of HD or imported accounts can be exported")}));return function(e){return t.apply(this,arguments)}}(),o.mergeNFTTx=function(e){var t=e.address,n=e.decodedTx,r=e.nftTxs;if(r){var i=r.map((function(e){return Object(M.b)({transaction:e,address:t})})).filter(Boolean);n.actions=i}return n},o.mergeDecodedTx=function(){var e=y()((function*(e){var t=e.decodedTx,n=e.nftTxs,r=yield this.getAccountAddress();if(n&&n.length>0){var i=this.mergeNFTTx({address:r,decodedTx:t,nftTxs:n});return Promise.resolve(i)}return Promise.resolve(t)}));return function(t){return e.apply(this,arguments)}}(),o.fetchOnChainHistory=function(){var e=y()((function*(e){var t=this,n=e.localHistory,r=void 0===n?[]:n;if(e.tokenIdOnNetwork)return Promise.resolve([]);var o=yield this.getNetwork(),c=this.getApiExplorer(),s=yield this.getClient(),d=yield this.getDbAccount(),l=(yield this.engine.getNativeTokenInfo(this.networkId)).decimals,p=[];if(o.isTestnet)p=yield s.rpc.call("getSignaturesForAddress",[d.address,{limit:50}]);else{var h=c.get("/account/splTransfers",{params:{account:d.address,limit:50,cluster:o.isTestnet&&"devnet"}}),v=c.get("/account/solTransfers",{params:{account:d.address,limit:50,cluster:o.isTestnet&&"devnet"}}),g=yield Promise.all([h,v]),w=f()(g,2),m=w[0],b=w[1],T=m.data.data||[],O=b.data.data||[];p=[].concat(u()(T),u()(O))}var A=yield s.rpc.batchCall(p.map((function(e){var t=e.signature;return["getTransaction",[e.txHash||(a()(t)?t[0]:t),{encoding:"base58"}]]}))),P=yield Object(M.k)(d.address,this.networkId),x=new Map;P.forEach((function(e){var t=e.hash,n=x.get(t);n||(n=[]),n.push(e),x.set(t,n)}));var E=A.map(function(){var e=y()((function*(e,n){var o=p[n],c=o.txHash||(a()(o.signature)?o.signature&&o.signature[0]:o.signature)||"",u=r.find((function(e){return e.decodedTx.txid===c})),s=!0;if(u&&u.decodedTx.isFinal)return Promise.resolve(null);var d=x.get(c);o&&0===o.decimals&&i()(d)&&(s=!1);try{var y,h,v=e.blockTime,g=f()(e.transaction,1)[0],w=e.meta,m=w.fee,b=w.err,T=1e3*v,O=Y(Y({},null!=(y=null==u?void 0:u.decodedTx)?y:yield t.decodeTx(g)),{},{txid:c,totalFeeInNative:new C.a(m).shiftedBy(-l).toFixed(),status:b?L.c.Failed:L.c.Confirmed,updatedAt:T,createdAt:null!=(h=null==u?void 0:u.decodedTx.createdAt)?h:T,isFinal:s});return O=yield t.mergeDecodedTx({decodedTx:O,nftTxs:d}),yield t.buildHistoryTx({decodedTx:O,historyTxToMerge:u})}catch(A){_.a.common.error(A)}return Promise.resolve(null)}));return function(t,n){return e.apply(this,arguments)}}());return(yield Promise.all(E)).filter(Boolean)}));return function(t){return e.apply(this,arguments)}}(),o.getPrivateKeyByCredential=function(e){var t,n=D.a.decode(e);return 64===n.length&&(t=n.slice(0,32)),t},o.refreshRecentBlockBash=function(){var t=y()((function*(t){var n=E.Transaction.from(e.from(t,"base64")),r=yield this.getClient(),i=yield r.getFees(),o=f()(i,2);return n.recentBlockhash=o[1],D.a.encode(n.serialize({requireAllSignatures:!1}))}));return function(e){return t.apply(this,arguments)}}(),v()(r)}(G.a)}.call(this,n(19).Buffer)}}]);