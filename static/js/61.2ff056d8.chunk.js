(this.webpackJsonp=this.webpackJsonp||[]).push([[61],{3050:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(6),i=n.n(r),o=n(9),a=n.n(o),c=n(12),u=n.n(c),s=n(5),d=n.n(s);function l(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d()(e);if(t){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u()(this,n)}}var f=function(e){a()(n,e);var t=l(n);function n(e){var n;return(n=t.call(this,e.options)).vault=e,n}return i()(n)}(n(1108).a);!function(e){a()(n,e);var t=l(n);function n(){return t.apply(this,arguments)}i()(n)}(f)},3055:function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var r=n(10),i=n.n(r),o=n(2),a=n.n(o),c=n(3),u=n.n(c),s=n(6),d=n.n(s),l=n(9),f=n.n(l),p=n(12),y=n.n(p),h=n(5),v=n.n(h),g=n(22),w=n(21);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}var T=function(e){f()(n,e);var t=O(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.signTransaction=function(){var e=u()((function*(e,t){var n=t.password;if("undefined"===typeof n)throw new w.p("Software signing requires a password.");var r=yield this.getSigners(n,e.inputs.map((function(e){return e.address})));return g.a.engine.info("signTransaction",this.networkId,e),m(m({},yield this.engine.providerManager.signTransaction(this.networkId,e,r)),{},{encodedTx:e.encodedTx})}));return function(t,n){return e.apply(this,arguments)}}(),r.signMessage=function(){var e=u()((function*(e,t){var n=this,r=t.password;if("undefined"===typeof r)throw new w.p("Software signing requires a password.");var o=yield this.getDbAccount(),a=Object.values(yield this.getSigners(r,[o.address])),c=i()(a,1)[0];return g.a.engine.info("signMessage",this.networkId,e),Promise.all(e.map((function(e){return n.engine.providerManager.signMessage(n.networkId,e,c)})))}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},d()(n)}(n(3050).a)},3068:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(44),i=n(72),o=n(22),a=n(15);function c(e,t){return"string"!==typeof t?null:e===r.HardwareErrorCode.DeviceInitializeFailed&&t.includes("ECONNABORTED")?new i.g({message:t}):t.includes("Bridge network error")?new i.e({message:t}):null}function u(e){var t,n=e||{},u=n.code,s=n.error,d=n.message,l=null!=(t=null!=s?s:d)?t:"Unknown error";if(c(u,l))return c(u,l);switch(o.a.hardwareSDK.info("Device Utils Convert Device Error:",u,l),u){case r.HardwareErrorCode.UnknownError:return new i.F(e);case r.HardwareErrorCode.DeviceFwException:return new i.s(e);case r.HardwareErrorCode.DeviceUnexpectedMode:return"string"===typeof l&&-1!==l.indexOf("ui-device_bootloader_mode")?new i.C(e):new i.F(e);case r.HardwareErrorCode.DeviceCheckDeviceIdError:return new i.l(e);case r.HardwareErrorCode.DeviceNotFound:return new i.j(e);case r.HardwareErrorCode.DeviceUnexpectedBootloaderMode:return new i.C(e);case r.HardwareErrorCode.DeviceInterruptedFromOutside:case r.HardwareErrorCode.DeviceInterruptedFromUser:return new i.I(e);case r.HardwareErrorCode.DeviceNotSupportPassphrase:return new i.D(e);case r.HardwareErrorCode.IFrameLoadFail:return new i.t(e);case r.HardwareErrorCode.IframeTimeout:return new i.u(e);case r.HardwareErrorCode.FirmwareUpdateDownloadFailed:return new i.o(e);case r.HardwareErrorCode.FirmwareUpdateManuallyEnterBoot:return new i.r(e);case r.HardwareErrorCode.FirmwareUpdateAutoEnterBootFailure:return new i.p(e);case r.HardwareErrorCode.FirmwareUpdateLimitOneDevice:return new i.q(e);case r.HardwareErrorCode.CallMethodNeedUpgradeFirmware:return new i.s(e);case r.HardwareErrorCode.NewFirmwareUnRelease:return new i.B(e);case r.HardwareErrorCode.NetworkError:return new i.A(e);case r.HardwareErrorCode.BlePermissionError:return new i.y(e);case r.HardwareErrorCode.BleLocationError:return new i.x({message:l});case r.HardwareErrorCode.BleLocationServicesDisabled:return new i.b({message:l});case r.HardwareErrorCode.BleDeviceNotBonded:return new i.i(e);case r.HardwareErrorCode.BleWriteCharacteristicError:return new i.d(e);case r.HardwareErrorCode.BleScanError:return new i.c({message:l});case r.HardwareErrorCode.BleAlreadyConnected:return new i.a(e);case r.HardwareErrorCode.RuntimeError:return-1!==l.indexOf("EIP712 blind sign is disabled")?new i.E(e):-1!==l.indexOf("Unknown message")||-1!==l.indexOf("Failure_UnexpectedMessage")?new i.G(e):new i.F(e);case r.HardwareErrorCode.PinInvalid:return new i.v(e);case r.HardwareErrorCode.DeviceCheckPassphraseStateError:return new i.w(e);case r.HardwareErrorCode.DeviceOpenedPassphrase:return new i.m(e);case r.HardwareErrorCode.DeviceNotOpenedPassphrase:return new i.k(e);case r.HardwareErrorCode.PinCancelled:case r.HardwareErrorCode.ActionCancelled:return new i.H(e);case r.HardwareErrorCode.BridgeNotInstalled:case i.h.NeedOneKeyBridge:return new i.z(e);case r.HardwareErrorCode.BridgeNetworkError:return new i.e(e);case r.HardwareErrorCode.BridgeTimeoutError:return a.a.isDesktop&&(o.a.hardwareSDK.debug("desktop bridge timeout, restart desktop bridge."),window.desktopApi.reloadBridgeProcess()),new i.f(e);case r.HardwareErrorCode.PollingTimeout:return new i.g(e);case r.HardwareErrorCode.BlindSignDisabled:return new i.E(e);default:return new i.F(e)}}},3069:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return C}));var r=n(2),i=n.n(r),o=n(143),a=n.n(o),c=n(3),u=n.n(c),s=n(6),d=n.n(s),l=n(9),f=n.n(l),p=n(12),y=n.n(p),h=n(5),v=n.n(h),g=n(27),w=n.n(g),b=n(14),m=n(22),O=n(15),T=n(54),x=n(21),j=n(647),I=n(57),E=n(1108);function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function A(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}if(O.a.isExtensionUi)throw new Error("engine/VaultBase is not allowed imported from ui");var C=function(t){f()(r,t);var n=A(r);function r(){return n.apply(this,arguments)}var i=r.prototype;return i.init=function(){var e=u()((function*(e){yield this.initProvider(),yield this.initKeyring(e)}));return function(t){return e.apply(this,arguments)}}(),i.initKeyring=function(){var e=u()((function*(e){this.keyring=yield e.keyringCreator(this)}));return function(t){return e.apply(this,arguments)}}(),i.signTransaction=function(){var e=u()((function*(e,t){return this.keyring.signTransaction(e,t)}));return function(t,n){return e.apply(this,arguments)}}(),i.signAndSendTransaction=function(){var e=u()((function*(e,t,n){var r=yield this.signTransaction(e,t);return n?P(P({},r),{},{encodedTx:e.encodedTx}):this.broadcastTransaction(P(P({},r),{},{encodedTx:e.encodedTx}))}));return function(t,n,r){return e.apply(this,arguments)}}(),i.broadcastTransaction=function(){var e=u()((function*(e,t){m.a.engine.info("broadcastTransaction START:",{rawTx:e.rawTx});var n=yield this.engine.providerManager.broadcastTransaction(this.networkId,e.rawTx,t);return m.a.engine.info("broadcastTransaction END:",{txid:n,rawTx:e.rawTx}),P(P({},e),{},{txid:n,encodedTx:e.encodedTx})}));return function(t,n){return e.apply(this,arguments)}}(),i.buildEncodedTxFromBatchTransfer=function(){var e=u()((function*(e,t){throw new x.k}));return function(t,n){return e.apply(this,arguments)}}(),i.buildEncodedTxsFromSetApproveForAll=function(){var e=u()((function*(e,t){throw new x.k}));return function(t,n){return e.apply(this,arguments)}}(),i.activateAccount=function(){var e=u()((function*(){throw new x.k}));return function(){return e.apply(this,arguments)}}(),i.activateToken=function(){var e=u()((function*(e,t){throw new x.k}));return function(t,n){return e.apply(this,arguments)}}(),i.getTokenAllowance=function(){var e=u()((function*(e,t){throw new x.k}));return function(t,n){return e.apply(this,arguments)}}(),i.batchTokensAllowance=function(){var e=u()((function*(e,t){throw new x.k}));return function(t,n){return e.apply(this,arguments)}}(),i.getOutputAccount=function(){var e=u()((function*(){var e=yield this.getDbAccount({noCache:!0});return{id:e.id,name:e.name,type:e.type,path:e.path,coinType:e.coinType,tokens:[],address:e.address}}));return function(){return e.apply(this,arguments)}}(),i.getAccountBalance=function(){var e=u()((function*(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=yield this.getDbAccount(),r=n.address;return this.getBalances((t?[{address:r}]:[]).concat(e.map((function(e){return{address:r,tokenAddress:e}}))))}));return function(t){return e.apply(this,arguments)}}(),i.updatePendingTxs=function(){var e=u()((function*(e){throw new x.k}));return function(t){return e.apply(this,arguments)}}(),i.getAccountNonce=function(){var e=u()((function*(){return Promise.resolve(null)}));return function(){return e.apply(this,arguments)}}(),i.fixActionDirection=function(){var e=u()((function*(e){var t,n,r,i,o=e.action,a=e.accountAddress;(o.direction=I.b.OTHER,o.type===I.a.NATIVE_TRANSFER)&&(o.direction=yield this.buildTxActionDirection({from:(null==(t=o.nativeTransfer)?void 0:t.from)||"",to:(null==(n=o.nativeTransfer)?void 0:n.to)||"",address:a}));o.type===I.a.TOKEN_TRANSFER&&(o.direction=yield this.buildTxActionDirection({from:(null==(r=o.tokenTransfer)?void 0:r.from)||"",to:(null==(i=o.tokenTransfer)?void 0:i.to)||"",address:a}));return o}));return function(t){return e.apply(this,arguments)}}(),i.fixDecodedTx=function(){var e=u()((function*(e){var t,n;e.createdAt=null!=(t=e.createdAt)?t:Date.now();var r=null==(n=e.encodedTx)?void 0:n.nonce;e.nonce=a()(r)?e.nonce:new w.a(r).toNumber();for(var i=e.owner,o=0;o<e.actions.length;o+=1){var c=e.actions[o];yield this.fixActionDirection({action:c,accountAddress:i})}if(e.outputActions)for(var u=0;u<e.outputActions.length;u+=1){var s=e.outputActions[u];yield this.fixActionDirection({action:s,accountAddress:i})}return Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),i.fixHistoryTx=function(){var e=u()((function*(e){return e.decodedTx=yield this.fixDecodedTx(e.decodedTx),O.a.isDev&&O.a.isDesktop&&Object.assign(e,{_tmpCreatedAtText:new Date(e.decodedTx.createdAt||0).toLocaleString(),_tmpUpdatedAtText:new Date(e.decodedTx.updatedAt||0).toLocaleString(),_tmpStatus:e.decodedTx.status,_tmpIsFinal:e.decodedTx.isFinal}),Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),i.buildHistoryTx=function(){var e=u()((function*(e){var t=e.historyTxToMerge,n=(e.encodedTx,e.decodedTx),r=e.signedTx,i=e.isSigner,o=e.isLocalCreated,a=(null==r?void 0:r.txid)||(null==n?void 0:n.txid)||"";if(!a)throw new Error("buildHistoryTx txid not found");var c=yield this.getAccountAddress();n.txid=a||n.txid,n.owner=c,i&&(n.signer=c);var u=P(P({id:this.networkId+"_"+a+"_"+this.accountId,isLocalCreated:Boolean(o)},t),{},{decodedTx:n});return u=yield this.fixHistoryTx(u),Promise.resolve(u)}));return function(t){return e.apply(this,arguments)}}(),i.checkIsScamHistoryTx=function(){var e=u()((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),i.fetchOnChainHistory=function(){var e=u()((function*(e){throw new x.k}));return function(t){return e.apply(this,arguments)}}(),i.fixAddressCase=function(e){return Promise.resolve(e)},i.buildTxActionDirection=function(){var e=u()((function*(e){var t=e.from,n=e.to,r=e.address;return t=yield this.fixAddressCase(t||""),n=yield this.fixAddressCase(n),r=yield this.fixAddressCase(r),t===n&&t===r?I.b.SELF:t&&t===r?I.b.OUT:n&&n===r?I.b.IN:I.b.OTHER}));return function(t){return e.apply(this,arguments)}}(),i.getNextNonce=function(){var e=u()((function*(e,t){var n,r,i=null!=(n=null==(r=(yield this.engine.providerManager.getAddresses(e,[t.address]))[0])?void 0:r.nonce)?n:0,o=(yield this.engine.getHistory(e,t.id,void 0,!1),yield T.a.history.getMaxPendingNonce({accountId:this.accountId,networkId:e})),c=yield T.a.history.getPendingNonceList({accountId:this.accountId,networkId:e}),u=Math.max(a()(o)?0:o+1,i);if(Number.isNaN(u)&&(u=i),u>i)for(var s=i;s<u;s+=1)if(!c.includes(s)){u=s;break}if(u<i&&(u=i),u-i>=b.t.PENDING_QUEUE_MAX_LENGTH)throw new x.u(b.t.PENDING_QUEUE_MAX_LENGTH);return u}));return function(t,n){return e.apply(this,arguments)}}(),i.validateSendAmount=function(e,t,n){return Promise.resolve(!0)},i.notifyChainChanged=function(e,t){},i.getFetchBalanceAddress=function(e){return Promise.resolve(e.address)},i.getPrivateKeyByCredential=function(t){return e.from(t.startsWith("0x")?t.slice(2):t,"hex")},d()(r)}(function(e){f()(n,e);var t=A(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.initProvider=function(){var e=u()((function*(){var e=(yield this.getNetwork()).impl;a()(j.a[e])||(this.engineProvider=yield this.engine.providerManager.getProvider(this.networkId))}));return function(){return e.apply(this,arguments)}}(),r.proxyJsonRPCCall=function(){var e=u()((function*(e){throw new x.k}));return function(t){return e.apply(this,arguments)}}(),r.createClientFromURL=function(e){throw new x.k},r.getEthersProvider=function(){var e=u()((function*(){throw new x.k}));return function(){return e.apply(this,arguments)}}(),r.getClientEndpointStatus=function(){var e=u()((function*(e){var t=this.createClientFromURL(e),n=performance.now(),r=(yield t.getInfo()).bestBlockNumber;return{responseTime:Math.floor(performance.now()-n),latestBlock:r}}));return function(t){return e.apply(this,arguments)}}(),r.validateAddress=function(){var e=u()((function*(e){var t=yield this.engineProvider.verifyAddress(e),n=t.normalizedAddress;if(!t.isValid||"undefined"===typeof n)throw new x.e;return Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),r.validateImportedCredential=function(e){return Promise.resolve(this.settings.importedAccountEnabled&&/^(0x)?[0-9a-zA-Z]{64}$/.test(e))},r.validateWatchingCredential=function(){var e=u()((function*(e){return Promise.resolve(this.settings.watchingAccountEnabled&&(yield this.engineProvider.verifyAddress(e)).isValid)}));return function(t){return e.apply(this,arguments)}}(),r.validateTokenAddress=function(){var e=u()((function*(e){var t=yield this.engineProvider.verifyTokenAddress(e),n=t.normalizedAddress;if(!t.isValid||"undefined"===typeof n)throw new x.h;return Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),r.checkAccountExistence=function(){var e=u()((function*(e){return Promise.resolve(!0)}));return function(t){return e.apply(this,arguments)}}(),r.getBalances=function(){var e=u()((function*(e){return(yield this.engine.providerManager.getClient(this.networkId)).getBalances(e.map((function(e){var t=e.address,n=e.tokenAddress;return{address:t,coin:P({},"string"===typeof n?{tokenAddress:n}:{})}})))}));return function(t){return e.apply(this,arguments)}}(),r.getFrozenBalance=function(){var e=u()((function*(){return 0}));return function(){return e.apply(this,arguments)}}(),r.getTransactionStatuses=function(e){return this.engine.providerManager.getTransactionStatuses(this.networkId,e)},r.getTransactionFeeInNative=function(e){return Promise.resolve("")},r.isContractAddress=function(){var e=u()((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),d()(n)}(E.a))}).call(this,n(19).Buffer)},3070:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return h}));var r=n(3),i=n.n(r),o=n(6),a=n.n(o),c=n(9),u=n.n(c),s=n(12),d=n.n(s),l=n(5),f=n.n(l),p=n(299);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var i=f()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d()(this,n)}}var h=function(t){u()(r,t);var n=y(r);function r(){return n.apply(this,arguments)}var o=r.prototype;return o.getHardwareInfo=function(){var e=i()((function*(){var e,t,n=yield this.engine.getHWDeviceByWalletId(this.vault.walletId);return{connectId:null!=(e=null==n?void 0:n.mac)?e:"",deviceId:null!=(t=null==n?void 0:n.deviceId)?t:""}}));return function(){return e.apply(this,arguments)}}(),o.getWalletPassphraseState=function(){var e=i()((function*(){var e=yield this.engine.getWallet(this.vault.walletId);return{passphraseState:null==e?void 0:e.passphraseState}}));return function(){return e.apply(this,arguments)}}(),o.getHardwareSDKInstance=function(){var t=i()((function*(){var t,n,r,i,o;return null!=(o=yield null==(t=e)||null==(n=t.$backgroundApiProxy)||null==(r=n.backgroundApi)||null==(i=r.serviceHardware)||null==i.getSDKInstance?void 0:i.getSDKInstance())?o:p.b}));return function(){return t.apply(this,arguments)}}(),a()(r)}(n(3050).a)}).call(this,n(40))},3071:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(2),i=n.n(r),o=n(3),a=n.n(o),c=n(6),u=n.n(c),s=n(9),d=n.n(s),l=n(12),f=n.n(l),p=n(5),y=n.n(p),h=n(297),v=n(21);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var i=y()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var m=function(e){d()(n,e);var t=b(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.getPrivateKeys=function(){var e=a()((function*(e,t){var n=(yield this.getDbAccount()).path.split("/"),r=t||[n.pop()],i=n.join("/"),o=(yield this.engine.dbApi.getCredential(this.walletId,e)).seed;if("undefined"===typeof o)throw new v.p("Unable to get credential.");var a=(yield this.engine.providerManager.getChainInfoByNetworkId(this.networkId)).curve;return Object(h.c)(a,o,e,i,r).reduce((function(e,t){var n;return w(w({},e),{},((n={})[t.path]=t.extendedKey.key,n))}),{})}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},u()(n)}(n(3055).a)},3072:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(3),i=n.n(r),o=n(6),a=n.n(o),c=n(9),u=n.n(c),s=n(12),d=n.n(s),l=n(5),f=n.n(l),p=n(21);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var i=f()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d()(this,n)}}var h=function(e){u()(n,e);var t=y(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.getPrivateKeys=function(){var e=i()((function*(e,t){if("undefined"!==typeof t)throw new p.k("Getting private keys from extended private key");var n=(yield this.engine.dbApi.getCredential(this.accountId,e)).privateKey;if("undefined"===typeof n)throw new p.p("Unable to get credential.");return{"":n}}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},a()(n)}(n(3055).a)},3073:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(3),i=n.n(r),o=n(6),a=n.n(o),c=n(9),u=n.n(c),s=n(12),d=n.n(s),l=n(5),f=n.n(l),p=n(21);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var i=f()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d()(this,n)}}var h=function(e){u()(n,e);var t=y(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.signTransaction=function(){var e=i()((function*(e,t){throw new p.p("signTransaction is not supported for watching accounts")}));return function(t,n){return e.apply(this,arguments)}}(),r.signMessage=function(){var e=i()((function*(e,t){throw new p.p("signMessage is not supported for watching accounts")}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},a()(n)}(n(3050).a)},3095:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s}));var r=n(27),i=n.n(r);function o(e){var t,n=e.value,r=e.network;return new i.a(n).shiftedBy(null!=(t=-r.feeDecimals)?t:0).toFixed()}function a(e){var t,n=e.value,r=e.network;return new i.a(n).shiftedBy(null!=(t=r.feeDecimals)?t:0).toFixed()}function c(e){var t,n,r,o=e.amount,a=e.info;return new i.a(o).plus(null!=(t=a.baseFeeValue)?t:0).shiftedBy(null!=(n=a.feeDecimals)?n:0).shiftedBy(-(null!=(r=a.nativeDecimals)?r:0)).toFixed()}function u(e){return"NaN"===e||Number.isNaN(e)?"0":e}function s(e){var t=e.limitUsed||e.limit;if(e.eip1559){var n=e.price,r=new i.a(t).times(new i.a(n.baseFee).plus(n.maxPriorityFeePerGas)).toFixed(),o=new i.a(t).times(n.gasPrice||n.maxFeePerGas).toFixed();return{min:u(r),max:u(o)}}var a=new i.a(t).times(e.price).toFixed();return{min:u(a),max:u(a)}}},4088:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return P}));var r=n(2),i=n.n(r),o=n(3),a=n.n(o),c=n(6),u=n.n(c),s=n(9),d=n.n(s),l=n(12),f=n.n(l),p=n(5),y=n.n(p),h=n(183),v=n(3068),g=n(14),w=n(22),b=n(21),m=n(111),O=n(3070),T=n(287),x=n(1148);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var i=y()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var k="m/44'/"+g.p+"'",P=function(t){d()(r,t);var n=E(r);function r(){return n.apply(this,arguments)}var i=r.prototype;return i.getPublicKey=function(){var e=a()((function*(e,t,n){var r,i=yield this.getHardwareSDKInstance(),o=yield this.getWalletPassphraseState();try{r=yield i.suiGetPublicKey(e,t,I({bundle:n.map((function(e){return{path:e}}))},o))}catch(a){throw w.a.common.error(a),new b.o(a)}if(!r.success)throw w.a.common.error(r.payload),Object(v.a)(r.payload);return r.payload.map((function(e){return e.publicKey})).filter((function(e){return!!e}))}));return function(t,n,r){return e.apply(this,arguments)}}(),i.prepareAccounts=function(){var e=a()((function*(e){var t,n=e.type,r=e.indexes,i=e.names,o=r.map((function(e){return k+"/"+e+"'/0'/0'"})),a="SEARCH_ACCOUNTS"===n,c=yield this.getHardwareSDKInstance(),u=yield this.getHardwareInfo(),s=u.connectId,d=u.deviceId,l=yield this.getWalletPassphraseState();try{t=yield c.suiGetAddress(s,d,I({bundle:o.map((function(e){return{path:e,showOnOneKey:!1}}))},l))}catch(C){throw w.a.common.error(C),new b.o(C)}if(!t.success)throw w.a.common.error(t.payload),Object(v.a)(t.payload);var f,p,y=[];a||(!(null==(f=t.payload)||null==(p=f[0])||!p.publicKey)||(y=yield this.getPublicKey(s,d,o)));var h=[],O=0;for(var x of t.payload){var j=x.address,E=x.path,P=x.publicKey;if(j){var A=(i||[])[O]||"SUI #"+(r[O]+1);h.push({id:this.walletId+"--"+E,name:A,type:m.a.SIMPLE,path:E,coinType:g.p,pub:null!=P?P:y[O]||"",address:Object(T.a)(j)}),O+=1}}return h}));return function(t){return e.apply(this,arguments)}}(),i.getAddress=function(){var e=a()((function*(e){var t,n=yield this.getHardwareSDKInstance(),r=yield this.getHardwareInfo(),i=r.connectId,o=r.deviceId,a=yield this.getWalletPassphraseState(),c=yield n.suiGetAddress(i,o,I({path:e.path,showOnOneKey:e.showOnOneKey},a));if(c.success&&null!=(t=c.payload)&&t.address)return c.payload.address.toLowerCase();throw Object(v.a)(c.payload)}));return function(t){return e.apply(this,arguments)}}(),i.signTransaction=function(){var t=a()((function*(t,n){var r,i;w.a.common.info("signTransaction",t);var o=yield this.getDbAccount(),a=(yield this.engine.getNetwork(this.networkId)).rpcURL,c=new h.JsonRpcProvider(a),u=o.address,s=null==(r=t.inputs)||null==(i=r[0])?void 0:i.publicKey;if(!s)throw new b.p("Unable to get sender public key.");var d=t.payload.encodedTx,l=yield Object(x.m)(c,u,d),f=yield Object(x.k)(c,l),p=yield this.getHardwareInfo(),y=p.connectId,g=p.deviceId,m=yield this.getWalletPassphraseState(),O=yield this.getHardwareSDKInstance(),j=yield O.suiSignTransaction(y,g,I({path:o.path,rawTx:Object(T.b)(e.from(f.getData()))},m));if(j.success){var E=j.payload.signature;return{txid:"",rawTx:l,signatureScheme:"ed25519",signature:Object(T.a)(E),publicKey:Object(T.a)(s)}}throw Object(v.a)(j.payload)}));return function(e,n){return t.apply(this,arguments)}}(),i.signMessage=function(){var e=a()((function*(e,t){return w.a.common.info("signMessage",e),Promise.reject(new Error("Not implemented"))}));return function(t,n){return e.apply(this,arguments)}}(),u()(r)}(O.a)}).call(this,n(19).Buffer)},4089:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return k}));var r=n(10),i=n.n(r),o=n(3),a=n.n(o),c=n(6),u=n.n(c),s=n(9),d=n.n(s),l=n(12),f=n.n(l),p=n(5),y=n.n(p),h=n(183),v=n(297),g=n(14),w=n(22),b=n(21),m=n(938),O=n(111),T=n(3071),x=n(287),j=n(1148);function I(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var i=y()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var E="m/44'/"+g.p+"'",k=function(t){d()(r,t);var n=I(r);function r(){return n.apply(this,arguments)}var o=r.prototype;return o.getSigners=function(){var e=a()((function*(e,t){var n,r=yield this.getDbAccount();if(1!==t.length)throw new b.p("Sui signers number should be 1.");if(t[0]!==r.address)throw new b.p("Wrong address required for signing.");var i=(yield this.getPrivateKeys(e))[r.path];if("undefined"===typeof i)throw new b.p("Unable to get signer.");return(n={})[r.address]=new m.b(i,e,"ed25519"),n}));return function(t,n){return e.apply(this,arguments)}}(),o.prepareAccounts=function(){var e=a()((function*(e){var t=e.password,n=e.indexes,r=e.names,i=(yield this.engine.dbApi.getCredential(this.walletId,t)).seed,o=Object(v.d)("ed25519",i,t,E,n.map((function(e){return e.toString()+"'/0'/0'"})));if(o.length!==n.length)throw new b.p("Unable to get publick key.");var a=[],c=0;for(var u of o){var s=u.path,d=u.extendedKey.key,l=d.toString("hex"),f=new h.Ed25519PublicKey(d),p=Object(x.a)(f.toSuiAddress()),y=(r||[])[c]||"SUI #"+(n[c]+1);a.push({id:this.walletId+"--"+s,name:y,type:O.a.SIMPLE,path:s,coinType:g.p,pub:l,address:p}),c+=1}return a}));return function(t){return e.apply(this,arguments)}}(),o.signTransaction=function(){var t=a()((function*(t,n){var r,o;w.a.common.info("signTransaction result",t);var a=yield this.getDbAccount(),c=(yield this.engine.getNetwork(this.networkId)).rpcURL,u=new h.JsonRpcProvider(c),s=a.address,d=(yield this.getSigners(n.password||"",[s]))[s],l=null==(r=t.inputs)||null==(o=r[0])?void 0:o.publicKey;if(!l)throw new b.p("Unable to get sender public key.");var f=t.payload.encodedTx,p=yield Object(j.m)(u,s,f),y=yield Object(j.k)(u,p),v=yield d.sign(e.from(y.getData())),g=i()(v,1)[0];return{txid:"",rawTx:p,signatureScheme:"ed25519",signature:Object(x.a)(g.toString("hex")),publicKey:Object(x.a)(l)}}));return function(e,n){return t.apply(this,arguments)}}(),o.signMessage=function(){var e=a()((function*(e,t){return Promise.reject(new Error("Not implemented"))}));return function(t,n){return e.apply(this,arguments)}}(),u()(r)}(T.a)}).call(this,n(19).Buffer)},4090:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return I}));var r=n(10),i=n.n(r),o=n(3),a=n.n(o),c=n(6),u=n.n(c),s=n(9),d=n.n(s),l=n(12),f=n.n(l),p=n(5),y=n.n(p),h=n(183),v=n(427),g=n(14),w=n(21),b=n(938),m=n(111),O=n(3072),T=n(287),x=n(1148);function j(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var i=y()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var I=function(t){d()(r,t);var n=j(r);function r(){return n.apply(this,arguments)}var o=r.prototype;return o.getSigners=function(){var e=a()((function*(e,t){var n,r=yield this.getDbAccount();if(1!==t.length)throw new w.p("Starcoin signers number should be 1.");if(t[0]!==r.address)throw new w.p("Wrong address required for signing.");var i=(yield this.getPrivateKeys(e))[r.path];if("undefined"===typeof i)throw new w.p("Unable to get signer.");return(n={})[r.address]=new b.b(i,e,"ed25519"),n}));return function(t,n){return e.apply(this,arguments)}}(),o.prepareAccounts=function(){var e=a()((function*(e){var t=e.privateKey,n=e.name;if(32!==t.length)throw new w.p("Invalid private key.");var r=v.a.publicFromPrivate(t),i=r.toString("hex"),o=new h.Ed25519PublicKey(r),a=Object(T.a)(o.toSuiAddress());return Promise.resolve([{id:"imported--"+g.p+"--"+i,name:n||"",type:m.a.SIMPLE,path:"",coinType:g.p,pub:i,address:a}])}));return function(t){return e.apply(this,arguments)}}(),o.signTransaction=function(){var t=a()((function*(t,n){var r,o,a=yield this.getDbAccount(),c=(yield this.engine.getNetwork(this.networkId)).rpcURL,u=new h.JsonRpcProvider(c),s=a.address,d=(yield this.getSigners(n.password||"",[a.address]))[s],l=null==(r=t.inputs)||null==(o=r[0])?void 0:o.publicKey;if(!l)throw new w.p("Unable to get sender public key.");var f=t.payload.encodedTx,p=yield Object(x.m)(u,s,f),y=yield Object(x.k)(u,p),v=yield d.sign(e.from(y.getData())),g=i()(v,1)[0];return{txid:"",rawTx:p,signatureScheme:"ed25519",signature:Object(T.a)(g.toString("hex")),publicKey:Object(T.a)(l)}}));return function(e,n){return t.apply(this,arguments)}}(),o.signMessage=function(){var e=a()((function*(e,t){return Promise.reject(new Error("Not implemented"))}));return function(t,n){return e.apply(this,arguments)}}(),u()(r)}(O.a)}).call(this,n(19).Buffer)},5195:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return te}));var r=n(2),i=n.n(r),o=n(460),a=n.n(o),c=n(172),u=n.n(c),s=n(10),d=n.n(s),l=n(765),f=n.n(l),p=n(3),y=n.n(p),h=n(6),v=n.n(h),g=n(9),w=n.n(g),b=n(12),m=n.n(b),O=n(5),T=n.n(O),x=n(183),j=n(61),I=n(27),E=n.n(I),k=n(126),P=n.n(k),A=n(112),C=n(113),S=n(56),B=n(22),D=n(21),R=n(57),N=n(3095),F=n(287),H=n(3069),U=n(4088),M=n(4089),K=n(4090),_=n(14),L=n(111);function W(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m()(this,n)}}var V=function(e){w()(n,e);var t=W(n);function n(){return t.apply(this,arguments)}return n.prototype.prepareAccounts=function(){var e=y()((function*(e){var t=e.name,n=e.target,r=e.accountIdPrefix,i=yield this.vault.validateAddress(n);if("undefined"===typeof i)throw new D.e;return Promise.resolve([{id:r+"--"+_.p+"--"+n,name:t||"",type:L.a.SIMPLE,path:"",coinType:_.p,pub:"",address:i}])}));return function(t){return e.apply(this,arguments)}}(),v()(n)}(n(3073).a),G=n(194),q=n.n(G),z=function(){function e(){}return e.isNft=function(e){return!!(e.fields.name&&e.fields.description&&e.fields.url)||!!e.fields.metadata},e.getNftObject=function(e,t){return{objectId:q()(e,"fields.id.id",""),name:e.fields.name,description:e.fields.description,url:e.fields.url,previousTransaction:t,objectType:e.type,fields:e.fields,hasPublicTransfer:!!e.has_public_transfer&&e.has_public_transfer}},v()(e)}();function J(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m()(this,n)}}var Q=function(e){w()(n,e);var t=J(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.tryGetPastObject=function(){var e=y()((function*(e,t){try{return yield this.client.requestWithType("sui_tryGetPastObject",[e,t],x.isGetObjectDataResponse,this.options.skipDataValidation)}catch(n){throw new Error("Error fetching object info: "+n+" for id "+e)}}));return function(t,n){return e.apply(this,arguments)}}(),r.tryGetPastObjectBatch=function(){var e=y()((function*(e){var t=e.map((function(e){return{method:"sui_tryGetPastObject",args:[e.objectId,e.version]}}));try{return yield this.client.batchRequestWithType(t,x.isGetObjectDataResponse,!0)}catch(n){throw new Error("Error fetching object info: "+n+" for id "+e)}}));return function(t){return e.apply(this,arguments)}}(),r.getOwnedObjects=function(){var e=y()((function*(e){var t=(yield this.getObjectsOwnedByAddress(e)).map((function(e){return e.objectId}));return(yield this.getObjectBatch(t)).filter((function(e){return"Exists"===e.status})).map((function(e){return Object(x.getObjectExistsResponse)(e)}))}));return function(t){return e.apply(this,arguments)}}(),r.getOwnedCoins=function(){var e=y()((function*(e){return(yield this.getOwnedObjects(e)).map((function(e){return{id:e.reference.objectId,object:Object(x.getMoveObject)(e)}})).filter((function(e){return e.object&&x.Coin.isCoin(e.object)})).map((function(e){return function(e){var t=x.Coin.getCoinTypeArg(e);return{objectId:q()(e,"fields.id.id",""),symbol:t?x.Coin.getCoinSymbol(t):"",balance:BigInt(e.fields.balance),object:e}}(e.object)}))}));return function(t){return e.apply(this,arguments)}}(),r.getGasObject=function(){var e=y()((function*(e,t){return(yield this.getOwnedCoins(e)).filter((function(e){return"SUI"===e.symbol})).find((function(e){return e.balance>=t}))}));return function(t,n){return e.apply(this,arguments)}}(),r.getOwnedNfts=function(){var e=y()((function*(e){return(yield this.getOwnedObjects(e)).map((function(e){return{id:e.reference.objectId,object:Object(x.getMoveObject)(e),previousTransaction:e.previousTransaction}})).filter((function(e){return e.object&&z.isNft(e.object)})).map((function(e){var t=e.object;return z.getNftObject(t,e.previousTransaction)}))}));return function(t){return e.apply(this,arguments)}}(),v()(n)}(x.JsonRpcProvider),X=n(2102),$=n(1148);function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ee(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m()(this,n)}}var te=function(e){w()(n,e);var t=ee(n);function n(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).keyringMap={hd:M.a,hw:U.a,imported:K.a,watching:V,external:V},e.settings=X.default,e.getClientCache=P()(function(){var t=y()((function*(t){return e.getSuiClient(t)}));return function(e){return t.apply(this,arguments)}}(),{promise:!0,max:1,maxAge:Object(S.b)({minute:3})}),e}var r=n.prototype;return r.getClient=function(){var e=y()((function*(){var e=(yield this.engine.getNetwork(this.networkId)).rpcURL;return this.getClientCache(e)}));return function(){return e.apply(this,arguments)}}(),r.getSuiClient=function(e){return new Q(e,{faucetURL:"https://faucet.testnet.sui.io/gas"})},r.getClientEndpointStatus=function(){var e=y()((function*(e){var t=yield this.getClientCache(e),n=performance.now(),r=yield t.getTotalTransactionNumber();return{responseTime:Math.floor(performance.now()-n),latestBlock:r}}));return function(t){return e.apply(this,arguments)}}(),r._getPublicKey=function(){var e=y()((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.prefix,n=void 0===t||t,r=yield this.getDbAccount(),i=r.pub;return n&&(i=Object(F.a)(i)),Promise.resolve(i)}));return function(){return e.apply(this,arguments)}}(),r.validateAddress=function(){var e=y()((function*(e){return Object(x.isValidSuiAddress)(e)?Promise.resolve(e):Promise.reject(new D.e)}));return function(t){return e.apply(this,arguments)}}(),r.validateWatchingCredential=function(e){var t=this;return this.validateAddress(e).then((function(e){return t.settings.watchingAccountEnabled&&!!e})).catch((function(){return!1}))},r.checkAccountExistence=function(){var e=y()((function*(e){var t=yield this.getClient();return"Exists"===(yield t.getObject(Object(F.c)(e))).status}));return function(t){return e.apply(this,arguments)}}(),r.getObjectsOwnedByAddress=function(){var e=y()((function*(e,t){var n=yield this.getClient(),r=yield n.getCoinBalancesOwnedByAddress(e,t),i=[];for(var o of r){var a=Object(x.getObjectExistsResponse)(o);a&&i.push(a)}return i.map((function(e){return e.data})).reduce((function(e,t){var n,r=x.Coin.getCoinTypeArg(t);r&&("undefined"===typeof e[r]&&(e[r]=BigInt(0)),e[r]+=null!=(n=x.Coin.getBalance(t))?n:BigInt(0));return e}),{})}));return function(t,n){return e.apply(this,arguments)}}(),r.getBalances=function(){var e=y()((function*(e){var t=this,n=f()(e,(function(e){return e.address})),r=new Map;return yield Promise.all(Object.entries(n).map(function(){var e=y()((function*(e){var n=d()(e,2),i=n[0],o=n[1];try{var a=yield t.getObjectsOwnedByAddress(i);o.forEach((function(e){var t,n,o=e.tokenAddress,c=null!=o?o:$.b,u=null!=(t=null==(n=a[c])?void 0:n.toString())?t:"0",s=i+"-"+c;try{r.set(s,new E.a(u))}catch(d){}}))}catch(c){}}));return function(t){return e.apply(this,arguments)}}())),e.map((function(e){var t,n=e.address,i=e.tokenAddress,o=n+"-"+(null!=i?i:$.b);return null!=(t=r.get(o))?t:new E.a(0)}))}));return function(t){return e.apply(this,arguments)}}(),r.activateAccount=function(){var e=y()((function*(){var e=yield this.getClient();yield e.requestSuiFromFaucet(yield this.getAccountAddress())}));return function(){return e.apply(this,arguments)}}(),r.fetchTokenInfos=function(){var e=y()((function*(e){var t=yield this.getClient();return Promise.all(e.map(function(){var e=y()((function*(e){try{var n=yield t.getCoinMetadata(e);return yield Promise.resolve({name:n.name,symbol:n.symbol,decimals:n.decimals})}catch(r){}}));return function(t){return e.apply(this,arguments)}}()))}));return function(t){return e.apply(this,arguments)}}(),r.validateTokenAddress=function(){var e=y()((function*(e){var t=e.split("::"),n=d()(t,3),r=n[0],i=n[1],o=n[2];if(i&&o)try{return(yield this.validateAddress(r)).toLowerCase()+"::"+i+"::"+o}catch(a){}throw new D.h}));return function(t){return e.apply(this,arguments)}}(),r.attachFeeInfoToEncodedTx=function(){var e=y()((function*(e){var t=e.feeInfoValue,n=t.price,r=t.limit;if("undefined"!==typeof n&&"string"!==typeof n)throw new D.p("Invalid gas price.");if("string"!==typeof r)throw new D.p("Invalid fee limit");var i=e.encodedTx.data;return i&&"gasBudget"in i&&(i.gasBudget=parseInt(r)),Promise.resolve(e.encodedTx)}));return function(t){return e.apply(this,arguments)}}(),r.decodedTxToLegacy=function(e){return Promise.resolve({})},r.decodeTx=function(){var e=y()((function*(e,t){var n,r,i,o,a,c,s,l=yield this.engine.getNetwork(this.networkId),f=yield this.getDbAccount(),p=yield this.engine.getNativeTokenInfo(this.networkId),y=yield this.getClient(),h=yield this.getAccountAddress();if("bytes"===e.kind)try{var v=new x.LocalTxnDataSerializer(yield this.getClient()),g=yield v.deserializeTransactionBytesToSignableTransaction(!0,new x.Base64DataBuffer(Object($.h)(e.data)));if(u()(g))s=d()(g,1)[0];else s=g}catch(V){throw new D.m("Invalid transaction data.")}else s=e;if(!s)throw new D.m("Invalid transaction data.");var w=[],b=s,m=b.kind,O=b.data,T=0;switch(O&&"gasBudget"in O&&(T=O.gasBudget),m){case"pay":var j=yield Object($.g)(y,O);if(j){var I,k,P,A,C="nativeTransfer";if(!j.isNative){if(C="tokenTransfer",!j.coinType)throw new D.p("Invalid coin type");if(!(p=yield this.engine.ensureTokenInDB(this.networkId,j.coinType)))throw new D.p("Invalid coin type")}w.push(((A={type:j.type})[C]={tokenInfo:p,from:h,to:j.recipient,amount:new E.a(null!=(I=j.amount.toString())?I:"0").shiftedBy(-p.decimals).toFixed(),amountValue:null!=(k=null==(P=j.amount)?void 0:P.toString())?k:"0",extraInfo:null},A))}break;case"transferSui":w.push({type:R.a.NATIVE_TRANSFER,nativeTransfer:{tokenInfo:p,from:h,to:O.recipient,amount:new E.a(null!=(n=O.amount)?n:"0").shiftedBy(-p.decimals).toFixed(),amountValue:null!=(r=null==(i=O.amount)?void 0:i.toString())?r:"0",extraInfo:null}});break;case"paySui":for(var S=new Map,B=0;B<O.recipients.length;B+=1){var F,H=O.recipients[B],U=O.amounts[B];S.set(H,(null!=(F=S.get(H))?F:new E.a(0)).plus(new E.a(U)))}for(var M of S.entries()){var K=d()(M,2),_=K[0],L=K[1];w.push({type:R.a.NATIVE_TRANSFER,nativeTransfer:{tokenInfo:p,from:h,to:_,amount:L.shiftedBy(-p.decimals).toFixed(),amountValue:L.toString(),extraInfo:null}})}break;case"payAllSui":w.push({type:R.a.NATIVE_TRANSFER,nativeTransfer:{tokenInfo:p,from:h,to:O.recipient,amount:"All",amountValue:"All",extraInfo:null}});break;case"moveCall":w.push({type:R.a.FUNCTION_CALL,functionCall:{target:Object($.l)(O.function),functionName:null!=(o=O.packageObjectId)?o:"",args:null!=(a=O.arguments)?a:[],extraInfo:null}});break;default:w.push({type:R.a.UNKNOWN,direction:R.b.OTHER,unknownAction:{extraInfo:{}}})}var W={txid:"",owner:f.address,signer:f.address,nonce:0,actions:w,status:R.c.Pending,networkId:this.networkId,accountId:this.accountId,feeInfo:{price:Object(N.d)({value:"1",network:l}),limit:null==(c=T)?void 0:c.toString()},extraInfo:null,encodedTx:e};return Promise.resolve(W)}));return function(t,n){return e.apply(this,arguments)}}(),r.buildEncodedTxFromTransfer=function(){var e=y()((function*(e){var t,n=e.to,r=e.amount,i=e.token,o=(yield this.getDbAccount()).address,c=Object(F.a)(n),u=Object(F.a)(o),s=null==i||a()(i);if(s){var d=yield this.getNetwork();t=new E.a(r).shiftedBy(d.decimals).toFixed()}else{var l=yield this.engine.ensureTokenInDB(this.networkId,i);if("undefined"===typeof l)throw new D.p("Failed to get token info.");t=new E.a(r).shiftedBy(l.decimals).toFixed()}var f=yield this.getClient(),p=s?$.b:i,y=yield f.getCoinBalancesOwnedByAddress(u,p),h=x.Coin.totalBalance(y),v=Object($.d)(y,t),g=s?BigInt(t)+BigInt(v):BigInt(t);g>h&&(g=h);var w=x.Coin.selectCoinSetWithCombinedBalanceGreaterThanOrEqual(y,g);if(0===w.length)throw new D.c;var b,m={inputCoins:w.map((function(e){return Object(x.getObjectId)(e)})),recipients:[c],amounts:[parseInt(t)],gasBudget:v};if(s)b={kind:"paySui",data:Y({},m)};else{var O=yield f.selectCoinsWithBalanceGreaterThanOrEqual(u,BigInt(v),$.a),T=x.Coin.selectCoinWithBalanceGreaterThanOrEqual(O,BigInt(v));if(!T)throw new D.p("Failed to get gas coin.");b={kind:"pay",data:Y(Y({},m),{},{gasPayment:Object(x.getObjectId)(T)})}}return b}));return function(t){return e.apply(this,arguments)}}(),r.buildEncodedTxFromApprove=function(e){throw new D.k},r.updateEncodedTxTokenApprove=function(e,t){throw new D.k},r.updateEncodedTx=function(){var e=y()((function*(e,t,n){if("transfer"===n.type&&"paySui"===e.kind){var r=e.data;if(1===r.recipients.length)return Promise.resolve({kind:"payAllSui",data:{inputCoins:r.inputCoins.reverse(),recipient:r.recipients[0],gasBudget:r.gasBudget}})}return Promise.resolve(e)}));return function(t,n,r){return e.apply(this,arguments)}}(),r.buildUnsignedTxFromEncodedTx=function(){var e=y()((function*(e){var t=e,n=yield this.getDbAccount();return Promise.resolve({inputs:[{address:Object(F.c)(n.address),value:new E.a(0),publicKey:Object(F.c)(n.pub)}],outputs:[],payload:{encodedTx:t},encodedTx:t})}));return function(t){return e.apply(this,arguments)}}(),r.fetchFeeInfo=function(){var e=y()((function*(e){var t,n=yield this.getClient(),r=yield Promise.all([this.getNetwork(),this.buildUnsignedTxFromEncodedTx(e)]),i=d()(r,2),o=i[0],a=i[1],c=Object(N.d)({value:"1",network:o});if("bytes"===e.kind)try{var s,l,f=new x.LocalTxnDataSerializer(yield this.getClient()),p=yield f.deserializeTransactionBytesToSignableTransaction(!0,new x.Base64DataBuffer(Object($.h)(e.data)));if("gasBudget"in(s=u()(p)?p[0].data:p.data))return{disableEditFee:!0,nativeSymbol:o.symbol,nativeDecimals:o.decimals,feeSymbol:o.feeSymbol,feeDecimals:o.feeDecimals,limit:null==(l=s.gasBudget)?void 0:l.toString(),prices:[c],defaultPresetIndex:"0"}}catch(k){}var y=yield Object($.m)(n,yield this.getAccountAddress(),a.encodedTx),h=a.encodedTx;try{var v=yield n.dryRunTransaction(y);if(!v)throw new D.m;var g,w,b,m=(null==v||null==(g=v.gasUsed)?void 0:g.computationCost)||0,O=(null==(w=v.gasUsed)?void 0:w.storageCost)||0,T=(null==(b=v.gasUsed)?void 0:b.storageRebate)||0,j=new E.a(m+O-T);if(j.isEqualTo(0))throw new D.m;t=j.multipliedBy(2).toFixed()}catch(P){if("paySui"!==h.kind)throw new D.m;var I=h.data;t=Object($.c)(I.inputCoins.length).toString()}return{nativeSymbol:o.symbol,nativeDecimals:o.decimals,feeSymbol:o.feeSymbol,feeDecimals:o.feeDecimals,limit:t,prices:[c],defaultPresetIndex:"0"}}));return function(t){return e.apply(this,arguments)}}(),r.broadcastTransaction=function(){var e=y()((function*(e){var t=yield this.getClient();B.a.engine.info("broadcastTransaction START:",{rawTx:e.rawTx});try{var n=e.signature,r=e.signatureScheme,i=e.publicKey,o="ED25519";switch(r){case"ed25519":o="ED25519";break;case"secp256k1":o="Secp256k1";break;default:throw new D.p("Unsupported signature scheme")}if(!n)throw new Error("signature is empty");if(!i)throw new Error("publicKey is empty");var a=yield t.executeTransaction(new x.Base64DataBuffer(e.rawTx),o,new x.Base64DataBuffer(Object(j.hexToBytes)(Object(F.c)(n))),new x.Ed25519PublicKey(Object(j.hexToBytes)(Object(F.c)(i)))),c=Object(x.getTransactionDigest)(a);return B.a.engine.info("broadcastTransaction Done:",{txid:c,rawTx:e.rawTx,transactionResponse:a}),Y(Y({},e),{},{txid:c})}catch(f){var u=f||{},s=u.errorCode,d=u.message,l=(null!=s?s:"")+" "+d;throw-1!==d.indexOf("Insufficient gas:")?new D.p(l,"msg__broadcast_tx_Insufficient_fee"):new D.p(l)}}));return function(t){return e.apply(this,arguments)}}(),r.getExportedCredential=function(){var e=y()((function*(e){var t=yield this.getDbAccount();if(t.id.startsWith("hd-")||t.id.startsWith("imported")){var n=this.keyring,r=Object.values(yield n.getPrivateKeys(e)),i=d()(r,1)[0];return"0x"+Object(A.a)(e,i).toString("hex")}throw new D.p("Only credential of HD or imported accounts can be exported")}));return function(t){return e.apply(this,arguments)}}(),r.fetchOnChainHistory=function(){var e=y()((function*(e){var t=this,n=e.localHistory,r=void 0===n?[]:n;if(e.tokenIdOnNetwork)return Promise.resolve([]);var i=yield this.getClient(),o=yield this.getDbAccount(),a=(yield this.engine.getNativeTokenInfo(this.networkId)).decimals,c=yield i.getTransactionsForAddress(o.address);if(!c||!c.length)return[];var u=(yield i.getTransactionWithEffectsBatch(Object($.i)(c))).map(function(){var e=y()((function*(e){var n=r.find((function(t){return t.decodedTx.txid===Object(x.getTransactionDigest)(e)}));if(n&&n.decodedTx.isFinal)return Promise.resolve(null);try{var c,u,s=yield t.engine.getNativeTokenInfo(t.networkId),d=Object(x.getExecutionStatus)(e),l="success"===(null==d?void 0:d.status),f="failure"===(null==d?void 0:d.status),p=Object(x.getCertifiedTransaction)(e);if(!p)throw new Error("current transaction is empty, continue");var h=Object(x.getTimestampFromTransactionResponse)(e),v=(Object(x.getTransactionData)(p),Object(x.getTransactions)(p)),g=Object(x.getTransactionSender)(p),w=[],b="";yield Promise.all(v.map(function(){var e=y()((function*(e){var n,r,o,a=Object($.j)(e),c="bigint"===typeof a?a:Object.values(a||{})[0],u=(Object(x.getTransferObjectTransaction)(e),Object(x.getPublishTransaction)(e),Object(x.getMoveCallTransaction)(e));if(u)return w.push({type:R.a.FUNCTION_CALL,functionCall:{target:Object($.l)(u.function),functionName:null!=(n=null==(r=u.package)?void 0:r.objectId)?n:"",args:null!=(o=u.arguments)?o:[],extraInfo:null}}),!0;var d=Object(x.getTransferSuiTransaction)(e);if(d)return b=d.recipient,w.push({type:R.a.NATIVE_TRANSFER,nativeTransfer:{tokenInfo:s,from:g,to:b,amount:new E.a(c.toString()).shiftedBy(-s.decimals).toFixed(),amountValue:c.toString(),extraInfo:null}}),!0;var l=Object(x.getPayTransaction)(e),f=yield Object($.f)(i,l);if(l&&f){if(f){var p,y,h,v;b=f.recipient;var m="nativeTransfer",O=s;if(!f.isNative){if(m="tokenTransfer",!f.coinType)throw new D.p("Invalid coin type");if(!(O=yield t.engine.ensureTokenInDB(t.networkId,f.coinType)))throw new D.p("Invalid coin type")}w.push(((v={type:f.type})[m]={tokenInfo:O,from:g,to:b,amount:new E.a(null!=(p=f.amount)?p:"0").shiftedBy(-O.decimals).toFixed(),amountValue:null!=(y=null==(h=f.amount)?void 0:h.toString())?y:"0",extraInfo:null},v))}return!0}var T=Object(x.getPaySuiTransaction)(e);if(T){var j;if(b=null!=(j=T.recipients[0])?j:"","bigint"===typeof a)w.push({type:R.a.NATIVE_TRANSFER,nativeTransfer:{tokenInfo:s,from:g,to:b,amount:new E.a(c.toString()).shiftedBy(-s.decimals).toFixed(),amountValue:c.toString(),extraInfo:null}});else Object.keys(a||{}).forEach((function(e){var t=a[e];if(!t)return!0;w.push({type:R.a.NATIVE_TRANSFER,nativeTransfer:{tokenInfo:s,from:g,to:b,amount:new E.a(t.toString()).shiftedBy(-s.decimals).toFixed(),amountValue:t.toString(),extraInfo:null}})}));return!0}var I=Object(x.getPayAllSuiTransaction)(e),k=yield Object($.e)(i,I);if(I&&k)return b=I.recipient,w.push({type:R.a.NATIVE_TRANSFER,nativeTransfer:{tokenInfo:s,from:g,to:b,amount:new E.a(k.amount.toString()).shiftedBy(-s.decimals).toFixed(),amountValue:k.amount.toString(),extraInfo:null}}),!0;w.push({type:R.a.UNKNOWN,direction:R.b.OTHER,unknownAction:{extraInfo:{}}})}));return function(t){return e.apply(this,arguments)}}()));var m={from:g,to:b,value:""},O=null!=(c=Object(x.getTotalGasUsed)(e))?c:"0",T=R.c.Pending;f?T=R.c.Failed:l&&(T=R.c.Confirmed);var j={txid:Object(x.getTransactionDigest)(e),owner:o.address,signer:g,nonce:0,actions:w,status:T,networkId:t.networkId,accountId:t.accountId,encodedTx:m,extraInfo:null,totalFeeInNative:new E.a(O).shiftedBy(-a).toFixed()};return j.updatedAt=h,j.createdAt=null!=(u=null==n?void 0:n.decodedTx.createdAt)?u:j.updatedAt,j.isFinal=j.status===R.c.Confirmed,yield t.buildHistoryTx({decodedTx:j,historyTxToMerge:n})}catch(I){B.a.common.error(I)}return Promise.resolve(null)}));return function(t){return e.apply(this,arguments)}}());return(yield Promise.all(u)).filter(Boolean)}));return function(t){return e.apply(this,arguments)}}(),r.getTransactionStatuses=function(){var e=y()((function*(e){var t=yield this.getClient(),n=yield t.getTransactionWithEffectsBatch(e),r=new Map;return n.forEach(function(){var e=y()((function*(e){var t=Object(x.getTransactionDigest)(e);try{var n=Object(x.getExecutionStatus)(e),i="success"===(null==n?void 0:n.status),o="failure"===(null==n?void 0:n.status),a=C.a.PENDING;o?a=C.a.CONFIRM_BUT_FAILED:i&&(a=C.a.CONFIRM_AND_SUCCESS),r.set(t,a)}catch(c){-1!==c.message.indexOf("Could not find the referenced transaction")&&r.set(t,C.a.NOT_FOUND)}}));return function(t){return e.apply(this,arguments)}}()),e.map((function(e){return r.get(e)}))}));return function(t){return e.apply(this,arguments)}}(),r.getTransactionByTxId=function(){var e=y()((function*(e){var t=yield this.getClient();return yield t.getTransactionWithEffects(e)}));return function(t){return e.apply(this,arguments)}}(),v()(n)}(H.a)}}]);