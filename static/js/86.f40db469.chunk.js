(this.webpackJsonp=this.webpackJsonp||[]).push([[86],{3083:function(e,t,n){"use strict";var r,o,c;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c})),function(e){e.Swap="Swap",e.Input="Input",e.Output="Output",e.Settings="Settings",e.CustomToken="CustomToken",e.Transaction="Transaction",e.Webview="Webview",e.Share="Share",e.SwftcHelp="SwftcHelp",e.PickRecipient="PickRecipient",e.PickAccount="PickAccount",e.EnterAddress="EnterAddress",e.Welcome="Welcome",e.SelectRoutes="SelectRoutes",e.Send="Send"}(r||(r={})),function(e){e.QuoteFailed="QuoteFailed",e.InsufficientBalance="InsufficientBalance",e.NotSupport="NotSupport",e.DepositMax="DepositMax",e.DepositMin="DepositMin"}(o||(o={})),function(e){e.swftc="swftc",e.socket="socket",e.mdex="mdex",e.zeroX="0x",e.jupiter="jupiter"}(c||(c={}))},3149:function(e,t,n){"use strict";n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return f}));var r=n(10),o=n.n(r),c=n(20),i=n.n(c),s=n(1),a=n(43),u=n(42);function l(){var e=function(){var e=Object(u.d)((function(e){return e.swapTransactions.transactions}));return Object(s.useMemo)((function(){var t=Object.values(e).reduce((function(e,t){return e.concat.apply(e,i()(Object.values(t)))}),[]);return i()(t).sort((function(e,t){return e.addedTime>t.addedTime?-1:1}))}),[e])}();return Object(s.useMemo)((function(){return e.filter((function(e){return"swap"===e.type}))}),[e])}function d(){var e=Object(u.d)((function(e){return e.runtime.wallets}));return Object(s.useMemo)((function(){return e.reduce((function(e,t){return e.concat(t.accounts.map((function(e){return{accountId:e,walletId:t.id}})))}),[])}),[e])}function j(){var e=l(),t=d(),n=Object(u.d)((function(e){return e.runtime.networks})),r=Object(s.useMemo)((function(){return n.map((function(e){return e.id}))}),[n]),o=Object(s.useMemo)((function(){return t.map((function(e){return e.accountId}))}),[t]);return e.filter((function(e){return o.includes(e.accountId)&&r.includes(e.networkId)}))}function f(e){var t=d(),n=Object(s.useState)((function(){return t.find((function(t){return t.accountId===e}))?void 0:null})),r=o()(n,2),c=r[0],i=r[1];return Object(s.useEffect)((function(){var n=t.find((function(t){return t.accountId===e}));n&&a.a.engine.getAccounts([n.accountId]).then((function(e){var t=o()(e,1)[0];t&&i(t)}))}),[t,e]),c}},3194:function(e,t,n){"use strict";n.d(t,"e",(function(){return O})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return x})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return v}));var r=n(20),o=n.n(r),c=n(3),i=n.n(c),s=n(10),a=n.n(s),u=n(1),l=n(114),d=n(43),j=n(176),f=n(3082),b=n(749),O=function(e,t){var n=Object(u.useState)(!1),r=a()(n,2),o=r[0],c=r[1],s=Object(u.useState)(),l=a()(s,2),j=l[0],f=l[1],b=Object(u.useRef)({keyword:"",count:0});return Object(u.useEffect)((function(){function n(){return(n=i()((function*(t,n){if(0!==t.length){c(!0),f([]);var r=[];try{b.current.count+=1,r=yield d.a.serviceSwap.searchTokens({networkId:null!=n?n:void 0,keyword:e}),t===b.current.keyword&&n===b.current.networkId&&f(r)}finally{b.current.count-=1,0===b.current.count&&c(!1)}}else f(void 0)}))).apply(this,arguments)}b.current.keyword=e,b.current.networkId=t,function(e,t){n.apply(this,arguments)}(e,t)}),[e,t]),{loading:o,result:j}},h=function(e,t){var n=Object(j.c)(e,t);return Object(j.v)(n,2e3)},p=function(e,t){var n=h(null==e?void 0:e.networkId,t);return Object(u.useEffect)((function(){e&&t&&d.a.serviceToken.fetchTokenBalance({activeAccountId:t,activeNetworkId:e.networkId,tokenIds:e.tokenIdOnNetwork?[e.tokenIdOnNetwork]:[]})}),[e,t]),Object(u.useMemo)((function(){var t,r;if(e)return null!=(t=null==(r=n[Object(l.g)(e)])?void 0:r.balance)?t:"0"}),[n,e])},x=function(e){var t=Object(f.b)({networkId:null==e?void 0:e.networkId,contractAdress:null==e?void 0:e.tokenIdOnNetwork});return Object(u.useMemo)((function(){if(e)return t}),[t,e])};function m(e){var t=Object(j.h)((function(e){return e.swapTransactions.tokenList}));return Object(u.useMemo)((function(){var n;if(!t)return[];var r=e;r||(r="All");var o=t.find((function(e){return e.networkId===r}));return null!=(n=null==o?void 0:o.tokens)?n:[]}),[t,e])}function v(e,t){var n=m(e),r=Object(j.b)(e,t),c=h(e,t);return Object(u.useMemo)((function(){var e=[].concat(o()(n),o()(r)),t=new Set,i=function(e){return""+e.networkId+e.tokenIdOnNetwork},s=e.filter((function(e){return!t.has(i(e))&&(t.add(i(e)),!0)})),a=function(e){var t,n,r=e||"main";return Boolean(c[r]&&Number(Object(b.g)(null!=(t=null==(n=c[r])?void 0:n.balance)?t:"0",6))>0)};if(!c)return s;var u=s.filter((function(e){return a(e.tokenIdOnNetwork)})),l=s.filter((function(e){return!a(e.tokenIdOnNetwork)}));return u.concat(l)}),[n,r,c])}},3254:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(70),o=n(110),c=n(32),i=n(268),s=n(0);function a(e){return"https://node.onekey.so/proxyimg?base="+e}var u=function(e){var t=e.sources,n=e.size||4;if(!t||0===t.length)return null;if(1===t.length)return Object(s.jsx)(c.a,{borderRadius:"full",w:n,h:n,overflow:"hidden",bgColor:"surface-neutral-default",children:Object(s.jsx)(i.a,{size:n,src:a(t[0]),testID:t[0]})},t[0]);var r=function(e,t){return e<=0?0:-t/2};return Object(s.jsx)(c.a,{flexDirection:"row",alignItems:"center",children:t.map((function(e,t){return Object(s.jsx)(o.a,{ml:r(t,n),borderRadius:"full",h:n,w:n,overflow:"hidden",bgColor:"surface-neutral-default",children:Object(s.jsx)(i.a,{size:n,src:a(e)})},e)}))})};t.b=function(e){var t=e.providers,n=e.typography,o=void 0===n?"Caption":n,i=e.color,a=void 0===i?"text-subdued":i,l=e.fontWeight,d=void 0===l?400:l;if(!t)return Object(s.jsx)(c.a,{flexDirection:"row",flexGrow:1,children:Object(s.jsx)(r.a,{typography:o,color:a,isTruncated:!0,children:"OneKey Swap"})});if(1===t.length)return Object(s.jsxs)(c.a,{flexDirection:"row",alignItems:"center",flexGrow:1,children:[t[0].logoUrl?Object(s.jsx)(u,{sources:[t[0].logoUrl]}):null,Object(s.jsx)(r.a,{ml:2,typography:o,color:a,fontWeight:d,isTruncated:!0,children:t[0].name})]});if(t.length>1){var j=t.map((function(e){return e.logoUrl})).filter(Boolean);return Object(s.jsxs)(c.a,{alignItems:"center",flexDirection:"row",flexGrow:1,children:[j.length>0?Object(s.jsx)(u,{sources:j}):null,Object(s.jsxs)(r.a,{ml:"2",typography:o,color:a,fontWeight:d,isTruncated:!0,children:[t.length," Exchanges"]})]})}return Object(s.jsx)(c.a,{alignItems:"center",flexDirection:"row",flexGrow:1,children:Object(s.jsx)(r.a,{typography:o,color:a,children:"OneKey Swap"})})}},3314:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return u}));var r=n(1),o=n(508),c=n(176),i=n(749),s=n(3194);function a(){var e=Object(o.a)();return Object(r.useCallback)((function(t){var n;if("approve"===t.type)return t.approval?e.formatMessage({id:"title__approve"})+" "+(null==(n=t.approval)?void 0:n.token.symbol):""+e.formatMessage({id:"title__approve"});if("swap"===t.type&&t.tokens){var r=t.tokens,o=r.from,c=r.to;return Object(i.g)(o.amount,4)+" "+o.token.symbol+" \u2192 "+(Object(i.g)(c.amount,4)+" "+c.token.symbol)}return""}),[e])}function u(){var e=Object(c.h)((function(e){return e.swap.inputToken})),t=Object(c.h)((function(e){return e.swap.outputToken})),n=Object(s.d)(e),r=Object(s.d)(t),o=Object(c.h)((function(e){var t;return null==(t=e.swap.quote)?void 0:t.instantRate}));if(r&&n&&o){var a=Object(i.e)(n,r);if(Object(i.p)(o,a)){var u=Object(i.r)(Object(i.e)(Object(i.q)(a,o),a),100);return Number(u)}}}},3772:function(e,t,n){"use strict";n.r(t);var r=n(85),o=n(285),c=n(186),i=n(1114),s=n(41),a=n(10),u=n.n(a),l=n(743),d=n(32),j=n(387),f=n(1),b=n(52),O=n(3011),h=n(508),p=n(43),x=n(3065),m=n(3149),v=n(2),g=n.n(v),w=n(125),k=n(110),y=n(79),I=n(742),_=n(744),S=n(1109),T=n(176),D=n(142),M=n(3254),B=n(3083),C=n(749),R=n(0);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){g()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var N=function(e){var t=e.status,n=Object(h.a)();return Object(R.jsxs)(d.a,{children:["pending"===t?Object(R.jsx)(S.a,{type:"info",size:"sm",color:"#599BFF",title:n.formatMessage({id:"transaction__pending"})}):null,"failed"===t?Object(R.jsx)(S.a,{type:"critical",size:"sm",color:"text-critical",title:n.formatMessage({id:"transaction__failed"})}):null,"canceled"===t?Object(R.jsx)(S.a,{type:"critical",size:"sm",color:"text-critical",title:n.formatMessage({id:"transaction__failed"})}):null,"sucesss"===t?Object(R.jsx)(S.a,{type:"success",size:"sm",color:"text-success",title:n.formatMessage({id:"transaction__success"})}):null]})},z=function(e){var t,n,r,o,c,i,a,u,l=e.isFirst,j=e.isLast,h=e.tx,p=Object(_.a)().themeVariant,x=Object(b.u)(),m=null==(t=h.tokens)?void 0:t.from.networkId,v=null==(n=h.tokens)?void 0:n.to.networkId,g=Object(T.r)(m),S=Object(T.r)(v),P=Object(f.useCallback)((function(){x.navigate(D.c.Modal,{screen:D.b.Swap,params:{screen:B.c.Transaction,params:{txid:h.hash,goBack:function(){return x.goBack()}}}})}),[x,h.hash]),W=Object(f.useCallback)((function(e){var t=e.token,n=e.amount;return t&&n?Object(C.g)(n)+" "+t.symbol.toUpperCase():"-"}),[]);return Object(R.jsx)(d.a,{px:"4",children:Object(R.jsxs)(w.a,{bg:"surface-default",p:"4",onPress:P,borderTopRadius:l?"12":void 0,borderBottomRadius:j?"12":void 0,borderLeftWidth:.5,borderRightWidth:.5,borderTopWidth:l?"0.5":void 0,borderBottomWidth:j?"0.5":void 0,borderColor:"light"===p?"border-subdued":"transparent",flexDirection:"row",alignItems:"center",children:[Object(R.jsxs)(d.a,{flexDirection:"row",alignItems:"center",flexBasis:"30%",children:[Object(R.jsx)(d.a,{mr:"4",children:Object(R.jsx)(I.c,{token:{logoURI:null==(r=h.tokens)?void 0:r.from.token.logoURI},size:"8"})}),Object(R.jsxs)(d.a,{children:[Object(R.jsx)(s.h.Body1Strong,{children:W({token:null==(o=h.tokens)?void 0:o.from.token,amount:null==(c=h.tokens)?void 0:c.from.amount})}),Object(R.jsx)(s.h.Body2,{color:"text-subdued",children:null==g?void 0:g.shortName})]})]}),Object(R.jsxs)(d.a,{flexDirection:"row",alignItems:"center",flexBasis:"35%",children:[Object(R.jsx)(k.a,{h:"4",w:"8",my:"1",children:Object(R.jsx)(y.a,{name:"ArrowRightMini",size:16})}),Object(R.jsxs)(d.a,{flexDirection:"row",alignItems:"center",flex:"1",children:[Object(R.jsx)(d.a,{mr:"4",children:Object(R.jsx)(I.c,{token:{logoURI:null==(i=h.tokens)?void 0:i.to.token.logoURI},size:"8"})}),Object(R.jsxs)(d.a,{flex:"1",children:[Object(R.jsxs)(d.a,{flexDirection:"row",alignItems:"center",children:[Object(R.jsx)(s.h.Caption,{mr:"1",children:"\u2248"}),Object(R.jsx)(d.a,{flex:"1",children:Object(R.jsx)(s.h.Body1Strong,{isTruncated:!0,children:W({token:null==(a=h.tokens)?void 0:a.to.token,amount:null==(u=h.tokens)?void 0:u.to.amount})})})]}),Object(R.jsx)(s.h.Body2,{color:"text-subdued",children:null==S?void 0:S.shortName})]})]})]}),Object(R.jsx)(d.a,{flexBasis:"20%",alignItems:"center",justifyContent:"flex-start",flexDirection:"row",px:"1",children:Object(R.jsx)(M.b,{providers:h.providers,typography:"Body2Strong",color:"text-default"})}),Object(R.jsxs)(d.a,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",flex:"1",children:[Object(R.jsx)(N,{status:h.status}),Object(R.jsx)(d.a,{flex:1,flexDirection:"row",justifyContent:"flex-end",children:Object(R.jsx)(s.h.Body2,{color:"text-subdued",ml:"3",isTruncated:!0,children:Object(O.a)(h.addedTime,"HH:mm")})})]})]})})},A=function(e){var t,n,r,o,c,i,a,u,l=e.isFirst,j=e.isLast,h=e.tx,p=Object(_.a)().themeVariant,x=Object(b.u)(),m=null==(t=h.tokens)?void 0:t.from.networkId,v=null==(n=h.tokens)?void 0:n.to.networkId,g=Object(T.r)(m),S=Object(T.r)(v),P=Object(f.useCallback)((function(){x.navigate(D.c.Modal,{screen:D.b.Swap,params:{screen:B.c.Transaction,params:{txid:h.hash,goBack:function(){return x.goBack()}}}})}),[x,h.hash]),W=Object(f.useCallback)((function(e){var t=e.token,n=e.amount;return t&&n?Object(C.g)(n)+" "+t.symbol.toUpperCase():"-"}),[]);return Object(R.jsx)(d.a,{px:"4",children:Object(R.jsxs)(w.a,{bg:"surface-default",p:"4",onPress:P,borderTopRadius:l?"12":void 0,borderBottomRadius:j?"12":void 0,borderLeftWidth:.5,borderRightWidth:.5,borderTopWidth:l?"0.5":void 0,borderBottomWidth:j?"0.5":void 0,borderColor:"light"===p?"border-subdued":"transparent",children:[Object(R.jsxs)(d.a,{flexDirection:"row",width:"full",children:[Object(R.jsx)(d.a,{mr:"4",children:Object(R.jsx)(I.c,{token:{logoURI:null==(r=h.tokens)?void 0:r.from.token.logoURI},size:"8"})}),Object(R.jsxs)(d.a,{flexDirection:"row",alignItems:"center",flex:"1",flexWrap:"wrap",children:[Object(R.jsx)(s.h.Body1Strong,{mr:"2",children:W({token:null==(o=h.tokens)?void 0:o.from.token,amount:null==(c=h.tokens)?void 0:c.from.amount})}),Object(R.jsxs)(s.h.Body2,{color:"text-subdued",children:["(",null==g?void 0:g.shortName,")"]})]})]}),Object(R.jsx)(k.a,{h:"4",w:"8",my:"1",children:Object(R.jsx)(y.a,{name:"ArrowDownMini",size:16})}),Object(R.jsxs)(d.a,{flexDirection:"row",width:"full",children:[Object(R.jsx)(d.a,{mr:"4",children:Object(R.jsx)(I.c,{token:{logoURI:null==(i=h.tokens)?void 0:i.to.token.logoURI},size:"8"})}),Object(R.jsxs)(d.a,{flexDirection:"row",alignItems:"center",flex:"1",flexWrap:"wrap",children:[Object(R.jsx)(s.h.Caption,{mr:"1",children:"\u2248"}),Object(R.jsx)(s.h.Body1Strong,{mr:"2",children:W({token:null==(a=h.tokens)?void 0:a.to.token,amount:null==(u=h.tokens)?void 0:u.to.amount})}),Object(R.jsxs)(s.h.Body2,{color:"text-subdued",children:["(",null==S?void 0:S.shortName,")"]})]})]}),Object(R.jsxs)(d.a,{flexDirection:"row",width:"full",justifyContent:"space-between",mt:"3",children:[Object(R.jsxs)(d.a,{flexDirection:"row",alignItems:"center",pl:"2",children:[Object(R.jsx)(M.b,{providers:h.providers,typography:"Body2",color:"text-subdued",fontWeight:500}),Object(R.jsx)(s.h.Body2,{color:"text-subdued",ml:"3",fontWeight:500,children:Object(O.a)(h.addedTime,"HH:mm")})]}),Object(R.jsx)(N,{status:h.status})]})]})})},L=function(e){return Object(r.a)()?Object(R.jsx)(A,W({},e)):Object(R.jsx)(z,W({},e))},U=n(646),E=n(438),H=n(3314),F=function(){var e=Object(h.a)(),t=Object(m.b)().filter((function(e){return"pending"===e.status}));return t.length?Object(R.jsx)(d.a,{mt:"4",children:Object(R.jsx)(U.a,{title:e.formatMessage({id:"content__str_transactions_in_progress"},{content__str_transactions_in_progress:t.length}),dismiss:!1,actionType:"right",alertType:"info"})}):null},G=function(){var e=Object(h.a)(),t=Object(H.b)(),n=Object(m.b)().filter((function(e){return"failed"===e.status&&!e.archive})),r=Object(f.useCallback)((function(){n.forEach((function(e){p.a.dispatch(Object(E.b)({accountId:e.accountId,networkId:e.networkId,txs:[e.hash]}))}))}),[n]);return 0===n.length?null:1===n.length?Object(R.jsx)(d.a,{mt:"4",children:Object(R.jsx)(U.a,{title:t(n[0]),alertType:"error",onDismiss:r})}):Object(R.jsx)(d.a,{mt:"4",children:Object(R.jsx)(U.a,{title:e.formatMessage({id:"content__str_transactions_failed"},{0:n.length}),alertType:"error",onDismiss:r})})},q=function(){return Object(R.jsx)(k.a,{px:"4",children:Object(R.jsxs)(d.a,{width:"full",children:[Object(R.jsx)(F,{}),Object(R.jsx)(G,{})]})})},J=function(){return Object(R.jsx)(d.a,{mx:"4",children:Object(R.jsx)(j.a,{})})},K=function(){return Object(R.jsx)(d.a,{h:"4"})},Q=function(){var e=Object(h.a)();return Object(R.jsx)(d.a,{py:"8",children:Object(R.jsx)(l.a,{title:e.formatMessage({id:"transaction__history_empty_title"}),subTitle:e.formatMessage({id:"transaction__history_empty_desc"}),emoji:"\ud83d\udd50"})})};function V(e){var t=new Date(e);return""+Object(O.a)(t,"yyyy-MM-dd")}var X=function(){var e=Object(h.a)(),t=Object(b.u)(),n=Object(x.a)().format,r=Object(m.b)(),o=Object(f.useMemo)((function(){for(var e={},t=0;t<r.length;t+=1){var n=r[t],o=V(n.addedTime);e[o]||(e[o]=[]),e[o].push(n)}return Object.entries(e).map((function(e){var t=u()(e,2);return{title:t[0],data:t[1]}}))}),[r]);Object(f.useEffect)((function(){t.setOptions({title:e.formatMessage({id:"transaction__history"})})}),[t,e]);var c=Object(f.useCallback)((function(e){var t=e.index,n=e.section,r=e.item;return Object(R.jsx)(L,{isFirst:0===t,isLast:t===n.data.length-1,tx:r})}),[]),a=Object(f.useCallback)((function(e){return Object(R.jsx)(s.h.Subheading,{p:"4",color:"text-subdued",children:n(new Date(e.section.title),"LLL dd yyyy")})}),[n]);return Object(R.jsx)(i.a,{sections:o,renderSectionHeader:a,renderItem:c,ItemSeparatorComponent:J,ListFooterComponent:K,ListHeaderComponent:q,ListEmptyComponent:Q})},Y=function(){var e=Object(h.a)(),t=Object(f.useState)(!1),n=u()(t,2),r=n[0],i=n[1],s=Object(f.useCallback)((function(){i(!0)}),[]),a=Object(f.useCallback)((function(){p.a.serviceSwap.clearTransactions(),i(!1)}),[]);return Object(R.jsxs)(d.a,{px:"4",children:[Object(R.jsx)(c.a,{type:"plain",name:"TrashOutline",onPress:s}),Object(R.jsx)(o.a,{visible:r,contentProps:{iconName:"TrashMini",iconType:"danger",title:e.formatMessage({id:"action__clear_swap_history"}),content:e.formatMessage({id:"action__clear_swap_history_desc"})},footerButtonProps:{primaryActionTranslationId:"action__clear",primaryActionProps:{type:"destructive"},onPrimaryActionPress:a,onSecondaryActionPress:function(){i(!1)}}})]})},Z=function(e){var t=e.children,n=Object(b.u)(),o=Object(h.a)(),i=Object(r.a)(),a=Object(f.useCallback)((function(){n.goBack()}),[n]);return Object(f.useLayoutEffect)((function(){i?n.setOptions({headerRight:Y}):n.setOptions({headerShown:!1})}),[n,i]),i?Object(R.jsx)(d.a,{bg:"background-default",w:"full",h:"full",style:{maxWidth:768,marginHorizontal:"auto"},children:t}):Object(R.jsxs)(d.a,{bg:"background-default",w:"full",h:"full",px:"8",children:[Object(R.jsx)(d.a,{w:"full",flexDirection:"row",alignItems:"center",py:"5",children:Object(R.jsx)(c.a,{onPress:a,type:"plain",name:"ArrowLeftOutline"})}),Object(R.jsxs)(d.a,{display:"flex",justifyContent:"space-between",flexDirection:"row",mb:"8",children:[Object(R.jsx)(s.h.DisplayLarge,{px:"4",children:o.formatMessage({id:"title__swap_history"})}),Object(R.jsx)(Y,{})]}),t]})};t.default=function(){return Object(R.jsx)(Z,{children:Object(R.jsx)(X,{})})}}}]);