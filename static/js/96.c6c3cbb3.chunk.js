(this.webpackJsonp=this.webpackJsonp||[]).push([[96],{3062:function(e,t,n){"use strict";n.d(t,"a",(function(){return v.a}));var a=n(41),s=n(326),i=n(32),r=n(3),o=n.n(r),c=n(163),u=n(10),l=n.n(u),d=n(1),f=n(52),b=n(508),j=n(76),h=n(43),m=n(42),O=n(151),g=n(22),p=n(110),_=n(15),w=n(176),v=n(648),x=n(747),y=n(98),M=n(200),k=n(1125),A=n.n(k),E=n(745),S=n(3088),P=n(328),L=n(1124),B=n(0),T=function(e){var t=e.onOk,n=e.hideTitle,s=Object(b.a)(),r=Object(d.useRef)(),c=Object(m.d)((function(e){return e.settings.enableLocalAuthentication})),u=Object(E.a)({mode:"onBlur",reValidateMode:"onBlur",defaultValues:{password:""}}),l=u.control,f=u.handleSubmit,j=u.setError,O=Object(S.a)({useFormReturn:u,revalidate:!1,clearErrorIfEmpty:!0}).formValues,g=f(function(){var e=o()((function*(e){(yield h.a.serviceApp.verifyPassword(e.password))?null==t||t(e.password,!1):j("password",{message:s.formatMessage({id:"msg__wrong_password"})})}));return function(t){return e.apply(this,arguments)}}()),_=Object(d.useMemo)((function(){return A()(g,1e3,{trailing:!1})}),[g]),w=Object(d.useCallback)((function(e){null==t||t(e,!0)}),[t]);return Object(d.useEffect)((function(){c?Object(P.b)().then((function(e){e||setTimeout((function(){var e;return null==(e=r.current)?void 0:e.focus()}),100)})):setTimeout((function(){var e;return null==(e=r.current)?void 0:e.focus()}),100)}),[]),Object(B.jsxs)(x.a,{px:{base:n?0:4,md:0},children:[n?null:Object(B.jsxs)(i.a,{mb:"8",children:[Object(B.jsx)(a.h.DisplayLarge,{textAlign:"center",mb:2,children:s.formatMessage({id:"Verify_Password"})}),Object(B.jsx)(a.h.Body1,{textAlign:"center",color:"text-subdued",children:s.formatMessage({id:"Verify_password_to_continue"})})]}),Object(B.jsxs)(M.a,{children:[Object(B.jsx)(M.a.Item,{name:"password",defaultValue:"",control:l,rules:{minLength:{value:8,message:s.formatMessage({id:"msg__password_validation"})},maxLength:{value:128,message:s.formatMessage({id:"msg__password_validation"})}},children:Object(B.jsx)(M.a.PasswordInput,{ref:r,onSubmitEditing:g})}),Object(B.jsx)(y.a,{isDisabled:!(null!=O&&O.password),type:"primary",size:"xl",onPress:_,children:s.formatMessage({id:"action__continue",defaultMessage:"Continue"})})]}),Object(B.jsx)(p.a,{mt:"8",children:Object(B.jsx)(L.a,{onOk:w})})]})},V=function(e){var t=e.field,n=e.onOk,a=e.hideTitle,i=Object(d.useState)(!1),r=l()(i,2),c=r[0],u=r[1],f=Object(d.useState)(!1),b=l()(f,2),j=b[0],m=b[1],O=Object(d.useState)(),g=l()(O,2),x=g[0],y=g[1],M=Object(w.h)((function(e){return e.settings.validationSetting})),k=Object(d.useMemo)((function(){var e=!!t&&!(null==M||!M[t]);return!(!t||t!==v.a.Secret)||e}),[M,t]);Object(d.useEffect)((function(){function e(){return(e=o()((function*(){var e=yield h.a.servicePassword.getPassword();e&&(m(!0),_.a.isNative?setTimeout((function(){return null==n?void 0:n(e,!1)}),500):null==n||n(e,!1)),y(!!e),u(!0)}))).apply(this,arguments)}k||function(){e.apply(this,arguments)}()}),[]);var A=Object(d.useCallback)(function(){var e=o()((function*(e,t){m(!0),yield h.a.servicePassword.savePassword(e),null==n||n(e,t)}));return function(t,n){return e.apply(this,arguments)}}(),[n]);if(!j){if(k)return Object(B.jsx)(T,{onOk:A,hideTitle:a});if(c&&!x)return Object(B.jsx)(T,{onOk:A,hideTitle:a})}return Object(B.jsx)(p.a,{w:"full",h:"full",children:Object(B.jsx)(s.b,{size:"lg"})})},I=function(e){var t=e.onOk,n=e.skipSavePassword,s=e.hideTitle,r=e.isAutoHeight,u=Object(b.a)(),l=Object(w.l)().isOk,f=Object(w.h)((function(e){return e.status.boardingCompleted})),j=Object(w.h)((function(e){return e.status.authenticationType})),m=Object(E.a)({mode:"onBlur",reValidateMode:"onBlur",defaultValues:{password:"",confirmPassword:""}}),O=m.control,g=m.handleSubmit,p=m.getValues,_=Object(S.a)({useFormReturn:m,revalidate:!1,clearErrorIfEmpty:!0}).formValues,v=Object(d.useMemo)((function(){return!(null!=_&&_.password)||!(null!=_&&_.confirmPassword)}),[null==_?void 0:_.confirmPassword,null==_?void 0:_.password]),k=Object(d.useCallback)(function(){var e=o()((function*(e){e.password===e.confirmPassword?(f&&!n&&(yield h.a.serviceApp.updatePassword("",e.password)),null==t||t(e.password,e.withEnableAuthentication)):c.a.show({title:u.formatMessage({id:"msg__password_needs_to_be_the_same"})},{type:"error"})}));return function(t){return e.apply(this,arguments)}}(),[f,n,t,u]),A="FACIAL"===j?u.formatMessage({id:"content__face_id"}):u.formatMessage({id:"content__touch_id"});return Object(B.jsxs)(x.a,{h:r?{base:"full",sm:"auto"}:"full",px:{base:s?0:4,md:0},children:[s?null:Object(B.jsxs)(i.a,{mb:"8",children:[Object(B.jsxs)(a.h.DisplayLarge,{textAlign:"center",mb:2,children:["\ud83d\udd10"," ",u.formatMessage({id:"title__set_password",defaultMessage:"Set Password"})]}),Object(B.jsx)(a.h.Body1,{textAlign:"center",color:"text-subdued",children:u.formatMessage({id:"Only_you_can_unlock_your_wallet",defaultMessage:"Only you can unlock your wallet"})})]}),Object(B.jsxs)(M.a,{children:[Object(B.jsx)(M.a.Item,{name:"password",defaultValue:"",control:O,rules:{minLength:{value:8,message:u.formatMessage({id:"msg__password_validation"})},maxLength:{value:128,message:u.formatMessage({id:"msg__password_validation"})},validate:function(e){var t=p("confirmPassword");if(t&&e)return t!==e?u.formatMessage({id:"msg__password_needs_to_be_the_same"}):void 0}},children:Object(B.jsx)(M.a.PasswordInput,{autoFocus:!0,onSubmitEditing:g(k),placeholder:u.formatMessage({id:"form__rule_at_least_int_digits"},{0:8})})}),Object(B.jsx)(M.a.Item,{name:"confirmPassword",defaultValue:"",control:O,rules:{minLength:{value:8,message:u.formatMessage({id:"msg__password_validation"})},validate:function(e){var t=p("password");if(t&&e)return t!==e?u.formatMessage({id:"msg__password_needs_to_be_the_same"}):void 0}},children:Object(B.jsx)(M.a.PasswordInput,{onSubmitEditing:g(k),placeholder:u.formatMessage({id:"Confirm_password"})})}),l?Object(B.jsx)(M.a.Item,{name:"withEnableAuthentication",defaultValue:l,control:O,children:Object(B.jsx)(M.a.CheckBox,{title:u.formatMessage({id:"content__authentication_with"},{0:A})})}):null,Object(B.jsx)(y.a,{type:"primary",size:"xl",onPress:g(k),isDisabled:v,children:u.formatMessage({id:"action__continue",defaultMessage:"Continue"})})]})]})};t.b=Object(d.memo)((function(e){var t=e.children,n=e.skipSavePassword,r=e.field,u=e.walletId,p=e.hideTitle,_=e.isAutoHeight,w=Object(f.u)(),v=Object(m.i)(u),x=Object(b.a)(),y=h.a.engine,M=h.a.serviceHardware,k=Object(d.useState)(),A=l()(k,2),E=A[0],S=A[1],P=Object(d.useState)(""),L=l()(P,2),T=L[0],C=L[1],F=Object(d.useState)(),D=l()(F,2),R=D[0],W=D[1],z=Object(d.useState)(),H=l()(z,2),N=H[0],G=H[1],J=Object(m.f)().isPasswordSet,K=Object(d.useState)(J),q=l()(K,1)[0],Q=Object(d.useCallback)((function(e,t){G(t),C(e)}),[]),U=Object(d.useCallback)((function(e,t){W(t),C(e)}),[]),X=Object(d.useCallback)((function(){null!=w&&null!=w.canGoBack&&w.canGoBack()&&w.goBack()}),[w]),Y="hw"===(null==v?void 0:v.type),Z=(null==v?void 0:v.type)===j.a;return Object(d.useEffect)((function(){function e(){c.a.show({title:x.formatMessage({id:"action__connection_timeout"})}),X()}function t(){return(t=o()((function*(){if(null!=v&&v.id){var t=yield y.getHWDeviceByWalletId(v.id);if(t){var n=null;try{var a=yield M.getFeatursByWalletId(v.id);a?(n=a,g.a.hardwareSDK.debug("use features cache: ",a)):n=yield M.getFeatures(t.mac)}catch(s){return X(),void O.a.showErrorToast(s)}if(!n)return c.a.show({title:x.formatMessage({id:"action__connection_timeout"})}),void X();S(n)}else e()}else e()}))).apply(this,arguments)}Y&&function(){t.apply(this,arguments)}()}),[Y,y,null==v?void 0:v.id,x,X,M]),Z?Object(B.jsx)(i.a,{flex:1,children:t(T,{withEnableAuthentication:R,isLocalAuthentication:N})}):T?Object(B.jsx)(i.a,{w:"full",h:"full",children:t(T,{withEnableAuthentication:R,isLocalAuthentication:N})}):Y?E?Object(B.jsx)(i.a,{w:"full",h:"full",children:t(T,{withEnableAuthentication:R,isLocalAuthentication:N,deviceFeatures:E})}):Object(B.jsxs)(i.a,{h:"100%",justifyContent:"center",alignItems:"center",children:[Object(B.jsx)(s.b,{size:"lg"}),Object(B.jsx)(a.h.DisplayMedium,{mt:6,children:x.formatMessage({id:"modal__device_status_check"})})]}):q?Object(B.jsx)(V,{onOk:Q,field:r,hideTitle:p}):Object(B.jsx)(I,{onOk:U,skipSavePassword:n,hideTitle:p,isAutoHeight:_})}))},3088:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(209),s=n.n(a),i=n(10),r=n.n(i),o=n(1),c=n(1126);function u(e){var t=e.useFormReturn,n=e.wait,a=void 0===n?500:n,i=e.revalidate,u=void 0===i||i,l=e.clearErrorIfEmpty,d=void 0!==l&&l,f=e.onChange,b=t.watch,j=t.trigger,h=t.formState,m=t.clearErrors,O=t.getValues,g=Object(o.useRef)(!1),p=Object(o.useState)(),_=r()(p,2),w=_[0],v=_[1];Object(o.useEffect)((function(){var e=O();v(e),setTimeout((function(){return j()}),0)}),[O,j]),Object(o.useEffect)((function(){var e=s()((function(e,t){var n=t.name,a=t.type;g.current=!1,"change"!==a&&void 0!==a||(v(e),f&&f(e,{name:n,type:a}),d&&""===(null==e?void 0:e[n])&&m(n),u&&j(n))}),a,{leading:!1,trailing:!0}),t=b((function(t,n){var a=n.name,s=n.type;g.current=!0,e(t,{name:a,type:s})}));return function(){return t.unsubscribe()}}),[d,m,f,u,j,a,b]);var x=Object(c.a)(h.isValid&&!Object.keys(h.errors).length&&!h.isValidating,100);return{loadingRef:g,isLoading:g.current,formValues:w,isValid:x}}},3324:function(e,t,n){"use strict";n.r(t),n.d(t,"EnableLocalAuthenticationRoutes",(function(){return a}));var a,s=n(85),i=n(283),r=n(110),o=n(326),c=n(163),u=n(3),l=n.n(u),d=n(1),f=n(52),b=n(508),j=n(43),h=n(3062),m=n(42),O=n(1146),g=n(94),p=n(0),_=function(e){var t=e.password,n=e.isLocalAuthentication,a=j.a.dispatch,s=Object(b.a)(),i=Object(m.n)().enableLocalAuthentication,u=Object(O.a)(),h=u.localAuthenticate,_=u.savePassword,w=Object(f.u)();return Object(d.useEffect)((function(){function e(){return(e=l()((function*(){if(!i&&!n){var e=yield h();if(!e.success)return e.error.includes("cancelled")||c.a.show({title:s.formatMessage({id:"msg__verification_failure"})},{type:"error"}),void setTimeout((function(){null==w||null==w.goBack||w.goBack()}),1e3)}_(i?"":t),a(Object(g.N)()),setTimeout((function(){null==w||null==w.goBack||w.goBack()}),1e3)}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(p.jsx)(r.a,{h:"full",w:"full",children:Object(p.jsx)(o.b,{size:"lg"})})},w=function(){return Object(p.jsx)(i.b,{footer:null,children:Object(p.jsx)(h.b,{walletId:null,children:function(e,t){var n=t.isLocalAuthentication;return Object(p.jsx)(_,{password:e,isLocalAuthentication:n})}})})};!function(e){e.EnableLocalAuthenticationModal="EnableLocalAuthenticationModal",e.EnableWebAuthn="EnableWebAuthn"}(a||(a={}));var v=n(22),x=n(952),y=function(){var e=Object(b.a)(),t=Object(m.d)((function(e){return e.settings.enableWebAuthn})),n=Object(f.u)();return Object(d.useEffect)((function(){function a(){return(a=l()((function*(){try{t?Object(x.a)():yield Object(x.b)(),c.a.show({title:e.formatMessage({id:"msg__success"})})}catch(a){v.a.common.error(a.message),a.message.includes("The operation either timed out or was not allowed")||c.a.show({title:e.formatMessage({id:"msg__unknown_error"})})}setTimeout((function(){null==n||null==n.goBack||n.goBack()}),1e3)}))).apply(this,arguments)}!function(){a.apply(this,arguments)}()}),[]),Object(p.jsx)(r.a,{h:"full",w:"full",children:Object(p.jsx)(o.b,{size:"lg"})})},M=function(){return Object(p.jsx)(i.b,{footer:null,children:Object(p.jsx)(h.b,{walletId:null,children:function(e){return Object(p.jsx)(y,{password:e})}})})},k=n(456),A=Object(k.a)(),E=[{name:a.EnableLocalAuthenticationModal,component:w},{name:a.EnableWebAuthn,component:M}];t.default=function(){var e=Object(s.a)();return Object(p.jsx)(A.Navigator,{screenOptions:{headerShown:!1,animationEnabled:!!e},children:E.map((function(e){return Object(p.jsx)(A.Screen,{name:e.name,component:e.component},e.name)}))})}}}]);