(this.webpackJsonp=this.webpackJsonp||[]).push([[102],{3249:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.HistoryRequestModal="HistoryRequestModal",e.TicketDetailModal="TicketDetailModal",e.ReplyTicketModel="ReplyTicketModel",e.SubmitRequestModal="SubmitRequestModal"}(r||(r={}))},3548:function(e,t,n){"use strict";n.r(t);var r=n(85),a=n(283),o=n(387),i=n(125),c=n(79),s=n(70),l=n(326),u=n(32),d=n(743),p=n(646),f=n(10),b=n.n(f),m=n(1),j=n.n(m),O=n(52),h=n(55),g=n.n(h),y=n(547),x=n(725),_=n(508),v=n(15),w=n(43),P=n(42),M=n(3065),k=n(3080),S=n(33),D=n(834),A=n(3249),C=n(0),E=function(){var e=Object(_.a)(),t=Object(P.n)().instanceId,n=Object(M.a)().formatDate,r=Object(O.u)(),f=Object(m.useState)([]),j=b()(f,2),h=j[0],E=j[1],R=Object(m.useState)("loading"),T=b()(R,2),q=T[0],I=T[1],B=Object(m.useCallback)((function(){I("loading"),g.a.get(Object(D.c)(t)).then((function(e){if(e.data.success){var t=e.data.data;I(t.length>0?"data":"empty"),E(t)}})).catch((function(){I("network")}))}),[t]),z=function(){v.a.isExtensionUiPopup?(w.a.serviceApp.openExtensionExpandTab({routes:[S.g.Modal,S.e.SubmitRequest],params:{screen:k.g.SubmitRequestModal}}),setTimeout((function(){window.close()}),300)):r.navigate(A.a.SubmitRequestModal)},W=Object(m.useMemo)((function(){return Object(C.jsx)(p.a,{dismiss:!0,alertType:"info",title:e.formatMessage({id:"conten__please_be_patient_as_net_work"})})}),[e]),F=Object(m.useCallback)((function(t){var a=t.item,o="";return a.custom_fields.forEach((function(e){360013393195===e.id&&(o=e.value)})),Object(C.jsx)(i.a,{onPress:function(){r.navigate(A.a.TicketDetailModal,{order:a})},children:Object(C.jsx)(y.a,{bgColor:"surface-default",height:"96px",padding:"16px",borderRadius:"12px",children:Object(C.jsxs)(y.a,{flex:1,alignItems:"center",space:"12px",children:[Object(C.jsxs)(x.a,{flex:1,children:[Object(C.jsx)(s.a,{typography:{sm:"Body1Strong",md:"Body2Strong"},children:function(t){switch(t){case"hardware":return e.formatMessage({id:"form__hardware"});case"app_on_android":return e.formatMessage({id:"form__app_on_android"});case"app_on_ios":return e.formatMessage({id:"form__app_on_ios"});case"app_on_desktop":return e.formatMessage({id:"form__app_on_desktop"});case"app_on_browser":return e.formatMessage({id:"form__app_on_browser"});default:return t}}(o)}),Object(C.jsx)(s.a,{typography:"Body2",numberOfLines:1,color:"text-subdued",children:a.description}),Object(C.jsx)(s.a,{typography:"Body2",color:"text-subdued",children:n(a.created_at,{hideYear:!0})})]}),Object(C.jsx)(c.a,{name:"ChevronRightMini",color:"icon-subdued",size:20})]})})},a.id)}),[n,e,r]);return Object(m.useEffect)((function(){B()}),[B]),Object(C.jsx)(a.b,{height:"560px",header:e.formatMessage({id:"form__s_request_history"}),footer:"data"===q?void 0:null,hideSecondaryAction:!0,hidePrimaryAction:!("data"===q),primaryActionProps:{type:"basic"},onPrimaryActionPress:z,primaryActionTranslationId:"form__submit_a_request",flatListProps:"data"===q?{height:"560px",data:h,renderItem:F,ListHeaderComponent:function(){return Object(C.jsx)(u.a,{mb:"16px",children:W})},ItemSeparatorComponent:function(){return Object(C.jsx)(o.a,{height:"24px",bgColor:"surface-subdued"})},keyExtractor:function(e){return e.created_at}}:void 0,children:"data"!==q?Object(C.jsx)(u.a,{flex:1,alignItems:"center",justifyContent:"center",position:"relative",children:function(){switch(q){case"network":return Object(C.jsx)(d.a,{emoji:"\ud83c\udf10",title:e.formatMessage({id:"title__no_connection"}),subTitle:e.formatMessage({id:"title__no_connection_desc"}),actionTitle:e.formatMessage({id:"action__retry"}),handleAction:function(){return B()}});case"empty":return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(u.a,{position:"absolute",top:0,left:0,right:0,children:W}),Object(C.jsx)(d.a,{emoji:"\ud83d\udcac",title:e.formatMessage({id:"title__no_request_history"}),subTitle:e.formatMessage({id:"title__no_request_history_desc"}),actionTitle:e.formatMessage({id:"form__submit_a_request"}),handleAction:z})]});case"loading":return Object(C.jsx)(l.b,{size:"sm"});default:return null}}()}):null})},R=n(200),T=n(186),q=n(110),I=n(2),B=n.n(I),z=n(20),W=n.n(z),F=n(163),H=n(3),L=n.n(H),Y=n(745),N=n(1161),V=n(345),X=n(249),J=n(153),G=n.n(J),U=n(395),K=n(1179);function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){B()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $=function(){var e,t=Object(_.a)(),n=Object(X.a)().width,o=Object(r.a)(),s=Object(O.u)(),l=Object(P.n)().instanceId,u=Object(O.x)(),d=((null==u?void 0:u.params.order)||{}).id,p=null==u?void 0:u.params.order.submitter_id,f=((o?n:400)-2*(o?16:24))/4,j=Object(Y.a)({mode:"onChange"}),h=j.control,x=j.handleSubmit,w=j.formState.isValid,M=Object(m.useState)([]),k=b()(M,2),S=k[0],A=k[1],E=Object(m.useCallback)(function(){var e=L()((function*(e){return g.a.post(Object(D.f)(d,l),{comment:{body:e.comment,author_id:p,uploads:function(){var e=[];return S.forEach((function(t){t.token&&e.push(t.token)})),e}()}}).then((function(e){e.data.success&&(F.a.show({title:t.formatMessage({id:"msg__submitted_successfully"})}),s.goBack())})).catch((function(e){}))}));return function(t){return e.apply(this,arguments)}}(),[d,S,l,t,s,p]),I=Object(m.useCallback)(L()((function*(){var e=yield Object(N.a)({mediaTypes:V.a.Images,allowsEditing:!1,base64:!0,aspect:[4,3],quality:.3});if(!e.cancelled){var n=G.a.v4()+".png",r={loading:!0,localPath:e.uri,filename:n},a=e.uri;v.a.isNative&&e.base64&&(a=e.base64),A((function(e){return[].concat(W()(e),[r])})),Object(D.g)({filename:n,image:a},l,(function(e,r){e?(A((function(e){var t=e.findIndex((function(e){return e.filename===n}));return t<0?e:[].concat(W()(e.slice(0,t)),W()(e.slice(t+1)))})),F.a.show({title:t.formatMessage({id:"msg__upload_failed"})},{type:"error"})):A((function(e){var t=e.findIndex((function(e){return e.filename===n}));return t<0?e:[].concat(W()(e.slice(0,t)),[Z(Z({},e[t]),{},{loading:!1,token:r.data.upload.token})],W()(e.slice(t+1)))}))}))}})),[l]);return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(U.b,{}),Object(C.jsx)(a.b,{header:t.formatMessage({id:"action__reply"}),hideSecondaryAction:!0,primaryActionProps:{isDisabled:!(w&&(null==(e=S.filter((function(e){return!(null!=e&&e.token)})))||!e.length)),onPromise:function(){return x(E)()}},primaryActionTranslationId:"action__submit",scrollViewProps:{height:"560px",children:Object(C.jsxs)(R.a,{children:[Object(C.jsx)(R.a.Item,{label:t.formatMessage({id:"form__your_reply"}),control:h,labelAddon:Object(C.jsx)(T.a,{type:"plain",size:"xs",name:"PhotoMini",onPress:function(){S.length<4&&I()}}),rules:{required:t.formatMessage({id:"form__field_is_required"}),maxLength:{value:1e3,message:t.formatMessage({id:"msg__exceeding_the_maximum_word_limit"})},validate:function(e){}},name:"comment",formControlProps:{width:"full"},defaultValue:"",children:Object(C.jsx)(R.a.Textarea,{borderRadius:"12px"})}),Object(C.jsxs)(y.a,{children:[S.map((function(e,t){return Object(C.jsx)(K.a,{imageModel:e,onDelete:function(e){A((function(t){var n=t.findIndex((function(t){return t.filename===e.filename}));return n<0?t:[].concat(W()(t.slice(0,n)),W()(t.slice(n+1)))}))}},t)})),S.length<4?Object(C.jsx)(i.a,{onPress:I,children:Object(C.jsx)(q.a,{mt:"8px",width:f-8+"px",height:f-8+"px",borderRadius:"12px",borderWidth:1,borderColor:"border-default",children:Object(C.jsx)(c.a,{size:20,name:"PlusMini"})})}):null]})]})}})]})},ee=n(1107),te=n(16),ne=n.n(te),re=n(62),ae=n(175),oe=n.n(ae),ie=n(696),ce=n.n(ie),se=n(24),le=n(1064),ue=n(207),de=n(610),pe=n.n(de);function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){B()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var me=n(867),je=["theme"],Oe=function(e,t,n,r,a){var o=Object(ue.e)(r,["children","style","onPress","icon","onOpen","onClose"]),i=b()(o,2),c=i[0],s=i[1],l=function(e,t,n){var r;if("web"!==n)return be(be({},t),e);var a=null!==(r=t.style)&&void 0!==r?r:{},o=Object(ue.e)(e,["shadowColor","shadowOffset","shadowOpacity","shadowRadius"]),i=b()(o,2),c=i[0],s=i[1];return pe()(c)||(a=be(be({},a),c)),be(be(be({},s),t),{},{style:a})}(Object(me.a)(e,t,n,s,a),c,se.a.OS);return Object(ue.n)(l)};var he=n(46),ge=["columns","space","spacingX","spacingY","minChildWidth","children"];function ye(){return(ye=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var xe={rows:{},cols:{}},_e=j.a.memo(j.a.forwardRef((function(e,t){var n=function(e,t){var n,r=Object(le.a)(),a=r.theme,o=ne()(r,je),i=oe()(a,"components.".concat(e)),c=null===(n=Object(X.a)())||void 0===n?void 0:n.width;return Oe(ce()(a,["components"]),o,i,t,c)}("SimpleGrid",e),r=n.columns,a=n.space,o=n.spacingX,i=n.spacingY,c=n.minChildWidth,s=n.children,l=ne()(n,ge);if(Object(he.a)(e))return j.a.createElement(j.a.Fragment,null);var u=null!==a&&void 0!==a?a:0,d=null!==o&&void 0!==o?o:u,p=null!==i&&void 0!==i?i:u,f=j.a.Children.toArray(s);if(r){for(var b=[],m=0;m<f.length;m+=r)b.push(f.slice(m,m+r));return j.a.createElement(x.a,ye({},xe.rows,{space:p},l,{ref:t}),b.map((function(e,t){return j.a.createElement(y.a,{space:d,key:t},e.map((function(e){return j.a.createElement(re.a,ye({},xe.cols,{key:e.key}),e)})))})))}return c?j.a.createElement(re.a,ye({flexDirection:"row",flexWrap:"wrap",justifyContent:"center"},l,{ref:t}),f.map((function(e){return j.a.createElement(re.a,ye({},xe.cols,{mx:d,my:p,key:e.key,minWidth:c}),e)}))):j.a.createElement(j.a.Fragment,null)})));function ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function we(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(n),!0).forEach((function(t){B()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Pe=function(e){var t=e.id,n=e.size,r=Object(P.n)().instanceId,a=Object(m.useState)(""),o=b()(a,2),i=o[0],c=o[1];return Object(m.useEffect)((function(){g.a.get(Object(D.a)(t,r)).then((function(e){e.data&&c(e.data.data)}))}),[t]),Object(C.jsx)(C.Fragment,{children:i.length>0?Object(C.jsx)(ee.a,{width:n+"px",height:n+"px",src:i,borderRadius:"12px",preview:!0,bgColor:"surface-selected"},i):Object(C.jsx)(u.a,{width:n,height:n,bgColor:"surface-selected",borderRadius:"12px"})})};var Me=function(){var e=Object(_.a)(),t=Object(O.t)(),n=Object(O.x)(),r=((null==n?void 0:n.params.order)||{}).id,o=n.params.order.submitter_id,i=Object(O.u)(),c=Object(P.n)().version,l=Object(P.n)().instanceId,d=Object(M.a)().formatDate,p=Object(m.useState)([]),f=b()(p,2),j=f[0],h=f[1],y=Object(m.useCallback)((function(e){var t=e.item,n=e.index,r=function(e,t){return e===t}(t.author_id,o),a=t.body;0===n&&(a=a+"\n\n"+(v.a.isNativeIOS?"App on iOS":v.a.isNativeAndroid?"App on Android":v.a.isDesktop?"App on Desktop":v.a.isRuntimeBrowser?"App on Browser":"Hardware")+"\nAppVersion: "+c);return Object(C.jsx)(u.a,{flex:1,flexDirection:"row",justifyContent:r?"flex-end":"flex-start",children:Object(C.jsxs)(u.a,{flexDirection:"column",paddingBottom:"24px",children:[Object(C.jsxs)(u.a,{flexDirection:"column",bgColor:"surface-default",padding:"16px",borderRadius:"12px",flex:1,children:[Object(C.jsx)(s.a,{selectable:!0,maxWidth:"260px",typography:{sm:"Body1",md:"Body2"},mb:t.attachments.length>0?"12px":"0px",children:a}),t.attachments.length>0?Object(C.jsx)(_e,{columns:3,spacingX:2,spacingY:3,mt:"12px",children:t.attachments.map((function(e,t){return Object(C.jsx)(u.a,{size:244/3,children:Object(C.jsx)(Pe,we(we({},e),{},{size:244/3}))},"attachment"+t)}))}):null]}),Object(C.jsx)(s.a,{mt:"8px",typography:"Body2",color:"text-subdued",textAlign:r?"right":"left",children:d(t.created_at,{hideYear:!0})})]})})}),[d,244/3,o,c]),x=Object(m.useCallback)((function(){g.a.get(Object(D.b)(r,l)).then((function(e){h(e.data.data)})).catch((function(){}))}),[r,l]);return Object(m.useEffect)((function(){t&&x()}),[x,t]),Object(C.jsx)(a.b,{header:e.formatMessage({id:"title__request_details"}),hideSecondaryAction:!0,primaryActionProps:{type:"basic"},primaryActionTranslationId:"action__reply",onPrimaryActionPress:function(){i.navigate(A.a.ReplyTicketModel,{order:null==n?void 0:n.params.order})},flatListProps:{height:"420px",data:j,renderItem:y,keyExtractor:function(e){return e.created_at}}})},ke=n(456),Se=Object(ke.a)(),De=[{name:A.a.HistoryRequestModal,component:E},{name:A.a.TicketDetailModal,component:Me},{name:A.a.ReplyTicketModel,component:$},{name:A.a.SubmitRequestModal,component:K.b}];t.default=function(){var e=Object(r.a)();return Object(C.jsx)(Se.Navigator,{screenOptions:{headerShown:!1,animationEnabled:!!e},children:De.map((function(e){return Object(C.jsx)(Se.Screen,{name:e.name,component:e.component},e.name)}))})}}}]);